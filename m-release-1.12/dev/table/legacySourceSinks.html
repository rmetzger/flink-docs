<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: Legacy Table Source & Sink Interfaces</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/dev/table/legacySourceSinks.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/local_installation.html">Local Installation</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/datastream_api.html">Fraud Detection with the DataStream API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/table_api.html">Real Time Reporting with the Table API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/flink-operations-playground.html">Flink Operations Playground</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> Learn Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/datastream_api.html">Intro to the DataStream API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/etl.html">Data Pipelines & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/streaming_analytics.html">Streaming Analytics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/event_driven.html">Event-driven Applications</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/fault_tolerance.html">Fault Tolerance</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/index.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/stateful-stream-processing.html">Stateful Stream Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/timely-stream-processing.html">Timely Stream Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/flink-architecture.html">Flink Architecture</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/glossary.html">Glossary</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/datastream_api.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">Event Time<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_time.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamps_watermarks.html">Generating Watermarks</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamp_extractors.html">Builtin Watermark Generators</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">State & Fault Tolerance<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/broadcast_state.html">The Broadcast State Pattern</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/schema_evolution.html">State Schema Evolution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/custom_serialization.html">Custom State Serialization</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/user_defined_functions.html">User-Defined Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">Operators<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/windows.html">Windows</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/asyncio.html">Async I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/side_output.html">Side Outputs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/testing.html">Testing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/experimental.html">Experimental Features</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/java_lambdas.html">Java Lambda Expressions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/iterations.html">Iterations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/hadoop_compatibility.html">Hadoop Compatibility</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/local_execution.html">Local Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/cluster_execution.html">Cluster Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/examples.html">Batch Examples</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse">Table API & SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html">Concepts & Common API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">Streaming Concepts<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/dynamic_tables.html">Dynamic Tables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/time_attributes.html">Time Attributes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/joins.html">Joins in Continuous Queries</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/temporal_tables.html">Temporal Tables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/match_recognize.html">Detecting Patterns</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/queries.html">Queries</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/create.html">CREATE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/drop.html">DROP Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/alter.html">ALTER Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/insert.html">INSERT Statement</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/describe.html">DESCRIBE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/explain.html">EXPLAIN Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/use.html">USE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/show.html">SHOW Statements</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">Functions<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/systemFunctions.html">System (Built-in) Functions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/udfs.html">User-defined Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/modules.html">Modules</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sqlClient.html">SQL Client</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/config.html">Configuration</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tuning/streaming_aggregation_optimization.html">Streaming Aggregation</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse">Python API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/installation.html">Installation</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table_api_tutorial.html">Table API Tutorial</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream_tutorial.html">DataStream API Tutorial</a></li>
<li><a href="#collapse-103" data-toggle="collapse">Table API User's Guide<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/intro_to_table_api.html">Intro to the Python Table API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/python_types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/built_in_functions.html">System (Built-in) Functions</a></li>
<li><a href="#collapse-109" data-toggle="collapse">User Defined Functions<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/python_udfs.html">General User-defined Functions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">Vectorized User-defined Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/conversion_of_pandas.html">Conversions between PyFlink Table and Pandas DataFrame</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/dependency_management.html">Dependency Management</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/metrics.html">Metrics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/python_table_api_connectors.html">Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API User's Guide<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/data_types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/operators.html">Operators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/dependency_management.html">Dependency Management</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/python_config.html">Configuration</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/environment_variables.html">Environment Variables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/faq.html">FAQ</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">Data Types & Serialization<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/types_serialization.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/custom_serializers.html">Custom Serializers</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">Managing Execution<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/execution_configuration.html">Execution Configuration</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/packaging.html">Program Packaging</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/parallel.html">Parallel Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/execution_plans.html">Execution Plans</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/task_failure_recovery.html">Task Failure Recovery</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/migration.html">API Migration Guides</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/cep.html">Event Processing (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">Graphs: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/guarantees.html">Fault Tolerance Guarantees</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/">Overview</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_dialect.html">Hive Dialect</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_functions.html">Hive Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/downloads.html">Download</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/">Overview</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/local.html">Local Cluster</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html">Configuration</a></li>
<li><a href="#collapse-213" data-toggle="collapse">Memory Configuration<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html">Set up Flink's Process Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_tm.html">Set up TaskManager Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_jobmanager.html">Set up JobManager Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_tuning.html">Memory tuning guide</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_trouble.html">Troubleshooting</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_migration.html">Migration Guide</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">File Systems<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/common.html">Common Configurations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/oss.html">Aliyun OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/azure.html">Azure Blob Storage</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/security/security-ssl.html">SSL Setup</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/external_resources.html">External Resources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/logging.html">Logging</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">State & Fault Tolerance<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/metrics.html">Metrics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/debugging_event_time.html">Debugging Windows & Event Time</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/debugging_classloading.html">Debugging Classloading</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/application_profiling.html">Application Profiling & Debugging</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/monitoring/checkpoint_monitoring.html">Monitoring Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/monitoring/back_pressure.html">Monitoring Back Pressure</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/upgrading.html">Upgrading Applications and Flink Versions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/production_ready.html">Production Readiness Checklist</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink Development<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/flinkDev/ide_setup.html">Importing Flink into an IDE</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/flinkDev/building.html">Building Flink from Source</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> Internals<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/job_scheduling.html">Jobs and Scheduling</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/task_lifecycle.html">Task Lifecycle</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/filesystems.html">File Systems</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><!-- link to the Chinese home page when current is blog page -->
    <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/legacySourceSinks.html">
      <button type="submit" class="btn btn-default">中文版</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li class="active">Legacy Table Source & Sink Interfaces</li>
</ol>

<h1>Legacy Table Source & Sink Interfaces</h1>




<p>A <code class="highlighter-rouge">TableSource</code> provides access to data which is stored in external systems (database, key-value store, message queue) or files. After a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html#register-a-tablesource">TableSource is registered in a TableEnvironment</a> it can be accessed by <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html">Table API</a> or <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/queries.html">SQL</a> queries.</p>

<p>A <code class="highlighter-rouge">TableSink</code> <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html#emit-a-table">emits a Table</a> to an external storage system, such as a database, key-value store, message queue, or file system (in different encodings, e.g., CSV, Parquet, or ORC).</p>

<p>A <code class="highlighter-rouge">TableFactory</code> allows for separating the declaration of a connection to an external system from the actual implementation. A table factory creates configured instances of table sources and sinks from normalized, string-based properties. The properties can be generated programmatically using a <code class="highlighter-rouge">Descriptor</code> or via YAML configuration files for the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sqlClient.html">SQL Client</a>.</p>

<p>Have a look at the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html">common concepts and API</a> page for details how to <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html#register-a-tablesource">register a TableSource</a> and how to <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html#emit-a-table">emit a Table through a TableSink</a>. See the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connect.html">built-in sources, sinks, and formats</a> page for examples how to use factories.</p>

<ul id="markdown-toc">
  <li><a href="#define-a-tablesource" id="markdown-toc-define-a-tablesource">Define a TableSource</a>    <ul>
      <li><a href="#defining-a-batchtablesource" id="markdown-toc-defining-a-batchtablesource">Defining a BatchTableSource</a></li>
      <li><a href="#defining-a-streamtablesource" id="markdown-toc-defining-a-streamtablesource">Defining a StreamTableSource</a></li>
      <li><a href="#defining-a-tablesource-with-time-attributes" id="markdown-toc-defining-a-tablesource-with-time-attributes">Defining a TableSource with Time Attributes</a></li>
      <li><a href="#defining-a-tablesource-with-projection-push-down" id="markdown-toc-defining-a-tablesource-with-projection-push-down">Defining a TableSource with Projection Push-Down</a></li>
      <li><a href="#defining-a-tablesource-with-filter-push-down" id="markdown-toc-defining-a-tablesource-with-filter-push-down">Defining a TableSource with Filter Push-Down</a></li>
      <li><a href="#defining-a-tablesource-for-lookups" id="markdown-toc-defining-a-tablesource-for-lookups">Defining a TableSource for Lookups</a></li>
    </ul>
  </li>
  <li><a href="#define-a-tablesink" id="markdown-toc-define-a-tablesink">Define a TableSink</a>    <ul>
      <li><a href="#batchtablesink" id="markdown-toc-batchtablesink">BatchTableSink</a></li>
      <li><a href="#appendstreamtablesink" id="markdown-toc-appendstreamtablesink">AppendStreamTableSink</a></li>
      <li><a href="#retractstreamtablesink" id="markdown-toc-retractstreamtablesink">RetractStreamTableSink</a></li>
      <li><a href="#upsertstreamtablesink" id="markdown-toc-upsertstreamtablesink">UpsertStreamTableSink</a></li>
    </ul>
  </li>
  <li><a href="#define-a-tablefactory" id="markdown-toc-define-a-tablefactory">Define a TableFactory</a>    <ul>
      <li><a href="#use-a-tablefactory-in-the-sql-client" id="markdown-toc-use-a-tablefactory-in-the-sql-client">Use a TableFactory in the SQL Client</a></li>
      <li><a href="#use-a-tablefactory-in-the-table--sql-api" id="markdown-toc-use-a-tablefactory-in-the-table--sql-api">Use a TableFactory in the Table &amp; SQL API</a></li>
    </ul>
  </li>
</ul>

<h2 id="define-a-tablesource">Define a TableSource</h2>

<p>A <code class="highlighter-rouge">TableSource</code> is a generic interface that gives Table API and SQL queries access to data stored in an external system. It provides the schema of the table and the records that are mapped to rows with the table’s schema. Depending on whether the <code class="highlighter-rouge">TableSource</code> is used in a streaming or batch query, the records are produced as a <code class="highlighter-rouge">DataSet</code> or <code class="highlighter-rouge">DataStream</code>.</p>

<p>If a <code class="highlighter-rouge">TableSource</code> is used in a streaming query it must implement the <code class="highlighter-rouge">StreamTableSource</code> interface, if it is used in a batch query it must implement the <code class="highlighter-rouge">BatchTableSource</code> interface. A <code class="highlighter-rouge">TableSource</code> can also implement both interfaces and be used in streaming and batch queries.</p>

<p><code class="highlighter-rouge">StreamTableSource</code> and <code class="highlighter-rouge">BatchTableSource</code> extend the base interface <code class="highlighter-rouge">TableSource</code> that defines the following methods:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TableSchema</span> <span class="nf">getTableSchema</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getReturnType</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">explainSource</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getTableSchema</span><span class="k">:</span> <span class="kt">TableSchema</span>

  <span class="k">def</span> <span class="nf">getReturnType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">explainSource</span><span class="k">:</span> <span class="kt">String</span>

<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li>
    <p><code class="highlighter-rouge">getTableSchema()</code>: Returns the schema of the produced table, i.e., the names and types of the fields of the table. The field types are defined using Flink’s <code class="highlighter-rouge">DataType</code> (see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/types.html">Table API types</a> and <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/#data-types">SQL types</a>). Note that the returned <code class="highlighter-rouge">TableSchema</code> shouldn’t contain computed columns to reflect the schema of the physical <code class="highlighter-rouge">TableSource</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">getReturnType()</code>: Returns the physical type of the <code class="highlighter-rouge">DataStream</code> (<code class="highlighter-rouge">StreamTableSource</code>) or <code class="highlighter-rouge">DataSet</code> (<code class="highlighter-rouge">BatchTableSource</code>) and the records that are produced by the <code class="highlighter-rouge">TableSource</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">explainSource()</code>: Returns a String that describes the <code class="highlighter-rouge">TableSource</code>. This method is optional and used for display purposes only.</p>
  </li>
</ul>

<p>The <code class="highlighter-rouge">TableSource</code> interface separates the logical table schema from the physical type of the returned <code class="highlighter-rouge">DataStream</code> or <code class="highlighter-rouge">DataSet</code>. As a consequence, all fields of the table schema (<code class="highlighter-rouge">getTableSchema()</code>) must be mapped to a field with corresponding type of the physical return type (<code class="highlighter-rouge">getReturnType()</code>). By default, this mapping is done based on field names. For example, a <code class="highlighter-rouge">TableSource</code> that defines a table schema with two fields <code class="highlighter-rouge">[name: String, size: Integer]</code> requires a <code class="highlighter-rouge">TypeInformation</code> with at least two fields called <code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">size</code> of type <code class="highlighter-rouge">String</code> and <code class="highlighter-rouge">Integer</code>, respectively. This could be a <code class="highlighter-rouge">PojoTypeInfo</code> or a <code class="highlighter-rouge">RowTypeInfo</code> that have two fields named <code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">size</code> with matching types.</p>

<p>However, some types, such as Tuple or CaseClass types, do support custom field names. If a <code class="highlighter-rouge">TableSource</code> returns a <code class="highlighter-rouge">DataStream</code> or <code class="highlighter-rouge">DataSet</code> of a type with fixed field names, it can implement the <code class="highlighter-rouge">DefinedFieldMapping</code> interface to map field names from the table schema to field names of the physical return type.</p>

<h3 id="defining-a-batchtablesource">Defining a BatchTableSource</h3>

<p>The <code class="highlighter-rouge">BatchTableSource</code> interface extends the <code class="highlighter-rouge">TableSource</code> interface and defines one additional method:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">BatchTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">DataSet</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getDataSet</span><span class="o">(</span><span class="nc">ExecutionEnvironment</span> <span class="n">execEnv</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">BatchTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getDataSet</span><span class="o">(</span><span class="n">execEnv</span><span class="k">:</span> <span class="kt">ExecutionEnvironment</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataSet</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">getDataSet(execEnv)</code>: Returns a <code class="highlighter-rouge">DataSet</code> with the data of the table. The type of the <code class="highlighter-rouge">DataSet</code> must be identical to the return type defined by the <code class="highlighter-rouge">TableSource.getReturnType()</code> method. The <code class="highlighter-rouge">DataSet</code> can by created using a regular <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/#data-sources">data source</a> of the DataSet API. Commonly, a <code class="highlighter-rouge">BatchTableSource</code> is implemented by wrapping a <code class="highlighter-rouge">InputFormat</code> or <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/connectors.html">batch connector</a>.</li>
</ul>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="defining-a-streamtablesource">Defining a StreamTableSource</h3>

<p>The <code class="highlighter-rouge">StreamTableSource</code> interface extends the <code class="highlighter-rouge">TableSource</code> interface and defines one additional method:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">StreamTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">DataStream</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getDataStream</span><span class="o">(</span><span class="nc">StreamExecutionEnvironment</span> <span class="n">execEnv</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">StreamTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getDataStream</span><span class="o">(</span><span class="n">execEnv</span><span class="k">:</span> <span class="kt">StreamExecutionEnvironment</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">getDataStream(execEnv)</code>: Returns a <code class="highlighter-rouge">DataStream</code> with the data of the table. The type of the <code class="highlighter-rouge">DataStream</code> must be identical to the return type defined by the <code class="highlighter-rouge">TableSource.getReturnType()</code> method. The <code class="highlighter-rouge">DataStream</code> can by created using a regular <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/datastream_api.html#data-sources">data source</a> of the DataStream API. Commonly, a <code class="highlighter-rouge">StreamTableSource</code> is implemented by wrapping a <code class="highlighter-rouge">SourceFunction</code> or a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/">stream connector</a>.</li>
</ul>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="defining-a-tablesource-with-time-attributes">Defining a TableSource with Time Attributes</h3>

<p>Time-based operations of streaming <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html#group-windows">Table API</a> and <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/queries.html#group-windows">SQL</a> queries, such as windowed aggregations or joins, require explicitly specified <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/time_attributes.html">time attributes</a>.</p>

<p>A <code class="highlighter-rouge">TableSource</code> defines a time attribute as a field of type <code class="highlighter-rouge">Types.SQL_TIMESTAMP</code> in its table schema. In contrast to all regular fields in the schema, a time attribute must not be matched to a physical field in the return type of the table source. Instead, a <code class="highlighter-rouge">TableSource</code> defines a time attribute by implementing a certain interface.</p>

<h4 id="defining-a-processing-time-attribute">Defining a Processing Time Attribute</h4>

<p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/time_attributes.html#processing-time">Processing time attributes</a> are commonly used in streaming queries. A processing time attribute returns the current wall-clock time of the operator that accesses it. A <code class="highlighter-rouge">TableSource</code> defines a processing time attribute by implementing the <code class="highlighter-rouge">DefinedProctimeAttribute</code> interface. The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">DefinedProctimeAttribute</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getProctimeAttribute</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">DefinedProctimeAttribute</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getProctimeAttribute</span><span class="k">:</span> <span class="kt">String</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">getProctimeAttribute()</code>: Returns the name of the processing time attribute. The specified attribute must be defined of type <code class="highlighter-rouge">Types.SQL_TIMESTAMP</code> in the table schema and can be used in time-based operations. A <code class="highlighter-rouge">DefinedProctimeAttribute</code> table source can define no processing time attribute by returning <code class="highlighter-rouge">null</code>.</li>
</ul>

<p><span class="label label-danger">Attention</span> Both <code class="highlighter-rouge">StreamTableSource</code> and <code class="highlighter-rouge">BatchTableSource</code> can implement <code class="highlighter-rouge">DefinedProctimeAttribute</code> and define a processing time attribute. In case of a <code class="highlighter-rouge">BatchTableSource</code> the processing time field is initialized with the current timestamp during the table scan.</p>

<h4 id="defining-a-rowtime-attribute">Defining a Rowtime Attribute</h4>

<p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/time_attributes.html#event-time">Rowtime attributes</a> are attributes of type <code class="highlighter-rouge">TIMESTAMP</code> and handled in a unified way in stream and batch queries.</p>

<p>A table schema field of type <code class="highlighter-rouge">SQL_TIMESTAMP</code> can be declared as rowtime attribute by specifying</p>

<ul>
  <li>the name of the field,</li>
  <li>a <code class="highlighter-rouge">TimestampExtractor</code> that computes the actual value for the attribute (usually from one or more other fields), and</li>
  <li>a <code class="highlighter-rouge">WatermarkStrategy</code> that specifies how watermarks are generated for the the rowtime attribute.</li>
</ul>

<p>A <code class="highlighter-rouge">TableSource</code> defines a rowtime attribute by implementing the <code class="highlighter-rouge">DefinedRowtimeAttributes</code> interface. The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">DefinedRowtimeAttribute</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">RowtimeAttributeDescriptor</span><span class="o">&gt;</span> <span class="nf">getRowtimeAttributeDescriptors</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">DefinedRowtimeAttributes</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getRowtimeAttributeDescriptors</span><span class="k">:</span> <span class="kt">util.List</span><span class="o">[</span><span class="kt">RowtimeAttributeDescriptor</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">getRowtimeAttributeDescriptors()</code>: Returns a list of <code class="highlighter-rouge">RowtimeAttributeDescriptor</code>. A <code class="highlighter-rouge">RowtimeAttributeDescriptor</code> describes a rowtime attribute with the following properties:
    <ul>
      <li><code class="highlighter-rouge">attributeName</code>: The name of the rowtime attribute in the table schema. The field must be defined with type <code class="highlighter-rouge">Types.SQL_TIMESTAMP</code>.</li>
      <li><code class="highlighter-rouge">timestampExtractor</code>: The timestamp extractor extracts the timestamp from a record with the return type. For example, it can convert a Long field into a timestamp or parse a String-encoded timestamp. Flink comes with a set of built-in <code class="highlighter-rouge">TimestampExtractor</code> implementation for common use cases. It is also possible to provide a custom implementation.</li>
      <li><code class="highlighter-rouge">watermarkStrategy</code>: The watermark strategy defines how watermarks are generated for the rowtime attribute. Flink comes with a set of built-in <code class="highlighter-rouge">WatermarkStrategy</code> implementations for common use cases. It is also possible to provide a custom implementation.</li>
    </ul>
  </li>
</ul>

<p><span class="label label-danger">Attention</span> Although the <code class="highlighter-rouge">getRowtimeAttributeDescriptors()</code> method returns a list of descriptors, only a single rowtime attribute is support at the moment. We plan to remove this restriction in the future and support tables with more than one rowtime attribute.</p>

<p><span class="label label-danger">Attention</span> Both, <code class="highlighter-rouge">StreamTableSource</code> and <code class="highlighter-rouge">BatchTableSource</code>, can implement <code class="highlighter-rouge">DefinedRowtimeAttributes</code> and define a rowtime attribute. In either case, the rowtime field is extracted using the <code class="highlighter-rouge">TimestampExtractor</code>. Hence, a <code class="highlighter-rouge">TableSource</code> that implements <code class="highlighter-rouge">StreamTableSource</code> and <code class="highlighter-rouge">BatchTableSource</code> and defines a rowtime attribute provides exactly the same data to streaming and batch queries.</p>

<h5 id="provided-timestamp-extractors">Provided Timestamp Extractors</h5>

<p>Flink provides <code class="highlighter-rouge">TimestampExtractor</code> implementations for common use cases.</p>

<p>The following <code class="highlighter-rouge">TimestampExtractor</code> implementations are currently available:</p>

<ul>
  <li><code class="highlighter-rouge">ExistingField(fieldName)</code>: Extracts the value of a rowtime attribute from an existing <code class="highlighter-rouge">LONG</code>, <code class="highlighter-rouge">SQL_TIMESTAMP</code>, or timestamp formatted <code class="highlighter-rouge">STRING</code> field. One example of such a string would be ‘2018-05-28 12:34:56.000’.</li>
  <li><code class="highlighter-rouge">StreamRecordTimestamp()</code>: Extracts the value of a rowtime attribute from the timestamp of the <code class="highlighter-rouge">DataStream</code> <code class="highlighter-rouge">StreamRecord</code>. Note, this <code class="highlighter-rouge">TimestampExtractor</code> is not available for batch table sources.</li>
</ul>

<p>A custom <code class="highlighter-rouge">TimestampExtractor</code> can be defined by implementing the corresponding interface.</p>

<h5 id="provided-watermark-strategies">Provided Watermark Strategies</h5>

<p>Flink provides <code class="highlighter-rouge">WatermarkStrategy</code> implementations for common use cases.</p>

<p>The following <code class="highlighter-rouge">WatermarkStrategy</code> implementations are currently available:</p>

<ul>
  <li><code class="highlighter-rouge">AscendingTimestamps</code>: A watermark strategy for ascending timestamps. Records with timestamps that are out-of-order will be considered late.</li>
  <li><code class="highlighter-rouge">BoundedOutOfOrderTimestamps(delay)</code>: A watermark strategy for timestamps that are at most out-of-order by the specified delay.</li>
  <li><code class="highlighter-rouge">PreserveWatermarks()</code>: A strategy which indicates the watermarks should be preserved from the underlying <code class="highlighter-rouge">DataStream</code>.</li>
</ul>

<p>A custom <code class="highlighter-rouge">WatermarkStrategy</code> can be defined by implementing the corresponding interface.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="defining-a-tablesource-with-projection-push-down">Defining a TableSource with Projection Push-Down</h3>

<p>A <code class="highlighter-rouge">TableSource</code> supports projection push-down by implementing the <code class="highlighter-rouge">ProjectableTableSource</code> interface. The interface defines a single method:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">ProjectableTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">projectFields</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">fields</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">ProjectableTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">projectFields</span><span class="o">(</span><span class="n">fields</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">projectFields(fields)</code>: Returns a <em>copy</em> of the <code class="highlighter-rouge">TableSource</code> with adjusted physical return type. The <code class="highlighter-rouge">fields</code> parameter provides the indexes of the fields that must be provided by the <code class="highlighter-rouge">TableSource</code>. The indexes relate to the <code class="highlighter-rouge">TypeInformation</code> of the physical return type, <em>not</em> to the logical table schema. The copied <code class="highlighter-rouge">TableSource</code> must adjust its return type and the returned <code class="highlighter-rouge">DataStream</code> or <code class="highlighter-rouge">DataSet</code>. The <code class="highlighter-rouge">TableSchema</code> of the copied <code class="highlighter-rouge">TableSource</code> must not be changed, i.e, it must be the same as the original <code class="highlighter-rouge">TableSource</code>. If the <code class="highlighter-rouge">TableSource</code> implements the <code class="highlighter-rouge">DefinedFieldMapping</code> interface, the field mapping must be adjusted to the new return type.</li>
</ul>

<p><span class="label label-danger">Attention</span> In order for Flink to distinguish a projection push-down table source from its original form, <code class="highlighter-rouge">explainSource</code> method must be override to include information regarding the projected fields.</p>

<p>The <code class="highlighter-rouge">ProjectableTableSource</code> adds support to project flat fields. If the <code class="highlighter-rouge">TableSource</code> defines a table with nested schema, it can implement the <code class="highlighter-rouge">NestedFieldsProjectableTableSource</code> to extend the projection to nested fields. The <code class="highlighter-rouge">NestedFieldsProjectableTableSource</code> is defined as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">NestedFieldsProjectableTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">projectNestedFields</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">fields</span><span class="o">,</span> <span class="nc">String</span><span class="o">[][]</span> <span class="n">nestedFields</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">NestedFieldsProjectableTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">projectNestedFields</span><span class="o">(</span><span class="n">fields</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Int</span><span class="o">],</span> <span class="n">nestedFields</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]])</span><span class="k">:</span> <span class="kt">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">projectNestedField(fields, nestedFields)</code>: Returns a <em>copy</em> of the <code class="highlighter-rouge">TableSource</code> with adjusted physical return type. Fields of the physical return type may be removed or reordered but their type must not be changed. The contract of this method is essentially the same as for the <code class="highlighter-rouge">ProjectableTableSource.projectFields()</code> method. In addition, the <code class="highlighter-rouge">nestedFields</code> parameter contains for each field index in the <code class="highlighter-rouge">fields</code> list, a list of paths to all nested fields that are accessed by the query. All other nested fields do not need to be read, parsed, and set in the records that are produced by the <code class="highlighter-rouge">TableSource</code>.</li>
</ul>

<p><span class="label label-danger">Attention</span> the types of the projected fields must not be changed but unused fields may be set to null or to a default value.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="defining-a-tablesource-with-filter-push-down">Defining a TableSource with Filter Push-Down</h3>

<p>The <code class="highlighter-rouge">FilterableTableSource</code> interface adds support for filter push-down to a <code class="highlighter-rouge">TableSource</code>. A <code class="highlighter-rouge">TableSource</code> extending this interface is able to filter records such that the returned <code class="highlighter-rouge">DataStream</code> or <code class="highlighter-rouge">DataSet</code> returns fewer records.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">FilterableTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">applyPredicate</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Expression</span><span class="o">&gt;</span> <span class="n">predicates</span><span class="o">);</span>

  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isFilterPushedDown</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">FilterableTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">applyPredicate</span><span class="o">(</span><span class="n">predicates</span><span class="k">:</span> <span class="kt">java.util.List</span><span class="o">[</span><span class="kt">Expression</span><span class="o">])</span><span class="k">:</span> <span class="kt">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">isFilterPushedDown</span><span class="k">:</span> <span class="kt">Boolean</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">applyPredicate(predicates)</code>: Returns a <em>copy</em> of the <code class="highlighter-rouge">TableSource</code> with added predicates. The <code class="highlighter-rouge">predicates</code> parameter is a mutable list of conjunctive predicates that are “offered” to the <code class="highlighter-rouge">TableSource</code>. The <code class="highlighter-rouge">TableSource</code> accepts to evaluate a predicate by removing it from the list. Predicates that are left in the list will be evaluated by a subsequent filter operator.</li>
  <li><code class="highlighter-rouge">isFilterPushedDown()</code>: Returns true if the <code class="highlighter-rouge">applyPredicate()</code> method was called before. Hence, <code class="highlighter-rouge">isFilterPushedDown()</code> must return true for all <code class="highlighter-rouge">TableSource</code> instances returned from a <code class="highlighter-rouge">applyPredicate()</code> call.</li>
</ul>

<p><span class="label label-danger">Attention</span> In order for Flink to distinguish a filter push-down table source from its original form, <code class="highlighter-rouge">explainSource</code> method must be override to include information regarding the push-down filters.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="defining-a-tablesource-for-lookups">Defining a TableSource for Lookups</h3>

<p><span class="label label-danger">Attention</span> This is an experimental feature. The interface may be changed in future versions. It’s only supported in Blink planner.</p>

<p>The <code class="highlighter-rouge">LookupableTableSource</code> interface adds support for the table to be accessed via key column(s) in a lookup fashion. This is very useful when used to join with a dimension table to enrich some information. If you want to use the <code class="highlighter-rouge">TableSource</code> in lookup mode, you should use the source in <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/joins.html">temporal table join syntax</a>.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">LookupableTableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSource</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TableFunction</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getLookupFunction</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">lookupkeys</span><span class="o">);</span>

  <span class="kd">public</span> <span class="nc">AsyncTableFunction</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getAsyncLookupFunction</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">lookupkeys</span><span class="o">);</span>

  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAsyncEnabled</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">LookupableTableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSource</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getLookupFunction</span><span class="o">(</span><span class="n">lookupKeys</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">TableFunction</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">getAsyncLookupFunction</span><span class="o">(</span><span class="n">lookupKeys</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">AsyncTableFunction</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">isAsyncEnabled</span><span class="k">:</span> <span class="kt">Boolean</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">getLookupFunction(lookupkeys)</code>: Returns a <code class="highlighter-rouge">TableFunction</code> which used to lookup the matched row(s) via lookup keys. The lookupkeys are the field names of <code class="highlighter-rouge">LookupableTableSource</code> in the join equal conditions. The eval method parameters of the returned <code class="highlighter-rouge">TableFunction</code>’s should be in the order which <code class="highlighter-rouge">lookupkeys</code> defined. It is recommended to define the parameters in varargs (e.g. <code class="highlighter-rouge">eval(Object... lookupkeys)</code> to match all the cases). The return type of the <code class="highlighter-rouge">TableFunction</code> must be identical to the return type defined by the <code class="highlighter-rouge">TableSource.getReturnType()</code> method.</li>
  <li><code class="highlighter-rouge">getAsyncLookupFunction(lookupkeys)</code>: Optional. Similar to <code class="highlighter-rouge">getLookupFunction</code>, but the <code class="highlighter-rouge">AsyncLookupFunction</code> lookups the matched row(s) asynchronously. The underlying of <code class="highlighter-rouge">AsyncLookupFunction</code> will be called via <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/asyncio.html">Async I/O</a>. The first argument of the eval method of the returned <code class="highlighter-rouge">AsyncTableFunction</code> should be defined as <code class="highlighter-rouge">java.util.concurrent.CompletableFuture</code> to collect results asynchronously (e.g. <code class="highlighter-rouge">eval(CompletableFuture&lt;Collection&lt;String&gt;&gt; result, Object... lookupkeys)</code>). The implementation of this method can throw an exception if the TableSource doesn’t support asynchronously lookup.</li>
  <li><code class="highlighter-rouge">isAsyncEnabled()</code>: Returns true if async lookup is enabled. It requires <code class="highlighter-rouge">getAsyncLookupFunction(lookupkeys)</code> is implemented if <code class="highlighter-rouge">isAsyncEnabled</code> returns true.</li>
</ul>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="define-a-tablesink">Define a TableSink</h2>

<p>A <code class="highlighter-rouge">TableSink</code> specifies how to emit a <code class="highlighter-rouge">Table</code> to an external system or location. The interface is generic such that it can support different storage locations and formats. There are different table sinks for batch tables and streaming tables.</p>

<p>The general interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">TableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getOutputType</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">String</span><span class="o">[]</span> <span class="nf">getFieldNames</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">[]</span> <span class="nf">getFieldTypes</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">TableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">fieldNames</span><span class="o">,</span> <span class="nc">TypeInformation</span><span class="o">[]</span> <span class="n">fieldTypes</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">TableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getOutputType</span><span class="k">:</span> <span class="kt">TypeInformation&lt;T&gt;</span>

  <span class="kt">def</span> <span class="kt">getFieldNames:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">getFieldTypes</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">TypeInformation</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">configure</span><span class="o">(</span><span class="n">fieldNames</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">],</span> <span class="n">fieldTypes</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">TypeInformation</span><span class="o">])</span><span class="k">:</span> <span class="kt">TableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p>The <code class="highlighter-rouge">TableSink#configure</code> method is called to pass the schema of the Table (field names and types) to emit to the <code class="highlighter-rouge">TableSink</code>. The method must return a new instance of the TableSink which is configured to emit the provided Table schema. Note that the provided <code class="highlighter-rouge">TableSchema</code> shouldn’t contain computed columns to reflect the schema of the physical <code class="highlighter-rouge">TableSink</code>.</p>

<h3 id="batchtablesink">BatchTableSink</h3>

<p>Defines an external <code class="highlighter-rouge">TableSink</code> to emit a batch table.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">BatchTableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">emitDataSet</span><span class="o">(</span><span class="nc">DataSet</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">dataSet</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">BatchTableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">emitDataSet</span><span class="o">(</span><span class="n">dataSet</span><span class="k">:</span> <span class="kt">DataSet</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="appendstreamtablesink">AppendStreamTableSink</h3>

<p>Defines an external <code class="highlighter-rouge">TableSink</code> to emit a streaming table with only insert changes.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">AppendStreamTableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">DataStreamSink</span><span class="o">&lt;?&gt;</span> <span class="n">consumeDataStream</span><span class="o">(</span><span class="nc">DataStream</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">dataStream</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">AppendStreamTableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">consumeDataStream</span><span class="o">(</span><span class="n">dataStream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">DataStreamSink</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p>If the table is also modified by update or delete changes, a <code class="highlighter-rouge">TableException</code> will be thrown.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="retractstreamtablesink">RetractStreamTableSink</h3>

<p>Defines an external <code class="highlighter-rouge">TableSink</code> to emit a streaming table with insert, update, and delete changes.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">RetractStreamTableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSink</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getRecordType</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">DataStreamSink</span><span class="o">&lt;?&gt;</span> <span class="n">consumeDataStream</span><span class="o">(</span><span class="nc">DataStream</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">dataStream</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">RetractStreamTableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSink</span><span class="o">[</span><span class="kt">Tuple2</span><span class="o">[</span><span class="kt">Boolean</span>, <span class="kt">T</span><span class="o">]]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">getRecordType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">consumeDataStream</span><span class="o">(</span><span class="n">dataStream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Tuple2</span><span class="o">[</span><span class="kt">Boolean</span>, <span class="kt">T</span><span class="o">]])</span><span class="k">:</span> <span class="kt">DataStreamSink</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p>The table will be converted into a stream of accumulate and retraction messages which are encoded as Java <code class="highlighter-rouge">Tuple2</code>. The first field is a boolean flag to indicate the message type (<code class="highlighter-rouge">true</code> indicates insert, <code class="highlighter-rouge">false</code> indicates delete). The second field holds the record of the requested type <code class="highlighter-rouge">T</code>.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="upsertstreamtablesink">UpsertStreamTableSink</h3>

<p>Defines an external <code class="highlighter-rouge">TableSink</code> to emit a streaming table with insert, update, and delete changes.</p>

<p>The interface looks as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">UpsertStreamTableSink</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">TableSink</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKeyFields</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">keys</span><span class="o">);</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setIsAppendOnly</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">isAppendOnly</span><span class="o">);</span>

  <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">getRecordType</span><span class="o">();</span>

  <span class="kd">public</span> <span class="nc">DataStreamSink</span><span class="o">&lt;?&gt;</span> <span class="n">consumeDataStream</span><span class="o">(</span><span class="nc">DataStream</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;&gt;</span> <span class="n">dataStream</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nc">UpsertStreamTableSink</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">extends</span> <span class="nc">TableSink</span><span class="o">[</span><span class="kt">Tuple2</span><span class="o">[</span><span class="kt">Boolean</span>, <span class="kt">T</span><span class="o">]]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">setKeyFields</span><span class="o">(</span><span class="n">keys</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span>

  <span class="k">def</span> <span class="nf">setIsAppendOnly</span><span class="o">(</span><span class="n">isAppendOnly</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span>

  <span class="k">def</span> <span class="nf">getRecordType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">consumeDataStream</span><span class="o">(</span><span class="n">dataStream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Tuple2</span><span class="o">[</span><span class="kt">Boolean</span>, <span class="kt">T</span><span class="o">]])</span><span class="k">:</span> <span class="kt">DataStreamSink</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p>The table must be have unique key fields (atomic or composite) or be append-only. If the table does not have a unique key and is not append-only, a <code class="highlighter-rouge">TableException</code> will be thrown. The unique key of the table is configured by the <code class="highlighter-rouge">UpsertStreamTableSink#setKeyFields()</code> method.</p>

<p>The table will be converted into a stream of upsert and delete messages which are encoded as a Java <code class="highlighter-rouge">Tuple2</code>. The first field is a boolean flag to indicate the message type. The second field holds the record of the requested type <code class="highlighter-rouge">T</code>.</p>

<p>A message with true boolean field is an upsert message for the configured key. A message with false flag is a delete message for the configured key. If the table is append-only, all messages will have a true flag and must be interpreted as insertions.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="define-a-tablefactory">Define a TableFactory</h2>

<p>A <code class="highlighter-rouge">TableFactory</code> allows to create different table-related instances from string-based properties. All available factories are called for matching to the given set of properties and a corresponding factory class.</p>

<p>Factories leverage Java’s <a href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html">Service Provider Interfaces (SPI)</a> for discovering. This means that every dependency and JAR file should contain a file <code class="highlighter-rouge">org.apache.flink.table.factories.TableFactory</code> in the <code class="highlighter-rouge">META_INF/services</code> resource directory that lists all available table factories that it provides.</p>

<p>Every table factory needs to implement the following interface:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.apache.flink.table.factories</span><span class="o">;</span>

<span class="kd">interface</span> <span class="nc">TableFactory</span> <span class="o">{</span>

  <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">requiredContext</span><span class="o">();</span>

  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">supportedProperties</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">org.apache.flink.table.factories</span>

<span class="k">trait</span> <span class="nc">TableFactory</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">requiredContext</span><span class="o">()</span><span class="k">:</span> <span class="kt">util.Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">supportedProperties</span><span class="o">()</span><span class="k">:</span> <span class="kt">util.List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<ul>
  <li><code class="highlighter-rouge">requiredContext()</code>: Specifies the context that this factory has been implemented for. The framework guarantees to only match for this factory if the specified set of properties and values are met. Typical properties might be <code class="highlighter-rouge">connector.type</code>, <code class="highlighter-rouge">format.type</code>, or <code class="highlighter-rouge">update-mode</code>. Property keys such as <code class="highlighter-rouge">connector.property-version</code> and <code class="highlighter-rouge">format.property-version</code> are reserved for future backwards compatibility cases.</li>
  <li><code class="highlighter-rouge">supportedProperties()</code>: List of property keys that this factory can handle. This method will be used for validation. If a property is passed that this factory cannot handle, an exception will be thrown. The list must not contain the keys that are specified by the context.</li>
</ul>

<p>In order to create a specific instance, a factory class can implement one or more interfaces provided in <code class="highlighter-rouge">org.apache.flink.table.factories</code>:</p>

<ul>
  <li><code class="highlighter-rouge">BatchTableSourceFactory</code>: Creates a batch table source.</li>
  <li><code class="highlighter-rouge">BatchTableSinkFactory</code>: Creates a batch table sink.</li>
  <li><code class="highlighter-rouge">StreamTableSourceFactory</code>: Creates a stream table source.</li>
  <li><code class="highlighter-rouge">StreamTableSinkFactory</code>: Creates a stream table sink.</li>
  <li><code class="highlighter-rouge">DeserializationSchemaFactory</code>: Creates a deserialization schema format.</li>
  <li><code class="highlighter-rouge">SerializationSchemaFactory</code>: Creates a serialization schema format.</li>
</ul>

<p>The discovery of a factory happens in multiple stages:</p>

<ul>
  <li>Discover all available factories.</li>
  <li>Filter by factory class (e.g., <code class="highlighter-rouge">StreamTableSourceFactory</code>).</li>
  <li>Filter by matching context.</li>
  <li>Filter by supported properties.</li>
  <li>Verify that exactly one factory matches, otherwise throw an <code class="highlighter-rouge">AmbiguousTableFactoryException</code> or <code class="highlighter-rouge">NoMatchingTableFactoryException</code>.</li>
</ul>

<p>The following example shows how to provide a custom streaming source with an additional <code class="highlighter-rouge">connector.debug</code> property flag for parameterization.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.flink.table.sources.StreamTableSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.flink.types.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MySystemTableSourceFactory</span> <span class="kd">implements</span> <span class="nc">StreamTableSourceFactory</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">requiredContext</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"update-mode"</span><span class="o">,</span> <span class="s">"append"</span><span class="o">);</span>
    <span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"connector.type"</span><span class="o">,</span> <span class="s">"my-system"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">context</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">supportedProperties</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">StreamTableSource</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="nf">createStreamTableSource</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">properties</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">isDebug</span> <span class="o">=</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">properties</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">));</span>

    <span class="err">#</span> <span class="n">additional</span> <span class="n">validation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">properties</span> <span class="n">can</span> <span class="n">also</span> <span class="n">happen</span> <span class="n">here</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nf">MySystemAppendTableSource</span><span class="o">(</span><span class="n">isDebug</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">java.util</span>
<span class="k">import</span> <span class="nn">org.apache.flink.table.sources.StreamTableSource</span>
<span class="k">import</span> <span class="nn">org.apache.flink.types.Row</span>

<span class="k">class</span> <span class="nc">MySystemTableSourceFactory</span> <span class="k">extends</span> <span class="nc">StreamTableSourceFactory</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">requiredContext</span><span class="o">()</span><span class="k">:</span> <span class="kt">util.Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">context</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">util</span><span class="o">.</span><span class="py">HashMap</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]()</span>
    <span class="nv">context</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="s">"update-mode"</span><span class="o">,</span> <span class="s">"append"</span><span class="o">)</span>
    <span class="nv">context</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="s">"connector.type"</span><span class="o">,</span> <span class="s">"my-system"</span><span class="o">)</span>
    <span class="n">context</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">supportedProperties</span><span class="o">()</span><span class="k">:</span> <span class="kt">util.List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">properties</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">util</span><span class="o">.</span><span class="py">ArrayList</span><span class="o">[</span><span class="kt">String</span><span class="o">]()</span>
    <span class="nv">properties</span><span class="o">.</span><span class="py">add</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">)</span>
    <span class="n">properties</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">createStreamTableSource</span><span class="o">(</span><span class="n">properties</span><span class="k">:</span> <span class="kt">util.Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">StreamTableSource</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">isDebug</span> <span class="k">=</span> <span class="nv">java</span><span class="o">.</span><span class="py">lang</span><span class="o">.</span><span class="py">Boolean</span><span class="o">.</span><span class="py">valueOf</span><span class="o">(</span><span class="nv">properties</span><span class="o">.</span><span class="py">get</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">))</span>

    <span class="k">#</span> <span class="n">additional</span> <span class="n">validation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">passed</span> <span class="n">properties</span> <span class="n">can</span> <span class="n">also</span> <span class="n">happen</span> <span class="n">here</span>

    <span class="k">new</span> <span class="nc">MySystemAppendTableSource</span><span class="o">(</span><span class="n">isDebug</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="use-a-tablefactory-in-the-sql-client">Use a TableFactory in the SQL Client</h3>

<p>In a SQL Client environment file, the previously presented factory could be declared as:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
 <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MySystemTable</span>
   <span class="na">type</span><span class="pi">:</span> <span class="s">source</span>
   <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
   <span class="na">connector</span><span class="pi">:</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">my-system</span>
     <span class="na">debug</span><span class="pi">:</span> <span class="no">true</span></code></pre></figure>

<p>The YAML file is translated into flattened string properties and a table factory is called with those properties that describe the connection to the external system:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">update-mode=append
connector.type=my-system
connector.debug=true</code></pre></figure>

<p><span class="label label-danger">Attention</span> Properties such as <code class="highlighter-rouge">tables.#.name</code> or <code class="highlighter-rouge">tables.#.type</code> are SQL Client specifics and are not passed to any factory. The <code class="highlighter-rouge">type</code> property decides, depending on the execution environment, whether a <code class="highlighter-rouge">BatchTableSourceFactory</code>/<code class="highlighter-rouge">StreamTableSourceFactory</code> (for <code class="highlighter-rouge">source</code>), a <code class="highlighter-rouge">BatchTableSinkFactory</code>/<code class="highlighter-rouge">StreamTableSinkFactory</code> (for <code class="highlighter-rouge">sink</code>), or both (for <code class="highlighter-rouge">both</code>) need to discovered.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="use-a-tablefactory-in-the-table--sql-api">Use a TableFactory in the Table &amp; SQL API</h3>

<p>For a type-safe, programmatic approach with explanatory Scaladoc/Javadoc, the Table &amp; SQL API offers descriptors in <code class="highlighter-rouge">org.apache.flink.table.descriptors</code> that translate into string-based properties. See the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connect.html">built-in descriptors</a> for sources, sinks, and formats as a reference.</p>

<div class="codetabs">
  <div data-lang="java">

    <p>A custom descriptor can be defined by extending the <code class="highlighter-rouge">ConnectorDescriptor</code> class.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.flink.table.descriptors.ConnectorDescriptor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="cm">/**
  * Connector to MySystem with debug mode.
  */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MySystemConnector</span> <span class="kd">extends</span> <span class="nc">ConnectorDescriptor</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">isDebug</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">MySystemConnector</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">isDebug</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="s">"my-system"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">isDebug</span> <span class="o">=</span> <span class="n">isDebug</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">protected</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">toConnectorProperties</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">properties</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">properties</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">,</span> <span class="nc">Boolean</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">isDebug</span><span class="o">));</span>
    <span class="k">return</span> <span class="n">properties</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

    <p>The descriptor can then be used to create a table with the table environment.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="c1">// ...</span>

<span class="n">tableEnv</span>
  <span class="o">.</span><span class="na">connect</span><span class="o">(</span><span class="k">new</span> <span class="nc">MySystemConnector</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withSchema</span><span class="o">(...)</span>
  <span class="o">.</span><span class="na">inAppendMode</span><span class="o">()</span>
  <span class="o">.</span><span class="na">createTemporaryTable</span><span class="o">(</span><span class="s">"MySystemTable"</span><span class="o">);</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <p>A custom descriptor can be defined by extending the <code class="highlighter-rouge">ConnectorDescriptor</code> class.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.flink.table.descriptors.ConnectorDescriptor</span>
<span class="k">import</span> <span class="nn">java.util.HashMap</span>
<span class="k">import</span> <span class="nn">java.util.Map</span>

<span class="cm">/**
  * Connector to MySystem with debug mode.
  */</span>
<span class="k">class</span> <span class="nc">MySystemConnector</span><span class="o">(</span><span class="n">isDebug</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">ConnectorDescriptor</span><span class="o">(</span><span class="s">"my-system"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="kc">false</span><span class="o">)</span> <span class="o">{</span>
  
  <span class="k">override</span> <span class="k">protected</span> <span class="k">def</span> <span class="nf">toConnectorProperties</span><span class="o">()</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">properties</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">String</span><span class="o">]</span>
    <span class="nv">properties</span><span class="o">.</span><span class="py">put</span><span class="o">(</span><span class="s">"connector.debug"</span><span class="o">,</span> <span class="nv">isDebug</span><span class="o">.</span><span class="py">toString</span><span class="o">)</span>
    <span class="n">properties</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

    <p>The descriptor can then be used to create a table with the table environment.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">tableEnv</span><span class="k">:</span> <span class="kt">StreamTableEnvironment</span> <span class="o">=</span> <span class="c1">// ...</span>

<span class="n">tableEnv</span>
  <span class="o">.</span><span class="py">connect</span><span class="o">(</span><span class="k">new</span> <span class="nc">MySystemConnector</span><span class="o">(</span><span class="n">isDebug</span> <span class="k">=</span> <span class="kc">true</span><span class="o">))</span>
  <span class="o">.</span><span class="py">withSchema</span><span class="o">(...)</span>
  <span class="o">.</span><span class="py">inAppendMode</span><span class="o">()</span>
  <span class="o">.</span><span class="py">createTemporaryTable</span><span class="o">(</span><span class="s">"MySystemTable"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">

    <p>You can use a Java <code class="highlighter-rouge">TableFactory</code> from Python using the <code class="highlighter-rouge">CustomConnectorDescriptor</code>.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s_env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="n">get_execution_environment</span><span class="p">()</span>
<span class="n">st_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">s_env</span><span class="p">)</span>

<span class="n">custom_connector</span> <span class="o">=</span> <span class="n">CustomConnectorDescriptor</span><span class="p">(</span><span class="s">'my-system'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">st_env</span>\
    <span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="n">custom_connector</span><span class="p">.</span><span class="nb">property</span><span class="p">(</span><span class="s">"connector.debug"</span><span class="p">,</span> <span class="s">"true"</span><span class="p">))</span> \
    <span class="p">.</span><span class="n">with_schema</span><span class="p">(...)</span> \
    <span class="p">.</span><span class="n">in_append_mode</span><span class="p">()</span>\
    <span class="p">.</span><span class="n">create_temporary_table</span><span class="p">(</span><span class="s">"MySystemTable"</span><span class="p">)</span></code></pre></figure>

  </div>

</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      Want to contribute translation?
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
