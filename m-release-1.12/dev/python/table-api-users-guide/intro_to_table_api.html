<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: Intro to the Python Table API</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/dev/python/table-api-users-guide/intro_to_table_api.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/local_installation.html">Local Installation</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/datastream_api.html">Fraud Detection with the DataStream API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/table_api.html">Real Time Reporting with the Table API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/try-flink/flink-operations-playground.html">Flink Operations Playground</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> Learn Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/datastream_api.html">Intro to the DataStream API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/etl.html">Data Pipelines & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/streaming_analytics.html">Streaming Analytics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/event_driven.html">Event-driven Applications</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/learn-flink/fault_tolerance.html">Fault Tolerance</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/index.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/stateful-stream-processing.html">Stateful Stream Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/timely-stream-processing.html">Timely Stream Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/flink-architecture.html">Flink Architecture</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/concepts/glossary.html">Glossary</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/datastream_api.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">Event Time<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_time.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamps_watermarks.html">Generating Watermarks</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/event_timestamp_extractors.html">Builtin Watermark Generators</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">State & Fault Tolerance<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/broadcast_state.html">The Broadcast State Pattern</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/schema_evolution.html">State Schema Evolution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/state/custom_serialization.html">Custom State Serialization</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/user_defined_functions.html">User-Defined Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">Operators<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/windows.html">Windows</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/operators/asyncio.html">Async I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/side_output.html">Side Outputs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/testing.html">Testing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/experimental.html">Experimental Features</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/java_lambdas.html">Java Lambda Expressions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/iterations.html">Iterations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/hadoop_compatibility.html">Hadoop Compatibility</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/local_execution.html">Local Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/cluster_execution.html">Cluster Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/examples.html">Batch Examples</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse">Table API & SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/common.html">Concepts & Common API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">Streaming Concepts<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/dynamic_tables.html">Dynamic Tables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/time_attributes.html">Time Attributes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/joins.html">Joins in Continuous Queries</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/temporal_tables.html">Temporal Tables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/match_recognize.html">Detecting Patterns</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/queries.html">Queries</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/create.html">CREATE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/drop.html">DROP Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/alter.html">ALTER Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/insert.html">INSERT Statement</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/describe.html">DESCRIBE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/explain.html">EXPLAIN Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/use.html">USE Statements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/show.html">SHOW Statements</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">Functions<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/systemFunctions.html">System (Built-in) Functions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/functions/udfs.html">User-defined Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/modules.html">Modules</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sqlClient.html">SQL Client</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/config.html">Configuration</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tuning/streaming_aggregation_optimization.html">Streaming Aggregation</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse"class="active">Python API</a><div class="collapse in" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/installation.html">Installation</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table_api_tutorial.html">Table API Tutorial</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream_tutorial.html">DataStream API Tutorial</a></li>
<li><a href="#collapse-103" data-toggle="collapse"class="active">Table API User's Guide</a><div class="collapse in" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/intro_to_table_api.html" class="active">Intro to the Python Table API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/python_types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/built_in_functions.html">System (Built-in) Functions</a></li>
<li><a href="#collapse-109" data-toggle="collapse">User Defined Functions<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/python_udfs.html">General User-defined Functions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">Vectorized User-defined Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/conversion_of_pandas.html">Conversions between PyFlink Table and Pandas DataFrame</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/dependency_management.html">Dependency Management</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/metrics.html">Metrics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/python_table_api_connectors.html">Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API User's Guide<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/data_types.html">Data Types</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/operators.html">Operators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/datastream-api-users-guide/dependency_management.html">Dependency Management</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/python_config.html">Configuration</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/environment_variables.html">Environment Variables</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/faq.html">FAQ</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">Data Types & Serialization<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/types_serialization.html">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/custom_serializers.html">Custom Serializers</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">Managing Execution<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/execution_configuration.html">Execution Configuration</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/packaging.html">Program Packaging</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/parallel.html">Parallel Execution</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/execution_plans.html">Execution Plans</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/task_failure_recovery.html">Task Failure Recovery</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/migration.html">API Migration Guides</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/cep.html">Event Processing (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">Graphs: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/guarantees.html">Fault Tolerance Guarantees</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/">Overview</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_dialect.html">Hive Dialect</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/hive/hive_functions.html">Hive Functions</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/connectors/downloads.html">Download</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/">Overview</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/local.html">Local Cluster</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html">Configuration</a></li>
<li><a href="#collapse-213" data-toggle="collapse">Memory Configuration<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup.html">Set up Flink's Process Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_tm.html">Set up TaskManager Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_setup_jobmanager.html">Set up JobManager Memory</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_tuning.html">Memory tuning guide</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_trouble.html">Troubleshooting</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/memory/mem_migration.html">Migration Guide</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">File Systems<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/common.html">Common Configurations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/oss.html">Aliyun OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/azure.html">Azure Blob Storage</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/">Overview</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/security/security-ssl.html">SSL Setup</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/external_resources.html">External Resources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/advanced/logging.html">Logging</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">State & Fault Tolerance<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/metrics.html">Metrics</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/debugging_event_time.html">Debugging Windows & Event Time</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/debugging_classloading.html">Debugging Classloading</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/debugging/application_profiling.html">Application Profiling & Debugging</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/monitoring/checkpoint_monitoring.html">Monitoring Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/monitoring/back_pressure.html">Monitoring Back Pressure</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/upgrading.html">Upgrading Applications and Flink Versions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/ops/production_ready.html">Production Readiness Checklist</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink Development<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/flinkDev/ide_setup.html">Importing Flink into an IDE</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/flinkDev/building.html">Building Flink from Source</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> Internals<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/job_scheduling.html">Jobs and Scheduling</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/task_lifecycle.html">Task Lifecycle</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/internals/filesystems.html">File Systems</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><!-- link to the Chinese home page when current is blog page -->
    <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html">
      <button type="submit" class="btn btn-default">中文版</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/">Python API</a></li>
  
    <li>Table API User's Guide</li>
  
    <li class="active">Intro to the Python Table API</li>
</ol>

<h1>Intro to the Python Table API</h1>




<p>This document is a short introduction to the PyFlink Table API, which is used to help novice users quickly understand the basic usage of PyFlink Table API.
For advanced usage, please refer to other documents in this User Guide.</p>

<ul id="markdown-toc">
  <li><a href="#common-structure-of-python-table-api-program" id="markdown-toc-common-structure-of-python-table-api-program">Common Structure of Python Table API Program</a></li>
  <li><a href="#create-a-tableenvironment" id="markdown-toc-create-a-tableenvironment">Create a TableEnvironment</a></li>
  <li><a href="#create-tables" id="markdown-toc-create-tables">Create Tables</a>    <ul>
      <li><a href="#create-using-a-list-object" id="markdown-toc-create-using-a-list-object">Create using a List Object</a></li>
      <li><a href="#create-using-a-connector" id="markdown-toc-create-using-a-connector">Create using a Connector</a></li>
      <li><a href="#create-using-a-catalog" id="markdown-toc-create-using-a-catalog">Create using a Catalog</a></li>
    </ul>
  </li>
  <li><a href="#write-queries" id="markdown-toc-write-queries">Write Queries</a>    <ul>
      <li><a href="#write-table-api-queries" id="markdown-toc-write-table-api-queries">Write Table API Queries</a></li>
      <li><a href="#write-sql-queries" id="markdown-toc-write-sql-queries">Write SQL Queries</a></li>
      <li><a href="#mix-the-table-api-and-sql" id="markdown-toc-mix-the-table-api-and-sql">Mix the Table API and SQL</a></li>
    </ul>
  </li>
  <li><a href="#emit-results" id="markdown-toc-emit-results">Emit Results</a>    <ul>
      <li><a href="#collect-results-to-client" id="markdown-toc-collect-results-to-client">Collect Results to Client</a></li>
      <li><a href="#emit-results-to-one-sink-table" id="markdown-toc-emit-results-to-one-sink-table">Emit Results to One Sink Table</a></li>
      <li><a href="#emit-results-to-multiple-sink-tables" id="markdown-toc-emit-results-to-multiple-sink-tables">Emit Results to Multiple Sink Tables</a></li>
    </ul>
  </li>
  <li><a href="#explain-tables" id="markdown-toc-explain-tables">Explain Tables</a></li>
</ul>

<h2 id="common-structure-of-python-table-api-program">Common Structure of Python Table API Program</h2>

<p>All Table API and SQL programs, both batch and streaming, follow the same pattern. The following code example shows the common structure of Table API and SQL programs.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="c1"># 1. create a TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># 2. create source Table
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE datagen (
        id INT,
        data STRING
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind' = 'sequence',
        'fields.id.start' = '1',
        'fields.id.end' = '10'
    )
"""</span><span class="p">)</span>

<span class="c1"># 3. create sink Table
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print (
        id INT,
        data STRING
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># 4. query from source table and perform caculations
# create a Table from a Table API query:
</span><span class="n">source_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"datagen"</span><span class="p">)</span>
<span class="c1"># or create a Table from a SQL query:
</span><span class="n">source_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">sql_query</span><span class="p">(</span><span class="s">"SELECT * FROM datagen"</span><span class="p">)</span>

<span class="n">result_table</span> <span class="o">=</span> <span class="n">source_table</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">source_table</span><span class="p">.</span><span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">source_table</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># 5. emit query result to sink table
# emit a Table API result Table to a sink table:
</span><span class="n">result_table</span><span class="p">.</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"print"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span>
<span class="c1"># or emit results via SQL query:
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO print SELECT * FROM datagen"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="create-a-tableenvironment">Create a TableEnvironment</h2>

<p>The <code class="highlighter-rouge">TableEnvironment</code> is a central concept of the Table API and SQL integration. The following code example shows how to create a TableEnvironment:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="c1"># create a blink streaming TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># create a blink batch TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># create a flink streaming TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_old_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># create a flink batch TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_old_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span></code></pre></figure>

<p>For more details about the different ways to create a <code class="highlighter-rouge">TableEnvironment</code>, please refer to the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/table_environment.html#create-a-tableenvironment">TableEnvironment Documentation</a>.</p>

<p>The <code class="highlighter-rouge">TableEnvironment</code> is responsible for:</p>

<ul>
  <li>Creating <code class="highlighter-rouge">Table</code>s</li>
  <li>Registering <code class="highlighter-rouge">Table</code>s as a temporary view</li>
  <li>Executing SQL queries, see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/">SQL</a> for more details</li>
  <li>Registering user-defined (scalar, table, or aggregation) functions, see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/python_udfs.html">General User-defined Functions</a> and <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">Vectorized User-defined Functions</a> for more details</li>
  <li>Configuring the job, see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/python_config.html">Python Configuration</a> for more details</li>
  <li>Managing Python dependencies, see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/dependency_management.html">Dependency Management</a> for more details</li>
  <li>Submitting the jobs for execution</li>
</ul>

<p>Currently there are 2 planners available: flink planner and blink planner.</p>

<p>You should explicitly set which planner to use in the current program.
We recommend using the blink planner as much as possible.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="create-tables">Create Tables</h2>

<p><code class="highlighter-rouge">Table</code> is a core component of the Python Table API. A <code class="highlighter-rouge">Table</code> is a logical representation of the intermediate result of a Table API Job.</p>

<p>A <code class="highlighter-rouge">Table</code> is always bound to a specific <code class="highlighter-rouge">TableEnvironment</code>. It is not possible to combine tables from different TableEnvironments in same query, e.g., to join or union them.</p>

<h3 id="create-using-a-list-object">Create using a List Object</h3>

<p>You can create a Table from a list object:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># create a blink batch TableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   _1     _2
0   1     Hi
1   2  Hello</code></pre></figure>

<p>You can also create the Table with specified column names:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p>By default the table schema is extracted from the data automatically.</p>

<p>If the automatically generated table schema isn’t satisfactory, you can specify it manually:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_without_schema</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="c1"># by default the type of the "id" column is 64 bit int
</span><span class="n">default_type</span> <span class="o">=</span> <span class="n">table_without_schema</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()[</span><span class="s">"id"</span><span class="p">].</span><span class="n">dtype</span>
<span class="k">print</span><span class="p">(</span><span class="s">'By default the type of the "id" column is %s.'</span> <span class="o">%</span> <span class="n">default_type</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">DataTypes</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span>
                                <span class="n">DataTypes</span><span class="p">.</span><span class="n">ROW</span><span class="p">([</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">TINYINT</span><span class="p">()),</span>
                                               <span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">STRING</span><span class="p">())]))</span>
<span class="c1"># now the type of the "id" column is 8 bit int
</span><span class="nb">type</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()[</span><span class="s">"id"</span><span class="p">].</span><span class="n">dtype</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Now the type of the "id" column is %s.'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">)</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">By default the type of the "id" column is int64.
Now the type of the "id" column is int8.</code></pre></figure>

<h3 id="create-using-a-connector">Create using a Connector</h3>

<p>You can create a Table using connector DDL:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># create a blink stream TableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE random_source (
        id BIGINT, 
        data TINYINT 
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='3',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='6'
    )
"""</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"random_source"</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id  data
0   2     5
1   1     4
2   3     6</code></pre></figure>

<h3 id="create-using-a-catalog">Create using a Catalog</h3>

<p>A <code class="highlighter-rouge">TableEnvironment</code> maintains a map of catalogs of tables which are created with an identifier.</p>

<p>The tables in a catalog may either be temporary, and tied to the lifecycle of a single Flink session, or permanent, and visible across multiple Flink sessions.</p>

<p>The tables and views created via SQL DDL, e.g. “create table …” and “create view …” are also stored in a catalog.</p>

<p>You can directly access the tables in a catalog via SQL.</p>

<p>If you want to use tables from a catalog with the Table API, you can use the “from_path” method to create the Table API objects:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># prepare the catalog
# register Table API tables in the catalog
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">'source_table'</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># create Table API table from catalog
</span><span class="n">new_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">'source_table'</span><span class="p">)</span>
<span class="n">new_table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="write-queries">Write Queries</h2>

<h3 id="write-table-api-queries">Write Table API Queries</h3>

<p>The <code class="highlighter-rouge">Table</code> object offers many methods for applying relational operations. 
These methods return new <code class="highlighter-rouge">Table</code> objects representing the result of applying the relational operations on the input <code class="highlighter-rouge">Table</code>. 
These relational operations may be composed of multiple method calls, such as <code class="highlighter-rouge">table.group_by(...).select(...)</code>.</p>

<p>The <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html?code_tab=python">Table API</a> documentation describes all Table API operations that are supported on streaming and batch tables.</p>

<p>The following example shows a simple Table API aggregation query:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># using batch table environment to execute the queries
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="s">'Jack'</span><span class="p">,</span> <span class="s">'FRANCE'</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">'Rose'</span><span class="p">,</span> <span class="s">'ENGLAND'</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="s">'Jack'</span><span class="p">,</span> <span class="s">'FRANCE'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)],</span>
                                 <span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'country'</span><span class="p">,</span> <span class="s">'revenue'</span><span class="p">])</span>

<span class="c1"># compute revenue for all customers from France
</span><span class="n">revenue</span> <span class="o">=</span> <span class="n">orders</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">country</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">revenue</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">country</span> <span class="o">==</span> <span class="s">'FRANCE'</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">revenue</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'rev_sum'</span><span class="p">))</span>
    
<span class="n">revenue</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   name  rev_sum
0  Jack       30</code></pre></figure>

<h3 id="write-sql-queries">Write SQL Queries</h3>

<p>Flink’s SQL integration is based on <a href="https://calcite.apache.org">Apache Calcite</a>, which implements the SQL standard. SQL queries are specified as Strings.</p>

<p>The <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/">SQL</a> documentation describes Flink’s SQL support for streaming and batch tables.</p>

<p>The following example shows a simple SQL aggregation query:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># use a StreamTableEnvironment to execute the queries
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>


<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE random_source (
        id BIGINT, 
        data TINYINT
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='8',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='11'
    )
"""</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print_sink (
        id BIGINT, 
        data_sum TINYINT 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    INSERT INTO print_sink
        SELECT id, sum(data) as data_sum FROM 
            (SELECT id / 2 as id, data FROM random_source)
        WHERE id &gt; 1
        GROUP BY id
"""</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">2&gt; +I(4,11)
6&gt; +I(2,8)
8&gt; +I(3,10)
6&gt; -U(2,8)
8&gt; -U(3,10)
6&gt; +U(2,15)
8&gt; +U(3,19)</code></pre></figure>

<p>In fact, this shows the change logs received by the print sink.
The output format of a change log is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">{subtask id}&gt; {message type}{string format of the value}</code></pre></figure>

<p>For example, “2&gt; +I(4,11)” means this message comes from the 2nd subtask, and “+I” means it is an insert message. “(4, 11)” is the content of the message.
In addition, “-U” means a retract record (i.e. update-before), which means this message should be deleted or retracted from the sink. 
“+U” means this is an update record (i.e. update-after), which means this message should be updated or inserted by the sink.</p>

<p>So, we get this result from the change logs above:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">(4, 11)
(2, 15) 
(3, 19)</code></pre></figure>

<h3 id="mix-the-table-api-and-sql">Mix the Table API and SQL</h3>

<p>The <code class="highlighter-rouge">Table</code> objects used in Table API and the tables used in SQL can be freely converted to each other.</p>

<p>The following example shows how to use a <code class="highlighter-rouge">Table</code> object in SQL:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># create a sink table to emit results
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE table_sink (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># convert the Table API table to a SQL view
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">'table_api_table'</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># emit the Table API table
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO table_sink SELECT * FROM table_api_table"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">6&gt; +I(1,Hi)
6&gt; +I(2,Hello)</code></pre></figure>

<p>And the following example shows how to use SQL tables in the Table API:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># create a sql source table
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE sql_source (
        id BIGINT, 
        data TINYINT 
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='4',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='7'
    )
"""</span><span class="p">)</span>

<span class="c1"># convert the sql table to Table API table
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"sql_source"</span><span class="p">)</span>

<span class="c1"># or create the table from a sql query
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">sql_query</span><span class="p">(</span><span class="s">"SELECT * FROM sql_source"</span><span class="p">)</span>

<span class="c1"># emit the table
</span><span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id  data
0   2     5
1   1     4
2   4     7
3   3     6</code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="emit-results">Emit Results</h2>

<h3 id="collect-results-to-client">Collect Results to Client</h3>

<p>You can call the “to_pandas” method to <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/conversion_of_pandas.html#convert-pyflink-table-to-pandas-dataframe">convert a <code class="highlighter-rouge">Table</code> object to a pandas DataFrame</a>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p><span class="label label-info">Note</span> “to_pandas” will trigger the materialization of the table and collect table content to the memory of the client, it’s good practice to limit the number of rows collected via <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python/pyflink.table.html#pyflink.table.Table.limit">Table.limit</a>.
<span class="label label-info">Note</span> “to_pandas” is not supported by the flink planner, and not all data types can be emitted to pandas DataFrames.</p>

<h3 id="emit-results-to-one-sink-table">Emit Results to One Sink Table</h3>

<p>You can call the “execute_insert” method to emit the data in a <code class="highlighter-rouge">Table</code> object to a sink table:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"sink_table"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">6&gt; +I(1,Hi)
6&gt; +I(2,Hello)</code></pre></figure>

<p>This could also be done using SQL:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">"table_source"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO sink_table SELECT * FROM table_source"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<h3 id="emit-results-to-multiple-sink-tables">Emit Results to Multiple Sink Tables</h3>

<p>You can use a <code class="highlighter-rouge">StatementSet</code> to emit the <code class="highlighter-rouge">Table</code>s to multiple sink tables in one job:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># prepare source tables and sink tables
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">"simple_source"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE first_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE second_sink_table (
        id BIGINT, 
        data VARCHAR
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># create a statement set
</span><span class="n">statement_set</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">create_statement_set</span><span class="p">()</span>

<span class="c1"># emit the "table" object to the "first_sink_table"
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"first_sink_table"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># emit the "simple_source" to the "second_sink_table" via a insert sql query
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert_sql</span><span class="p">(</span><span class="s">"INSERT INTO second_sink_table SELECT * FROM simple_source"</span><span class="p">)</span>

<span class="c1"># execute the statement set
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">execute</span><span class="p">().</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">7&gt; +I(1,Hi)
7&gt; +I(1,Hi)
7&gt; +I(2,Hello)
7&gt; +I(2,Hello)</code></pre></figure>

<h2 id="explain-tables">Explain Tables</h2>

<p>The Table API provides a mechanism to explain the logical and optimized query plans used to compute a <code class="highlighter-rouge">Table</code>. 
This is done through the <code class="highlighter-rouge">Table.explain()</code> or <code class="highlighter-rouge">StatementSet.explain()</code> methods. <code class="highlighter-rouge">Table.explain()</code>returns the plan of a <code class="highlighter-rouge">Table</code>. <code class="highlighter-rouge">StatementSet.explain()</code> returns the plan for multiple sinks. These methods return a string describing three things:</p>

<ol>
  <li>the Abstract Syntax Tree of the relational query, i.e., the unoptimized logical query plan,</li>
  <li>the optimized logical query plan, and</li>
  <li>the physical execution plan.</li>
</ol>

<p><code class="highlighter-rouge">TableEnvironment.explain_sql()</code> and <code class="highlighter-rouge">TableEnvironment.execute_sql()</code> support executing an <code class="highlighter-rouge">EXPLAIN</code> statement to get the plans. Please refer to the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sql/explain.html">EXPLAIN</a> page for more details.</p>

<p>The following code shows how to use the <code class="highlighter-rouge">Table.explain()</code> method:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># using a StreamTableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table1</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table1</span> \
    <span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">table1</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">like</span><span class="p">(</span><span class="s">'H%'</span><span class="p">))</span> \
    <span class="p">.</span><span class="n">union_all</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">explain</span><span class="p">())</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">== Abstract Syntax Tree ==
LogicalUnion(all=[true])
:- LogicalFilter(condition=[LIKE($1, _UTF-16LE'H%')])
:  +- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]]])
+- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]]])

== Optimized Logical Plan ==
Union(all=[true], union=[id, data])
:- Calc(select=[id, data], where=[LIKE(data, _UTF-16LE'H%')])
:  +- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])
+- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

== Physical Execution Plan ==
Stage 133 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 134 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 135 : Operator
                        content : Calc(select=[id, data], where=[(data LIKE _UTF-16LE'H%')])
                        ship_strategy : FORWARD

Stage 136 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 137 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD</code></pre></figure>

<p>The following code shows how to use the <code class="highlighter-rouge">StatementSet.explain()</code> method:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># using a StreamTableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table1</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE black_hole_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'blackhole'
    )
"""</span><span class="p">)</span>

<span class="n">statement_set</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">create_statement_set</span><span class="p">()</span>

<span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"print_sink_table"</span><span class="p">,</span> <span class="n">table1</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">table1</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">like</span><span class="p">(</span><span class="s">'H%'</span><span class="p">)))</span>
<span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"black_hole_sink_table"</span><span class="p">,</span> <span class="n">table2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">statement_set</span><span class="p">.</span><span class="n">explain</span><span class="p">())</span></code></pre></figure>

<p>The result is:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">== Abstract Syntax Tree ==
LogicalSink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
+- LogicalFilter(condition=[LIKE($1, _UTF-16LE'H%')])
   +- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]]])

LogicalSink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
+- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]]])

== Optimized Logical Plan ==
Sink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
+- Calc(select=[id, data], where=[LIKE(data, _UTF-16LE'H%')])
   +- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

Sink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
+- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

== Physical Execution Plan ==
Stage 139 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 140 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 141 : Operator
                        content : Calc(select=[id, data], where=[(data LIKE _UTF-16LE'H%')])
                        ship_strategy : FORWARD

Stage 143 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 144 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 142 : Data Sink
                        content : Sink: Sink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
                        ship_strategy : FORWARD

                        Stage 145 : Data Sink
                                content : Sink: Sink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
                                ship_strategy : FORWARD</code></pre></figure>




<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      Want to contribute translation?
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
