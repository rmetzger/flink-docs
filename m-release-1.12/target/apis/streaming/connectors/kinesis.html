<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.1-SNAPSHOT Documentation: Amazon AWS Kinesis Streams Connector</title>
    <link rel="shortcut icon" href="/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/page/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/page/css/flink.css">
    <link rel="stylesheet" href="/page/css/syntax.css">
    <link rel="stylesheet" href="/page/css/codetabs.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    
    





    <!-- Top navbar. -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- The logo. -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-logo">
            <a href="http://flink.apache.org"><img alt="Apache Flink" src="/page/img/navbar-brand-logo.jpg"></a>
          </div>
        </div><!-- /.navbar-header -->

        <!-- The navigation links. -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="hidden-sm "><a href="/">Docs v1.1</a></li>

            <li class=""><a href="/concepts/concepts.html">Concepts</a></li>

            <!-- Setup -->
            <li class="dropdown">
              <a href="/setup" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Setup <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                <li class=""><a href="/setup/building.html">Build Flink from Source</a></li>
                
                <li class=""><a href="/setup/config.html">Configuration</a></li>
                

                <li class="divider"></li>
                <li role="presentation" class="dropdown-header"><strong>Quickstart</strong></li>

                <!-- Quickstart -->
                
                
                <li class=""><a href="/quickstart/setup_quickstart.html">Setup & Run Example</a></li>
                
                <li class=""><a href="/quickstart/java_api_quickstart.html">Java API</a></li>
                
                <li class=""><a href="/quickstart/scala_api_quickstart.html">Scala API</a></li>
                

                <li class="divider"></li>
                <li role="presentation" class="dropdown-header"><strong>Deployment</strong></li>
                
                
                <li class=""><a href="/setup/local_setup.html">Local</a></li>
                
                <li class=""><a href="/setup/cluster_setup.html">Cluster (Standalone)</a></li>
                
                <li class=""><a href="/setup/yarn_setup.html">YARN</a></li>
                
                <li class=""><a href="/setup/gce_setup.html">Google Compute Engine</a></li>
                
                <li class=""><a href="/setup/aws.html">AWS</a></li>
                
                <li class=""><a href="/setup/jobmanager_high_availability.html">High Availability</a></li>
                
              </ul>
            </li>

            <!-- Programming Guides -->
            <li class="dropdown active">
              <a href="/apis" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Programming Guides <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                <li class=""><a href="/apis/common/index.html"><strong>Basic API Concepts</strong></a></li>
                
                <li class=""><a href="/apis/streaming/index.html"><strong>Streaming Guide</strong> (DataStream API)</a></li>
                
                <li class=""><a href="/apis/batch/index.html"><strong>Batch Guide</strong> (DataSet API)</a></li>
                
                <li class=""><a href="/apis/best_practices.html">Best Practices</a></li>
                
                <li class=""><a href="/apis/table.html">Table API and SQL</a></li>
                
                <li class=""><a href="/apis/cli.html">Command-Line Interface</a></li>
                
                <li class=""><a href="/apis/local_execution.html">Local Execution</a></li>
                
                <li class=""><a href="/apis/cluster_execution.html">Cluster Execution</a></li>
                
                <li class=""><a href="/apis/scala_shell.html">Scala Shell</a></li>
                
                <li class=""><a href="/apis/scala_api_extensions.html">Scala API Extensions</a></li>
                
                <li class=""><a href="/apis/java8.html">Java 8</a></li>
                
              </ul>
            </li>

            <!-- Libraries -->
            <li class="dropdown">
              <a href="/libs" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Libraries <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                  
                  
                  <li class=""><a href="/apis/batch/libs/gelly.html">Graphs: Gelly</a></li>
                  
                  <li class=""><a href="/apis/streaming/libs/cep.html">CEP</a></li>
                  
                  <li class=""><a href="/apis/batch/libs/ml/index.html">Machine Learning</a></li>
                  
              </ul>
            </li>

            <!-- Internals -->
            <li class="dropdown">
              <a href="/internals" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Internals <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li role="presentation" class="dropdown-header"><strong>Contribute</strong></li>
                <li><a href="http://flink.apache.org/how-to-contribute.html"><small><span class="glyphicon glyphicon-new-window"></span></small> How to Contribute</a></li>
                <li><a href="http://flink.apache.org/contribute-code.html#coding-guidelines"><small><span class="glyphicon glyphicon-new-window"></span></small> Coding Guidelines</a></li>
                
                
                <li class=""><a href="/internals/ide_setup.html">IDE Setup</a></li>
                
                <li class=""><a href="/internals/logging.html">Logging</a></li>
                
                <li class=""><a href="/internals/general_arch.html">Architecture and Process Model</a></li>
                
                <li class=""><a href="/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
                
                <li class=""><a href="/internals/types_serialization.html">Type Extraction and Serialization</a></li>
                
                <li class=""><a href="/internals/monitoring_rest_api.html">Monitoring REST API</a></li>
                
                <li class=""><a href="/internals/job_scheduling.html">Jobs and Scheduling</a></li>
                
                <li class=""><a href="/internals/add_operator.html">How-To: Add an Operator</a></li>
                
                <li class=""><a href="/internals/back_pressure_monitoring.html">Back Pressure Monitoring</a></li>
                
              </ul>
            </li>
          </ul>
          <form class="navbar-form navbar-right hidden-sm hidden-md" role="search" action="/search-results.html">
            <div class="form-group">
              <input type="text" class="form-control" size="16px" name="q" placeholder="Search all pages">
            </div>
            <button type="submit" class="btn btn-default">Search</button>
          </form>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container -->
    </nav>


    

    <!-- Main content. -->
    <div class="container">
      
      
<div class="row">


  <!-- Sub Navigation -->
  <div class="col-sm-3">
    <ul id="sub-nav">
      
      
      
        
        
        
        <li><a href="/apis/streaming/index.html" class="">DataStream API</a>
          
        </li>
      
        
        
        
        <li><a href="/quickstart/run_example_quickstart.html" class="">Example: Wikipedia Edits</a>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/event_time.html" class="">Event Time</a>
          
          <ul>
            
              <li><a href="/apis/streaming/event_timestamp_extractors.html" class="">Pre-defined Timestamp Extractors / Watermark Emitters</a></li>
            
              <li><a href="/apis/streaming/event_timestamps_watermarks.html" class="">Generating Timestamps / Watermarks</a></li>
            
          </ul>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/windows.html" class="">Windows</a>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/fault_tolerance.html" class="">Fault Tolerance</a>
          
          <ul>
            
              <li><a href="/apis/streaming/state.html" class="">Working with State</a></li>
            
              <li><a href="/apis/streaming/state_backends.html" class="">State Backends</a></li>
            
          </ul>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/connectors/index.html" class="">Connectors</a>
          
          <ul>
            
              <li><a href="/apis/streaming/connectors/kafka.html" class="">Kafka</a></li>
            
              <li><a href="/apis/streaming/connectors/elasticsearch.html" class="">Elasticsearch</a></li>
            
              <li><a href="/apis/streaming/connectors/elasticsearch2.html" class="">Elasticsearch 2.x</a></li>
            
              <li><a href="/apis/streaming/connectors/filesystem_sink.html" class="">Filesystem Sink</a></li>
            
              <li><a href="/apis/streaming/connectors/rabbitmq.html" class="">RabbitMQ</a></li>
            
              <li><a href="/apis/streaming/connectors/kinesis.html" class="active">Amazon Kinesis Streams</a></li>
            
              <li><a href="/apis/streaming/connectors/twitter.html" class="">Twitter</a></li>
            
          </ul>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/savepoints.html" class="">Savepoints</a>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/libs/index.html" class="">Libraries</a>
          
          <ul>
            
              <li><a href="/apis/streaming/libs/cep.html" class="">Event Processing (CEP)</a></li>
            
          </ul>
          
        </li>
      
        
        
        
        <li><a href="/apis/streaming/storm_compatibility.html" class="">Storm Compatibility</a>
          
        </li>
      
    </ul>
  </div>
  <!-- Main -->
  <div class="col-sm-9">
    <!-- Top anchor -->
    <a href="#top"></a>

    <!-- Artifact name change warning. Remove for the 1.0 release. -->
    <div class="panel panel-default">
      <div class="panel-body"><strong>Important</strong>: Maven artifacts which depend on Scala are now suffixed with the Scala major version, e.g. "2.10" or "2.11". Please consult the <a href="https://cwiki.apache.org/confluence/display/FLINK/Maven+artifact+names+suffixed+with+Scala+version">migration guide on the project Wiki</a>.</div>
    </div>

    <!-- Breadcrumbs above the main heading -->
    <ol class="breadcrumb">
      
      
      <li><a href="/apis/streaming/index.html">Streaming Guide</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      

      
      
      

      

      <li><a href="/apis/streaming/connectors/index.html">Connectors</a></li>
      
      
      <li class="active">Amazon Kinesis Streams</li>
    </ol>

    <div class="text">
      <!-- Main heading -->
      <h1>Amazon AWS Kinesis Streams Connector</h1>

      <!-- Content -->
      

<p>The Kinesis connector allows to produce data into an <a href="http://aws.amazon.com/kinesis/streams/">Amazon AWS Kinesis Stream</a>.</p>

<p>To use the connector, add the following Maven dependency to your project:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.flink<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>flink-connector-kinesis_2.10<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></div>

<p><strong>The <code>flink-connector-kinesis_2.10</code> has a dependency on code licensed under the <a href="https://aws.amazon.com/asl/">Amazon Software License</a> (ASL).
Linking to the flink-connector-kinesis will include ASL licensed code into your application.</strong></p>

<p>The <code>flink-connector-kinesis_2.10</code> artifact is not deployed to Maven central as part of
Flink releases because of the licensing issue. Therefore, you need to build the connector yourself from the source.</p>

<p>Download the Flink source or check it out from the git repository. Then, use the following Maven command to build the module:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mvn clean install -Pinclude-kinesis -DskipTests</code></pre></div>

<p>Note that the streaming connectors are not part of the binary distribution. 
See linking with them for cluster execution <a href="/apis/cluster_execution.html#linking-with-modules-not-contained-in-the-binary-distribution">here</a>.</p>

<h4 id="usage-of-consumer">Usage of Consumer</h4>

<p>The <code>FlinkKinesisConsumer</code> can be used to pull data from multiple Kinesis streams within the same AWS region in parallel.
It participates with Flink’s distributed snapshot checkpointing and provides exactly-once processing guarantees. Note
that the current version can not handle resharding of Kinesis streams. When Kinesis streams are resharded, the consumer
will fail and the Flink streaming job must be resubmitted.</p>

<p>Before consuming data from Kinesis streams, make sure that all streams are created with the status “ACTIVE” in the AWS dashboard.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Properties</span> <span class="n">kinesisConsumerConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Properties</span><span class="o">();</span>
<span class="n">kinesisConsumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">kinesisConsumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span>
    <span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_CREDENTIALS_PROVIDER_BASIC_ACCESSKEYID</span><span class="o">,</span>
    <span class="s">&quot;aws_access_key_id_here&quot;</span><span class="o">);</span>
<span class="n">kinesisConsumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span>
    <span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_CREDENTIALS_PROVIDER_BASIC_SECRETKEY</span><span class="o">,</span>
    <span class="s">&quot;aws_secret_key_here&quot;</span><span class="o">);</span>
<span class="n">kinesisConsumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_STREAM_INIT_POSITION_TYPE</span><span class="o">,</span> <span class="s">&quot;LATEST&quot;</span><span class="o">);</span>

<span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">kinesisRecords</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">addSource</span><span class="o">(</span><span class="k">new</span> <span class="n">FlinkKinesisConsumer</span><span class="o">&lt;&gt;(</span>
    <span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">SimpleStringSchema</span><span class="o">(),</span> <span class="n">kinesisConsumerConfig</span><span class="o">))</span></code></pre></div>

  </div>
</div>

<p>The above is a simple example of using the consumer. Configuration for the consumer is supplied with a <code>java.util.Properties</code>
instance, with which the configuration setting keys used can be found in <code>KinesisConfigConstants</code>. The example
demonstrates consuming a single Kinesis stream in the AWS region “us-east-1”. The AWS credentials is supplied using the basic method in which
the AWS access key ID and secret key are directly supplied in the configuration (other options are setting
<code>KinesisConfigConstants.CONFIG_AWS_CREDENTIALS_PROVIDER_TYPE</code> to <code>ENV_VAR</code>, <code>SYS_PROP</code>, and <code>PROFILE</code>). Also, data is being consumed
from the newest position in the Kinesis stream (the other option will be setting <code>KinesisConfigConstants.CONFIG_STREAM_INIT_POSITION_TYPE</code>
to <code>TRIM_HORIZON</code>, which lets the consumer start reading the Kinesis stream from the earliest record possible).</p>

<h4 id="usage-of-producer">Usage of Producer</h4>

<p>The <code>FlinkKinesisProducer</code> is used for sending data from a Flink stream into a Kinesis stream. Note that the producer is not participating in 
Flink’s checkpointing and doesn’t provide exactly-once processing guarantees. In case of a failure, data will be written again
to Kinesis, leading to duplicates. This behavior is usually called “at-least-once” semantics.</p>

<p>To produce data into a Kinesis stream, make sure that you have a stream created with the status “ACTIVE” in the AWS dashboard.</p>

<p>For the monitoring to work, the user accessing the stream needs access to the Cloud watch service.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Properties</span> <span class="n">kinesisProducerConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Properties</span><span class="o">();</span>
<span class="n">kinesisProducerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">kinesisProducerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span>
    <span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_CREDENTIALS_PROVIDER_BASIC_ACCESSKEYID</span><span class="o">,</span>
    <span class="s">&quot;aws_access_key_id_here&quot;</span><span class="o">);</span>
<span class="n">kinesisProducerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span>
    <span class="n">KinesisConfigConstants</span><span class="o">.</span><span class="na">CONFIG_AWS_CREDENTIALS_PROVIDER_BASIC_SECRETKEY</span><span class="o">,</span>
    <span class="s">&quot;aws_secret_key_here&quot;</span><span class="o">);</span>
<span class="n">FlinkKinesisProducer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">kinesis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlinkKinesisProducer</span><span class="o">&lt;&gt;(</span><span class="k">new</span> <span class="nf">SimpleStringSchema</span><span class="o">(),</span> <span class="n">kinesisProducerConfig</span><span class="o">);</span>

<span class="n">kinesis</span><span class="o">.</span><span class="na">setFailOnError</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="na">setDefaultStream</span><span class="o">(</span><span class="s">&quot;test-flink&quot;</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="na">setDefaultPartition</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">simpleStringStream</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">simpleStringStream</span><span class="o">.</span><span class="na">addSink</span><span class="o">(</span><span class="n">kinesis</span><span class="o">);</span></code></pre></div>

  </div>
</div>

<p>The above is a simple example of using the producer. Configuration for the producer with the mandatory configuration values is supplied with a <code>java.util.Properties</code>
instance as described above for the consumer. The example demonstrates producing a single Kinesis stream in the AWS region “us-east-1”.</p>

<p>Instead of a <code>SerializationSchema</code>, it also supports a <code>KinesisSerializationSchema</code>. The <code>KinesisSerializationSchema</code> allows to send the data to multiple streams. This is 
done using the <code>KinesisSerializationSchema.getTargetStream(T element)</code> method. Returning <code>null</code> there will instruct the producer to write the element to the default stream.
Otherwise, the returned stream name is used.</p>

<p>Other optional configuration keys can be found in <code>KinesisConfigConstants</code>.</p>


    </div>
  </div>

  
</div>

    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
