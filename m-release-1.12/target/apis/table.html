<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.1-SNAPSHOT Documentation: Table API and SQL</title>
    <link rel="shortcut icon" href="/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/page/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/page/css/flink.css">
    <link rel="stylesheet" href="/page/css/syntax.css">
    <link rel="stylesheet" href="/page/css/codetabs.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    
    





    <!-- Top navbar. -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- The logo. -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-logo">
            <a href="http://flink.apache.org"><img alt="Apache Flink" src="/page/img/navbar-brand-logo.jpg"></a>
          </div>
        </div><!-- /.navbar-header -->

        <!-- The navigation links. -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="hidden-sm "><a href="/">Docs v1.1</a></li>

            <li class=""><a href="/concepts/concepts.html">Concepts</a></li>

            <!-- Setup -->
            <li class="dropdown">
              <a href="/setup" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Setup <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                <li class=""><a href="/setup/building.html">Build Flink from Source</a></li>
                
                <li class=""><a href="/setup/config.html">Configuration</a></li>
                

                <li class="divider"></li>
                <li role="presentation" class="dropdown-header"><strong>Quickstart</strong></li>

                <!-- Quickstart -->
                
                
                <li class=""><a href="/quickstart/setup_quickstart.html">Setup & Run Example</a></li>
                
                <li class=""><a href="/quickstart/java_api_quickstart.html">Java API</a></li>
                
                <li class=""><a href="/quickstart/scala_api_quickstart.html">Scala API</a></li>
                

                <li class="divider"></li>
                <li role="presentation" class="dropdown-header"><strong>Deployment</strong></li>
                
                
                <li class=""><a href="/setup/local_setup.html">Local</a></li>
                
                <li class=""><a href="/setup/cluster_setup.html">Cluster (Standalone)</a></li>
                
                <li class=""><a href="/setup/yarn_setup.html">YARN</a></li>
                
                <li class=""><a href="/setup/gce_setup.html">Google Compute Engine</a></li>
                
                <li class=""><a href="/setup/aws.html">AWS</a></li>
                
                <li class=""><a href="/setup/jobmanager_high_availability.html">High Availability</a></li>
                
              </ul>
            </li>

            <!-- Programming Guides -->
            <li class="dropdown active">
              <a href="/apis" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Programming Guides <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                
                
                <li class=""><a href="/apis/common/index.html"><strong>Basic API Concepts</strong></a></li>
                
                <li class=""><a href="/apis/streaming/index.html"><strong>Streaming Guide</strong> (DataStream API)</a></li>
                
                <li class=""><a href="/apis/batch/index.html"><strong>Batch Guide</strong> (DataSet API)</a></li>
                
                <li class=""><a href="/apis/best_practices.html">Best Practices</a></li>
                
                <li class="active"><a href="/apis/table.html">Table API and SQL</a></li>
                
                <li class=""><a href="/apis/cli.html">Command-Line Interface</a></li>
                
                <li class=""><a href="/apis/local_execution.html">Local Execution</a></li>
                
                <li class=""><a href="/apis/cluster_execution.html">Cluster Execution</a></li>
                
                <li class=""><a href="/apis/scala_shell.html">Scala Shell</a></li>
                
                <li class=""><a href="/apis/scala_api_extensions.html">Scala API Extensions</a></li>
                
                <li class=""><a href="/apis/java8.html">Java 8</a></li>
                
              </ul>
            </li>

            <!-- Libraries -->
            <li class="dropdown">
              <a href="/libs" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Libraries <span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                  
                  
                  <li class=""><a href="/apis/batch/libs/gelly.html">Graphs: Gelly</a></li>
                  
                  <li class=""><a href="/apis/streaming/libs/cep.html">CEP</a></li>
                  
                  <li class=""><a href="/apis/batch/libs/ml/index.html">Machine Learning</a></li>
                  
              </ul>
            </li>

            <!-- Internals -->
            <li class="dropdown">
              <a href="/internals" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Internals <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li role="presentation" class="dropdown-header"><strong>Contribute</strong></li>
                <li><a href="http://flink.apache.org/how-to-contribute.html"><small><span class="glyphicon glyphicon-new-window"></span></small> How to Contribute</a></li>
                <li><a href="http://flink.apache.org/contribute-code.html#coding-guidelines"><small><span class="glyphicon glyphicon-new-window"></span></small> Coding Guidelines</a></li>
                
                
                <li class=""><a href="/internals/ide_setup.html">IDE Setup</a></li>
                
                <li class=""><a href="/internals/logging.html">Logging</a></li>
                
                <li class=""><a href="/internals/general_arch.html">Architecture and Process Model</a></li>
                
                <li class=""><a href="/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
                
                <li class=""><a href="/internals/types_serialization.html">Type Extraction and Serialization</a></li>
                
                <li class=""><a href="/internals/monitoring_rest_api.html">Monitoring REST API</a></li>
                
                <li class=""><a href="/internals/job_scheduling.html">Jobs and Scheduling</a></li>
                
                <li class=""><a href="/internals/add_operator.html">How-To: Add an Operator</a></li>
                
                <li class=""><a href="/internals/back_pressure_monitoring.html">Back Pressure Monitoring</a></li>
                
              </ul>
            </li>
          </ul>
          <form class="navbar-form navbar-right hidden-sm hidden-md" role="search" action="/search-results.html">
            <div class="form-group">
              <input type="text" class="form-control" size="16px" name="q" placeholder="Search all pages">
            </div>
            <button type="submit" class="btn btn-default">Search</button>
          </form>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container -->
    </nav>


    

    <!-- Main content. -->
    <div class="container">
      
      
<div class="row">

  
  <div class="col-md-8 col-md-offset-2 text">
    <!-- Artifact name change warning. Remove for the 1.0 release. -->
    <div class="panel panel-default">
      <div class="panel-body"><strong>Important</strong>: Maven artifacts which depend on Scala are now suffixed with the Scala major version, e.g. "2.10" or "2.11". Please consult the <a href="https://cwiki.apache.org/confluence/display/FLINK/Maven+artifact+names+suffixed+with+Scala+version">migration guide on the project Wiki</a>.</div>
    </div>

    <h1>Table API and SQL <span class="beta">Beta</span></h1>


<p><strong>Table API and SQL are experimental features</strong></p>

<p>The Table API is a SQL-like expression language for relational stream and batch processing that can be easily embedded in Flink’s DataSet and DataStream APIs (Java and Scala).
The Table API and SQL interface operate on a relational <code>Table</code> abstraction, which can be created from external data sources, or existing DataSets and DataStreams. With the Table API, you can apply relational operators such as selection, aggregation, and joins on <code>Table</code>s.</p>

<p><code>Table</code>s can also be queried with regular SQL, as long as they are registered (see <a href="#registering-and-accessing-tables">Registering and Accessing Tables</a>). The Table API and SQL offer equivalent functionality and can be mixed in the same program. When a <code>Table</code> is converted back into a <code>DataSet</code> or <code>DataStream</code>, the logical plan, which was defined by relational operators and SQL queries, is optimized using <a href="https://calcite.apache.org/">Apache Calcite</a> and transformed into a <code>DataSet</code> or <code>DataStream</code> execution plan.</p>

<ul id="markdown-toc">
  <li><a href="#using-the-table-api-and-sql" id="markdown-toc-using-the-table-api-and-sql">Using the Table API and SQL</a></li>
  <li><a href="#registering-tables" id="markdown-toc-registering-tables">Registering Tables</a>    <ul>
      <li><a href="#register-a-dataset" id="markdown-toc-register-a-dataset">Register a DataSet</a></li>
      <li><a href="#register-a-datastream" id="markdown-toc-register-a-datastream">Register a DataStream</a></li>
      <li><a href="#register-a-table" id="markdown-toc-register-a-table">Register a Table</a></li>
      <li><a href="#register-an-external-table-using-a-tablesource" id="markdown-toc-register-an-external-table-using-a-tablesource">Register an external Table using a TableSource</a></li>
    </ul>
  </li>
  <li><a href="#table-api" id="markdown-toc-table-api">Table API</a>    <ul>
      <li><a href="#access-a-registered-table" id="markdown-toc-access-a-registered-table">Access a registered Table</a></li>
      <li><a href="#table-api-operators" id="markdown-toc-table-api-operators">Table API Operators</a></li>
      <li><a href="#expression-syntax" id="markdown-toc-expression-syntax">Expression Syntax</a></li>
    </ul>
  </li>
  <li><a href="#sql" id="markdown-toc-sql">SQL</a></li>
  <li><a href="#emit-a-table-to-external-sinks" id="markdown-toc-emit-a-table-to-external-sinks">Emit a Table to external sinks</a></li>
  <li><a href="#runtime-configuration" id="markdown-toc-runtime-configuration">Runtime Configuration</a>    <ul>
      <li><a href="#null-handling" id="markdown-toc-null-handling">Null Handling</a></li>
    </ul>
  </li>
</ul>

<h2 id="using-the-table-api-and-sql">Using the Table API and SQL</h2>

<p>The Table API and SQL are part of the <em>flink-table</em> Maven project.
The following dependency must be added to your project in order to use the Table API and SQL:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.flink<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>flink-table_2.10<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></div>

<p>Note that the Table API is currently not part of the binary distribution. See linking with it for cluster execution <a href="/apis/cluster_execution.html#linking-with-modules-not-contained-in-the-binary-distribution">here</a>.</p>

<h2 id="registering-tables">Registering Tables</h2>

<p><code>TableEnvironment</code>s have an internal table catalog to which tables can be registered with a unique name. After registration, a table can be accessed from the <code>TableEnvironment</code> by its name. Tables can be registered in different ways.</p>

<p><em>Note that it is not required to register a <code>DataSet</code> or <code>DataStream</code> as a table in a <code>TableEnvironment</code> in order to process it with the Table API.</em></p>

<h3 id="register-a-dataset">Register a DataSet</h3>

<p>A <code>DataSet</code> is registered as a <code>Table</code> in a <code>BatchTableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register the DataSet cust as table &quot;Customers&quot; with fields derived from the dataset</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataSet</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">cust</span><span class="o">)</span>

<span class="c1">// register the DataSet ord as table &quot;Orders&quot; with fields user, product, and amount</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataSet</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ord</span><span class="o">,</span> <span class="s">&quot;user, product, amount&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register the DataSet cust as table &quot;Customers&quot; with fields derived from the dataset</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataSet</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">cust</span><span class="o">)</span>

<span class="c1">// register the DataSet ord as table &quot;Orders&quot; with fields user, product, and amount</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataSet</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ord</span><span class="o">,</span> <span class="-Symbol">&#39;user</span><span class="o">,</span> <span class="-Symbol">&#39;product</span><span class="o">,</span> <span class="-Symbol">&#39;amount</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><em>Note: DataSet table names are not allowed to follow the <code>^_DataSetTable_[0-9]+</code> pattern, as these are reserved for internal use only.</em></p>

<h3 id="register-a-datastream">Register a DataStream</h3>

<p>A <code>DataStream</code> is registered as a <code>Table</code> in a <code>StreamTableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register the DataStream cust as table &quot;Customers&quot; with fields derived from the datastream</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataStream</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">cust</span><span class="o">)</span>

<span class="c1">// register the DataStream ord as table &quot;Orders&quot; with fields user, product, and amount</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataStream</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ord</span><span class="o">,</span> <span class="s">&quot;user, product, amount&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register the DataStream cust as table &quot;Customers&quot; with fields derived from the datastream</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataStream</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">cust</span><span class="o">)</span>

<span class="c1">// register the DataStream ord as table &quot;Orders&quot; with fields user, product, and amount</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataStream</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ord</span><span class="o">,</span> <span class="-Symbol">&#39;user</span><span class="o">,</span> <span class="-Symbol">&#39;product</span><span class="o">,</span> <span class="-Symbol">&#39;amount</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><em>Note: DataStream table names are not allowed to follow the <code>^_DataStreamTable_[0-9]+</code> pattern, as these are reserved for internal use only.</em></p>

<h3 id="register-a-table">Register a Table</h3>

<p>A <code>Table</code> that originates from a Table API operation or a SQL query is registered in a <code>TableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// works for StreamExecutionEnvironment identically</span>
<span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// convert a DataSet into a Table</span>
<span class="n">Table</span> <span class="n">custT</span> <span class="o">=</span> <span class="n">tableEnv</span>
  <span class="o">.</span><span class="na">toTable</span><span class="o">(</span><span class="n">custDs</span><span class="o">,</span> <span class="s">&quot;name, zipcode&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="s">&quot;zipcode = &#39;12345&#39;&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">)</span>

<span class="c1">// register the Table custT as table &quot;custNames&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTable</span><span class="o">(</span><span class="s">&quot;custNames&quot;</span><span class="o">,</span> <span class="n">custT</span><span class="o">)</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// works for StreamExecutionEnvironment identically</span>
<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// convert a DataSet into a Table</span>
<span class="k">val</span> <span class="n">custT</span> <span class="k">=</span> <span class="n">custDs</span>
  <span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;name</span><span class="o">,</span> <span class="-Symbol">&#39;zipcode</span><span class="o">)</span>
  <span class="o">.</span><span class="n">where</span><span class="o">(</span><span class="-Symbol">&#39;zipcode</span> <span class="o">===</span> <span class="s">&quot;12345&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;name</span><span class="o">)</span>

<span class="c1">// register the Table custT as table &quot;custNames&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTable</span><span class="o">(</span><span class="s">&quot;custNames&quot;</span><span class="o">,</span> <span class="n">custT</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p>A registered <code>Table</code> that originates from a Table API operation or SQL query is treated similarly as a view as known from relational DBMS, i.e., it can be inlined when optimizing the query.</p>

<h3 id="register-an-external-table-using-a-tablesource">Register an external Table using a TableSource</h3>

<p>An external table is registered in a <code>TableEnvironment</code> using a <code>TableSource</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// works for StreamExecutionEnvironment identically</span>
<span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">TableSource</span> <span class="n">custTS</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">CsvTableSource</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="o">...)</span>

<span class="c1">// register a `TableSource` as external table &quot;Customers&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSource</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">custTS</span><span class="o">)</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// works for StreamExecutionEnvironment identically</span>
<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">custTS</span><span class="k">:</span> <span class="kt">TableSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvTableSource</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="o">...)</span>

<span class="c1">// register a `TableSource` as external table &quot;Customers&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSource</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">custTS</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p>A <code>TableSource</code> can provide access to data stored in various storage systems such as databases (MySQL, HBase, …), file formats (CSV, Apache Parquet, Avro, ORC, …), or messaging systems (Apache Kafka, RabbitMQ, …).</p>

<p>Currently, Flink only provides a <code>CsvTableSource</code> to read CSV files. A custom <code>TableSource</code> can be defined by implementing the <code>BatchTableSource</code> or <code>StreamTableSource</code> interface.</p>

<h2 id="table-api">Table API</h2>
<p>The Table API provides methods to apply relational operations on DataSets and Datastreams both in Scala and Java.</p>

<p>The central concept of the Table API is a <code>Table</code> which represents a table with relational schema (or relation). Tables can be created from a <code>DataSet</code> or <code>DataStream</code>, converted into a <code>DataSet</code> or <code>DataStream</code>, or registered in a table catalog using a <code>TableEnvironment</code>. A <code>Table</code> is always bound to a specific <code>TableEnvironment</code>. It is not possible to combine Tables of different TableEnvironments.</p>

<p><em>Note that the only operations currently supported on streaming Tables are selection, filtering, and union.</em></p>

<div class="codetabs">
  <div data-lang="java">
    <p>When using Flink’s Java DataSet API, DataSets are converted to Tables and Tables to DataSets using a <code>TableEnvironment</code>.
The following example shows:</p>

    <ul>
      <li>how a <code>DataSet</code> is converted to a <code>Table</code>,</li>
      <li>how relational queries are specified, and</li>
      <li>how a <code>Table</code> is converted back to a <code>DataSet</code>.</li>
    </ul>

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WC</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nf">WC</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">;</span> <span class="k">this</span><span class="o">.</span><span class="na">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nf">WC</span><span class="o">()</span> <span class="o">{}</span> <span class="c1">// empty constructor to satisfy POJO requirements</span>

  <span class="kd">public</span> <span class="n">String</span> <span class="n">word</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="n">count</span><span class="o">;</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">WC</span><span class="o">&gt;</span> <span class="n">input</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">fromElements</span><span class="o">(</span>
        <span class="k">new</span> <span class="nf">WC</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span>
        <span class="k">new</span> <span class="nf">WC</span><span class="o">(</span><span class="s">&quot;Ciao&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span>
        <span class="k">new</span> <span class="nf">WC</span><span class="o">(</span><span class="s">&quot;Hello&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>

<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>

<span class="n">Table</span> <span class="n">wordCounts</span> <span class="o">=</span> <span class="n">table</span>
        <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="s">&quot;word&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;word, count.sum as count&quot;</span><span class="o">);</span>

<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">WC</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">toDataSet</span><span class="o">(</span><span class="n">wordCounts</span><span class="o">,</span> <span class="n">WC</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></div>

    <p>With Java, expressions must be specified by Strings. The embedded expression DSL is not supported.</p>

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register the DataSet cust as table &quot;Customers&quot; with fields derived from the dataset</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataSet</span><span class="o">(</span><span class="s">&quot;Customers&quot;</span><span class="o">,</span> <span class="n">cust</span><span class="o">)</span>

<span class="c1">// register the DataSet ord as table &quot;Orders&quot; with fields user, product, and amount</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataSet</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ord</span><span class="o">,</span> <span class="s">&quot;user, product, amount&quot;</span><span class="o">);</span></code></pre></div>

    <p>Please refer to the Javadoc for a full list of supported operations and a description of the expression syntax.</p>
  </div>

  <div data-lang="scala">
    <p>The Table API is enabled by importing <code>org.apache.flink.api.scala.table._</code>. This enables
implicit conversions to convert a <code>DataSet</code> or <code>DataStream</code> to a Table. The following example shows:</p>

    <ul>
      <li>how a <code>DataSet</code> is converted to a <code>Table</code>,</li>
      <li>how relational queries are specified, and</li>
      <li>how a <code>Table</code> is converted back to a <code>DataSet</code>.</li>
    </ul>

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.flink.api.scala._</span>
<span class="k">import</span> <span class="nn">org.apache.flink.api.scala.table._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">WC</span><span class="o">(</span><span class="n">word</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">count</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">input</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">fromElements</span><span class="o">(</span><span class="nc">WC</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="nc">WC</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="nc">WC</span><span class="o">(</span><span class="s">&quot;ciao&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
<span class="k">val</span> <span class="n">expr</span> <span class="k">=</span> <span class="n">input</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">)</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">expr</span>
               <span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="-Symbol">&#39;word</span><span class="o">)</span>
               <span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;word</span><span class="o">,</span> <span class="-Symbol">&#39;count</span><span class="o">.</span><span class="n">sum</span> <span class="n">as</span> <span class="-Symbol">&#39;count</span><span class="o">)</span>
               <span class="o">.</span><span class="n">toDataSet</span><span class="o">[</span><span class="kt">WC</span><span class="o">]</span></code></pre></div>

    <p>The expression DSL uses Scala symbols to refer to field names and code generation to
transform expressions to efficient runtime code. Please note that the conversion to and from
Tables only works when using Scala case classes or Java POJOs. Please refer to the <a href="/internals/types_serialization.html">Type Extraction and Serialization</a> section
to learn the characteristics of a valid POJO.</p>

    <p>Another example shows how to join two Tables:</p>

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">case</span> <span class="k">class</span> <span class="nc">MyResult</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">d</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">val</span> <span class="n">input1</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">fromElements</span><span class="o">(...).</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">).</span><span class="n">as</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">)</span>
<span class="k">val</span> <span class="n">input2</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">fromElements</span><span class="o">(...).</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">,</span> <span class="-Symbol">&#39;d</span><span class="o">)</span>

<span class="k">val</span> <span class="n">joined</span> <span class="k">=</span> <span class="n">input1</span><span class="o">.</span><span class="n">join</span><span class="o">(</span><span class="n">input2</span><span class="o">)</span>
               <span class="o">.</span><span class="n">where</span><span class="o">(</span><span class="s">&quot;a = c &amp;&amp; d &gt; 42&quot;</span><span class="o">)</span>
               <span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">&quot;a, d&quot;</span><span class="o">)</span>
               <span class="o">.</span><span class="n">toDataSet</span><span class="o">[</span><span class="kt">MyResult</span><span class="o">]</span></code></pre></div>

    <p>Notice, how the field names of a Table can be changed with <code>as()</code> or specified with <code>toTable()</code> when converting a DataSet to a Table. In addition, the example shows how to use Strings to specify relational expressions.</p>

    <p>Creating a <code>Table</code> from a <code>DataStream</code> works in a similar way.
The following example shows how to convert a <code>DataStream</code> to a <code>Table</code> and filter it with the Table API.</p>

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.flink.api.scala._</span>
<span class="k">import</span> <span class="nn">org.apache.flink.api.scala.table._</span>

<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">inputStream</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">addSource</span><span class="o">(...)</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">inputStream</span>
                <span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">)</span>
                <span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="-Symbol">&#39;a</span> <span class="o">===</span> <span class="mi">3</span><span class="o">)</span>
<span class="k">val</span> <span class="n">resultStream</span> <span class="k">=</span> <span class="n">result</span><span class="o">.</span><span class="n">toDataStream</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span></code></pre></div>

    <p>Please refer to the Scaladoc for a full list of supported operations and a description of the expression syntax.</p>
  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="access-a-registered-table">Access a registered Table</h3>

<p>A registered table can be accessed from a <code>TableEnvironment</code> as follows:</p>

<ul>
  <li><code>tEnv.scan("tName")</code> scans a <code>Table</code> that was registered as <code>"tName"</code> in a <code>BatchTableEnvironment</code>.</li>
  <li><code>tEnv.ingest("tName")</code> ingests a <code>Table</code> that was registered as <code>"tName"</code> in a <code>StreamTableEnvironment</code>.</li>
</ul>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="table-api-operators">Table API Operators</h3>

<p>The Table API features a domain-specific language to execute language-integrated queries on structured data in Scala and Java.
This section gives a brief overview of the available operators. You can find more details of operators in the <a href="/api/java/org/apache/flink/api/table/Table.html">Javadoc</a>.</p>

<div class="codetabs">
  <div data-lang="java">

    <p><br /></p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><strong>Select</strong></td>
      <td>
        <p>Similar to a SQL SELECT statement. Performs a select operation.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;a, c as d&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>As</strong></td>
      <td>
        <p>Renames fields.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">&quot;d, e, f&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Where / Filter</strong></td>
      <td>
        <p>Similar to a SQL WHERE clause. Filters out rows that do not pass the filter predicate.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="s">&quot;b = &#39;red&#39;&quot;</span><span class="o">);</span></code></pre></div>

or

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="s">&quot;a % 2 = 0&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>
    <tr>
      <td><strong>GroupBy</strong></td>
      <td>
        <p>Similar to a SQL GROUPBY clause. Groups the rows on the grouping keys, with a following aggregation
        operator to aggregate rows group-wise.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">).</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;a, b.sum as d&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Join</strong></td>
      <td>
        <p>Similar to a SQL JOIN clause. Joins two tables. Both tables must have distinct field names and an equality join predicate must be defined using a where or filter operator.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">&quot;d, e, f&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">right</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="s">&quot;a = d&quot;</span><span class="o">).</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;a, b, e&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Union</strong></td>
      <td>
        <p>Similar to a SQL UNION ALL clause. Unions two tables. Both tables must have identical schema, i.e., field names and types.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">unionAll</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Distinct</strong></td>
      <td>
        <p>Similar to a SQL DISTINCT clause. Returns rows with distinct value combinations.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">distinct</span><span class="o">();</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Order By</strong></td>
      <td>
        <p>Similar to a SQL ORDER BY clause. Returns rows globally sorted across all parallel partitions.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">&quot;a, b, c&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="s">&quot;a.asc&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

  </tbody>
</table>

  </div>
  <div data-lang="scala">
    <p><br /></p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><strong>Select</strong></td>
      <td>
        <p>Similar to a SQL SELECT statement. Performs a select operation.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;c</span> <span class="n">as</span> <span class="-Symbol">&#39;d</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>As</strong></td>
      <td>
        <p>Renames fields.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">).</span><span class="n">as</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Where / Filter</strong></td>
      <td>
        <p>Similar to a SQL WHERE clause. Filters out rows that do not pass the filter predicate.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="-Symbol">&#39;a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="o">)</span></code></pre></div>

or

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">where</span><span class="o">(</span><span class="-Symbol">&#39;b</span> <span class="o">===</span> <span class="s">&quot;red&quot;</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>GroupBy</strong></td>
      <td>
        <p>Similar to a SQL GROUPBY clause. Groups rows on the grouping keys, with a following aggregation
        operator to aggregate rows group-wise.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">).</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">.</span><span class="n">sum</span> <span class="n">as</span> <span class="-Symbol">&#39;d</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Join</strong></td>
      <td>
        <p>Similar to a SQL JOIN clause. Joins two tables. Both tables must have distinct field names and an equality join predicate must be defined using a where or filter operator.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;d</span><span class="o">,</span> <span class="-Symbol">&#39;e</span><span class="o">,</span> <span class="-Symbol">&#39;f</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="o">(</span><span class="n">right</span><span class="o">).</span><span class="n">where</span><span class="o">(</span><span class="-Symbol">&#39;a</span> <span class="o">===</span> <span class="-Symbol">&#39;d</span><span class="o">).</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;e</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Union</strong></td>
      <td>
        <p>Similar to a SQL UNION ALL clause. Unions two tables, both tables must have identical schema(field names and types).</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">left</span> <span class="k">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">right</span> <span class="k">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">left</span><span class="o">.</span><span class="n">unionAll</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Distinct</strong></td>
      <td>
        <p>Similar to a SQL DISTINCT clause. Returns rows with distinct value combinations.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">distinct</span><span class="o">();</span></code></pre></div>

      </td>
    </tr>

    <tr>
      <td><strong>Order By</strong></td>
      <td>
        <p>Similar to a SQL ORDER BY clause. Returns rows globally sorted across all parallel partitions.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">in</span> <span class="k">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;b</span><span class="o">,</span> <span class="-Symbol">&#39;c</span><span class="o">);</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">in</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">.</span><span class="n">asc</span><span class="o">);</span></code></pre></div>

      </td>
    </tr>

  </tbody>
</table>
  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="expression-syntax">Expression Syntax</h3>
<p>Some of the operators in previous sections expect one or more expressions. Expressions can be specified using an embedded Scala DSL or as Strings. Please refer to the examples above to learn how expressions can be specified.</p>

<p>This is the EBNF grammar for expressions:</p>

<div class="highlight"><pre><code class="language-ebnf" data-lang="ebnf"><span class="k">expressionList </span><span class="o">=</span> <span class="k">expression </span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;,&quot;</span> <span class="p">,</span> <span class="k">expression </span><span class="p">}</span> <span class="p">;</span>

<span class="k">expression </span><span class="o">=</span> <span class="k">alias </span><span class="p">;</span>

<span class="k">alias </span><span class="o">=</span> <span class="k">logic </span><span class="p">|</span> <span class="p">(</span> <span class="k">logic </span><span class="p">,</span> <span class="s2">&quot;AS&quot;</span> <span class="p">,</span> <span class="k">fieldReference </span><span class="p">)</span> <span class="p">;</span>

<span class="k">logic </span><span class="o">=</span> <span class="k">comparison </span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span> <span class="s2">&quot;&amp;&amp;&quot;</span> <span class="p">|</span> <span class="s2">&quot;||&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="k">comparison </span><span class="p">]</span> <span class="p">;</span>

<span class="k">comparison </span><span class="o">=</span> <span class="k">term </span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span> <span class="s2">&quot;=&quot;</span> <span class="p">|</span> <span class="s2">&quot;===&quot;</span> <span class="p">|</span> <span class="s2">&quot;!=&quot;</span> <span class="p">|</span> <span class="s2">&quot;!==&quot;</span> <span class="p">|</span> <span class="s2">&quot;&gt;&quot;</span> <span class="p">|</span> <span class="s2">&quot;&gt;=&quot;</span> <span class="p">|</span> <span class="s2">&quot;&lt;&quot;</span> <span class="p">|</span> <span class="s2">&quot;&lt;=&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="k">term </span><span class="p">]</span> <span class="p">;</span>

<span class="k">term </span><span class="o">=</span> <span class="k">product </span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span> <span class="s2">&quot;+&quot;</span> <span class="p">|</span> <span class="s2">&quot;-&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="k">product </span><span class="p">]</span> <span class="p">;</span>

<span class="k">product </span><span class="o">=</span> <span class="k">unary </span><span class="p">,</span> <span class="p">[</span> <span class="p">(</span> <span class="s2">&quot;*&quot;</span> <span class="p">|</span> <span class="s2">&quot;/&quot;</span> <span class="p">|</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span> <span class="p">,</span> <span class="k">unary </span><span class="p">]</span> <span class="p">;</span>

<span class="k">unary </span><span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;!&quot;</span> <span class="p">|</span> <span class="s2">&quot;-&quot;</span> <span class="p">]</span> <span class="p">,</span> <span class="k">composite </span><span class="p">;</span>

<span class="k">composite </span><span class="o">=</span> <span class="k">suffixed </span><span class="p">|</span> <span class="k">atom </span><span class="p">;</span>

<span class="k">suffixed </span><span class="o">=</span> <span class="k">cast </span><span class="p">|</span> <span class="k">as </span><span class="p">|</span> <span class="k">aggregation </span><span class="p">|</span> <span class="k">nullCheck </span><span class="p">|</span> <span class="k">evaluate </span><span class="p">|</span> <span class="k">functionCall </span><span class="p">;</span>

<span class="k">cast </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="s2">&quot;.cast(&quot;</span> <span class="p">,</span> <span class="k">dataType </span><span class="p">,</span> <span class="s2">&quot;)&quot;</span> <span class="p">;</span>

<span class="k">dataType </span><span class="o">=</span> <span class="s2">&quot;BYTE&quot;</span> <span class="p">|</span> <span class="s2">&quot;SHORT&quot;</span> <span class="p">|</span> <span class="s2">&quot;INT&quot;</span> <span class="p">|</span> <span class="s2">&quot;LONG&quot;</span> <span class="p">|</span> <span class="s2">&quot;FLOAT&quot;</span> <span class="p">|</span> <span class="s2">&quot;DOUBLE&quot;</span> <span class="p">|</span> <span class="s2">&quot;BOOL&quot;</span> <span class="p">|</span> <span class="s2">&quot;BOOLEAN&quot;</span> <span class="p">|</span> <span class="s2">&quot;STRING&quot;</span> <span class="p">|</span> <span class="s2">&quot;DATE&quot;</span> <span class="p">;</span>

<span class="k">as </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="s2">&quot;.as(&quot;</span> <span class="p">,</span> <span class="k">fieldReference </span><span class="p">,</span> <span class="s2">&quot;)&quot;</span> <span class="p">;</span>

<span class="k">aggregation </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="p">(</span> <span class="s2">&quot;.sum&quot;</span> <span class="p">|</span> <span class="s2">&quot;.min&quot;</span> <span class="p">|</span> <span class="s2">&quot;.max&quot;</span> <span class="p">|</span> <span class="s2">&quot;.count&quot;</span> <span class="p">|</span> <span class="s2">&quot;.avg&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;()&quot;</span> <span class="p">]</span> <span class="p">;</span>

<span class="k">nullCheck </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="p">(</span> <span class="s2">&quot;.isNull&quot;</span> <span class="p">|</span> <span class="s2">&quot;.isNotNull&quot;</span> <span class="p">)</span> <span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;()&quot;</span> <span class="p">]</span> <span class="p">;</span>

<span class="k">evaluate </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="s2">&quot;.eval(&quot;</span> <span class="p">,</span> <span class="k">expression </span><span class="p">,</span> <span class="s2">&quot;,&quot;</span> <span class="p">,</span> <span class="k">expression </span><span class="p">,</span> <span class="s2">&quot;)&quot;</span> <span class="p">;</span>

<span class="k">functionCall </span><span class="o">=</span> <span class="k">composite </span><span class="p">,</span> <span class="s2">&quot;.&quot;</span> <span class="p">,</span> <span class="k">functionIdentifier </span><span class="p">,</span> <span class="s2">&quot;(&quot;</span> <span class="p">,</span> <span class="p">[</span> <span class="k">expression </span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;,&quot;</span> <span class="p">,</span> <span class="k">expression </span><span class="p">}</span> <span class="p">]</span> <span class="p">,</span> <span class="s2">&quot;)&quot;</span>

<span class="k">atom </span><span class="err">=</span> <span class="p">(</span> <span class="s2">&quot;(&quot;</span> <span class="p">,</span> <span class="k">expression </span><span class="p">,</span> <span class="s2">&quot;)&quot;</span> <span class="p">)</span> <span class="p">|</span> <span class="k">literal </span><span class="p">|</span> <span class="k">nullLiteral </span><span class="p">|</span> <span class="k">fieldReference </span><span class="p">;</span>

<span class="k">nullLiteral </span><span class="o">=</span> <span class="s2">&quot;Null(&quot;</span> <span class="p">,</span> <span class="k">dataType </span><span class="p">,</span> <span class="s2">&quot;)&quot;</span> <span class="p">;</span></code></pre></div>

<p>Here, <code>literal</code> is a valid Java literal, <code>fieldReference</code> specifies a column in the data, and <code>functionIdentifier</code> specifies a supported scalar function. The
column names and function names follow Java identifier syntax. Expressions specified as Strings can also use prefix notation instead of suffix notation to call operators and functions.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="sql">SQL</h2>
<p>Registered <code>Table</code>s can be directly queried with SQL and SQL queries can also be mixed with Table API expressions. Table API and SQL statements will be translated into a single optimized DataStream or DataSet program.</p>

<p><em>Note: The current SQL implementation is not feature complete. Outer joins, distinct aggregates, date and decimal data types are currently not supported. However, all operations supported by the Table API are also supported by SQL.</em></p>

<p>In order to use a <code>Table</code>, <code>DataSet</code>, <code>DataStream</code>, or external <code>TableSource</code> in a SQL query, it has to be registered in the <code>TableEnvironment</code>, using a unique name. 
A registered table can be accessed from a <code>TableEnvironment</code>  using the <code>sql()</code> method of the <code>TableEnvironment</code>:</p>

<ul>
  <li><code>tEnv.sql(SELECT * FROM tName)</code> executes the SQL query on the corresponding tables which were registered in a <code>TableEnvironment</code>.</li>
</ul>

<p>This method returns a new <code>Table</code> which can be converted back to a <code>DataSet</code>, or <code>DataStream</code>, or used in subsequent Table API queries.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// read a DataSet from an external source</span>
<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Long</span><span class="o">&gt;&gt;</span> <span class="n">ds</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">readCsvFile</span><span class="o">(...);</span>
<span class="c1">// register the DataSet as table &quot;Orders&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataSet</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ds</span><span class="o">,</span> <span class="s">&quot;user, product, amount&quot;</span><span class="o">);</span>
<span class="c1">// run a SQL query and retrieve the result in a new Table</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT SUM(amount) FROM Orders WHERE product = 10&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// read a DataSet from an external source</span>
<span class="k">val</span> <span class="n">ds</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">readCsvFile</span><span class="o">(...)</span>
<span class="c1">// register the DataSet under the name &quot;Orders&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataSet</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">,</span> <span class="n">ds</span><span class="o">,</span> <span class="-Symbol">&#39;user</span><span class="o">,</span> <span class="-Symbol">&#39;product</span><span class="o">,</span> <span class="-Symbol">&#39;amount</span><span class="o">)</span>
<span class="c1">// run a SQL query and retrieve the result in a new Table</span>
<span class="k">val</span> <span class="n">result</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT SUM(amount) FROM Orders WHERE product = 10&quot;</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p>SQL queries can be executed on DataStream Tables by adding the <code>STREAM</code> SQL keyword before the table name. Please refer to the <a href="https://calcite.apache.org/docs/stream.html">Apache Calcite SQL Streaming documentation</a> for more information on the Streaming SQL syntax.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="emit-a-table-to-external-sinks">Emit a Table to external sinks</h2>

<p>A <code>Table</code> can be emitted to a <code>TableSink</code>, which is a generic interface to support a wide variety of file formats (e.g. CSV, Apache Parquet, Apache Avro), storage systems (e.g., JDBC, Apache HBase, Apache Cassandra, Elasticsearch), or messaging systems (e.g., Apache Kafka, RabbitMQ), and others. A batch <code>Table</code> can only be emitted by a <code>BatchTableSink</code>, a streaming table requires a <code>StreamTableSink</code> (a <code>TableSink</code> can implement both interfaces).</p>

<p>Currently, Flink only provides a <code>CsvTableSink</code> that writes a batch or streaming <code>Table</code> to CSV-formatted files. A custom <code>TableSource</code> can be defined by implementing the <code>BatchTableSink</code> and/or <code>StreamTableSink</code> interface.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// compute the result Table using Table API operators and/or SQL queries</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="o">...</span> 

<span class="c1">// create a TableSink</span>
<span class="n">TableSink</span> <span class="n">sink</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">CsvTableSink</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="n">fieldDelim</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span><span class="o">);</span>
<span class="c1">// add a TableSink to emit the result Table</span>
<span class="n">result</span><span class="o">.</span><span class="na">toSink</span><span class="o">(</span><span class="n">sink</span><span class="o">);</span>

<span class="c1">// execute the program</span>
<span class="n">env</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// compute the result Table using Table API operators and/or SQL queries</span>
<span class="k">val</span> <span class="n">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">...</span> 

<span class="c1">// create a TableSink</span>
<span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">TableSink</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvTableSink</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="n">fieldDelim</span> <span class="k">=</span> <span class="s">&quot;|&quot;</span><span class="o">)</span>
<span class="c1">// add a TableSink to emit the result Table</span>
<span class="n">result</span><span class="o">.</span><span class="n">toSink</span><span class="o">(</span><span class="n">sink</span><span class="o">)</span>

<span class="c1">// execute the program</span>
<span class="n">env</span><span class="o">.</span><span class="n">execute</span><span class="o">()</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="runtime-configuration">Runtime Configuration</h2>
<p>The Table API provides a configuration (the so-called <code>TableConfig</code>) to modify runtime behavior. It can be accessed either through <code>TableEnvironment</code> or passed to the <code>toDataSet</code>/<code>toDataStream</code> method when using Scala implicit conversion.</p>

<h3 id="null-handling">Null Handling</h3>
<p>By default, the Table API supports <code>null</code> values. Null handling can be disabled by setting the <code>nullCheck</code> property in the <code>TableConfig</code> to <code>false</code>.</p>


  </div>

  
</div>

    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
