<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: 时态表（Temporal Tables）</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/zh/dev/table/streaming/temporal_tables.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/local_installation.html">本地模式安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/datastream_api.html">基于 DataStream API 实现欺诈检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/table_api.html">基于 Table API 实现实时报表</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/flink-operations-playground.html">Flink 操作场景</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> 实践练习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/datastream_api.html">DataStream API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/etl.html">数据管道 & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/streaming_analytics.html">流式分析</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/event_driven.html">事件驱动应用</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/fault_tolerance.html">容错处理</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> 概念透析<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/index.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/stateful-stream-processing.html">有状态流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">及时流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/flink-architecture.html">Flink 架构</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/glossary.html">词汇表</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_time.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamps_watermarks.html">生成 Watermark</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamp_extractors.html">内置 Watermark 生成器</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/broadcast_state.html">Broadcast State 模式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/schema_evolution.html">状态数据结构升级</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/user_defined_functions.html">用户自定义 Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">算子<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/windows.html">窗口</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/asyncio.html">异步 I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/side_output.html">旁路输出</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/testing.html">测试</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/experimental.html">实验功能</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/java_lambdas.html">Java Lambda 表达式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/iterations.html">迭代</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/hadoop_compatibility.html">Hadoop 兼容</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/local_execution.html">本地执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/cluster_execution.html">集群执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/examples.html">Batch 示例</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse"class="active">Table API & SQL</a><div class="collapse in" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">概念与通用 API</a></li>
<li><a href="#collapse-64" data-toggle="collapse"class="active">流式概念</a><div class="collapse in" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表 (Dynamic Table)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">流上的 Join</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html" class="active">时态表（Temporal Tables）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/match_recognize.html">模式检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html">查询语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html">CREATE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/drop.html">DROP 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/alter.html">ALTER 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/insert.html">INSERT 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/describe.html">DESCRIBE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/use.html">USE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/show.html">SHOW 语句</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html">系统（内置）函数</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/modules.html">模块</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sqlClient.html">SQL 客户端</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/config.html">配置</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tuning/streaming_aggregation_optimization.html">流式聚合</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse">Python API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/installation.html">环境安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table_api_tutorial.html">Table API 教程</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream_tutorial.html">DataStream API 教程</a></li>
<li><a href="#collapse-103" data-toggle="collapse">Table API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html">Python Table API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/built_in_functions.html">系统（内置）函数</a></li>
<li><a href="#collapse-109" data-toggle="collapse">自定义函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通自定义函数（UDF）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html">PyFlink Table 和 Pandas DataFrame 互转</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_table_api_connectors.html">连接器</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/data_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/operators.html">算子</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/dependency_management.html">依赖管理</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/environment_variables.html">环境变量</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/faq.html">常见问题</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">数据类型以及序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/types_serialization.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/custom_serializers.html">自定义序列化器</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_configuration.html">执行配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/packaging.html">程序打包</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/parallel.html">并行执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_plans.html">执行计划</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">Task 故障恢复</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/migration.html">API 迁移指南</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/cep.html">事件处理 (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/guarantees.html">容错保证</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/">概览</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_dialect.html">Hive 方言</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_functions.html">Hive 函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/downloads.html">下载</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/">概览</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/local.html">本地集群</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/config.html">配置参数</a></li>
<li><a href="#collapse-213" data-toggle="collapse">内存配置<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup.html">配置 Flink 进程的内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_tm.html">配置 TaskManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_jobmanager.html">配置 JobManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_tuning.html">调优指南</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_trouble.html">常见问题</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_migration.html">升级指南</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">文件系统<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/common.html">通用配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/oss.html">阿里云 OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/azure.html">Azure Blob 存储</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-ssl.html">SSL 设置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/external_resources.html">扩展资源</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/logging.html">日志</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/large_state_tuning.html">大状态与 Checkpoint 调优</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_event_time.html">调试窗口与事件时间</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_classloading.html">调试类加载</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/application_profiling.html">应用程序分析</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/checkpoint_monitoring.html">监控 Checkpoint</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/back_pressure.html">监控反压</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/upgrading.html">升级应用程序和 Flink 版本</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/production_ready.html">生产就绪情况核对清单</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink 开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/ide_setup.html">导入 Flink 到 IDE 中</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/building.html">从源码构建 Flink</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> 内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/job_scheduling.html">作业调度</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/task_lifecycle.html">Task 生命周期</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/filesystems.html">文件系统</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">选择文档版本<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/streaming/temporal_tables.html">
      <button type="submit" class="btn btn-default">English</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">Table API & SQL</a></li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">流式概念</a></li>
  
    <li class="active">时态表（Temporal Tables）</li>
</ol>

<h1>时态表（Temporal Tables）</h1>




<p>时态表（Temporal Table）是一张随时间变化的表 – 在 Flink 中称为<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表</a>，时态表中的每条记录都关联了一个或多个时间段，所有的 Flink 表都是时态的（动态的）。</p>

<p>时态表包含表的一个或多个有版本的表快照，时态表可以是一张跟踪所有变更记录的表（例如数据库表的 changelog，包含多个表快照），也可以是物化所有变更之后的表（例如数据库表，只有最新表快照）。</p>

<p><strong>版本</strong>: 时态表可以划分成一系列带版本的表快照集合，表快照中的版本代表了快照中所有记录的有效区间，有效区间的开始时间和结束时间可以通过用户指定，根据时态表是否可以追踪自身的历史版本与否，时态表可以分为 <code class="highlighter-rouge">版本表</code> 和 <code class="highlighter-rouge">普通表</code>。</p>

<p><strong>版本表</strong>: 如果时态表中的记录可以追踪和并访问它的历史版本，这种表我们称之为版本表，来自数据库的 changelog 可以定义成版本表。</p>

<p><strong>普通表</strong>: 如果时态表中的记录仅仅可以追踪并和它的最新版本，这种表我们称之为普通表，来自数据库 或 HBase 的表可以定义成普通表。</p>

<ul id="markdown-toc">
  <li><a href="#设计初衷" id="markdown-toc-设计初衷">设计初衷</a>    <ul>
      <li><a href="#关联一张版本表" id="markdown-toc-关联一张版本表">关联一张版本表</a></li>
      <li><a href="#关联一张普通表" id="markdown-toc-关联一张普通表">关联一张普通表</a></li>
    </ul>
  </li>
  <li><a href="#时态表" id="markdown-toc-时态表">时态表</a>    <ul>
      <li><a href="#声明版本表" id="markdown-toc-声明版本表">声明版本表</a></li>
      <li><a href="#声明版本视图" id="markdown-toc-声明版本视图">声明版本视图</a></li>
      <li><a href="#声明普通表" id="markdown-toc-声明普通表">声明普通表</a></li>
    </ul>
  </li>
  <li><a href="#时态表函数" id="markdown-toc-时态表函数">时态表函数</a>    <ul>
      <li><a href="#定义时态表函数" id="markdown-toc-定义时态表函数">定义时态表函数</a></li>
    </ul>
  </li>
</ul>

<h2 id="设计初衷">设计初衷</h2>

<h3 id="关联一张版本表">关联一张版本表</h3>

<p>以订单流关联产品表这个场景举例，<code class="highlighter-rouge">orders</code> 表包含了来自 Kafka 的实时订单流，<code class="highlighter-rouge">product_changelog</code> 表来自数据库表 <code class="highlighter-rouge">products</code> 的 changelog , 产品的价格在数据库表 <code class="highlighter-rouge">products</code> 中是随时间实时变化的。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">product_changelog</span><span class="p">;</span>

<span class="p">(</span><span class="n">changelog</span> <span class="n">kind</span><span class="p">)</span>  <span class="n">update_time</span>  <span class="n">product_id</span> <span class="n">product_name</span> <span class="n">price</span>
<span class="o">=================</span> <span class="o">===========</span>  <span class="o">==========</span> <span class="o">============</span> <span class="o">=====</span> 
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">11</span><span class="p">.</span><span class="mi">11</span>
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>         <span class="mi">00</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_002</span>      <span class="n">basketball</span>   <span class="mi">23</span><span class="p">.</span><span class="mi">11</span>
<span class="o">-</span><span class="p">(</span><span class="n">UPDATE_BEFORE</span><span class="p">)</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">11</span><span class="p">.</span><span class="mi">11</span>
<span class="o">+</span><span class="p">(</span><span class="n">UPDATE_AFTER</span><span class="p">)</span>   <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">12</span><span class="p">.</span><span class="mi">99</span>
<span class="o">-</span><span class="p">(</span><span class="n">UPDATE_BEFORE</span><span class="p">)</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_002</span>      <span class="n">basketball</span>   <span class="mi">23</span><span class="p">.</span><span class="mi">11</span> 
<span class="o">+</span><span class="p">(</span><span class="n">UPDATE_AFTER</span><span class="p">)</span>   <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_002</span>      <span class="n">basketball</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">99</span>
<span class="o">-</span><span class="p">(</span><span class="k">DELETE</span><span class="p">)</span>         <span class="mi">18</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">12</span><span class="p">.</span><span class="mi">99</span> </code></pre></figure>

<p>表 <code class="highlighter-rouge">product_changelog</code> 表示数据库表 <code class="highlighter-rouge">products</code>不断增长的 changelog, 比如，产品 <code class="highlighter-rouge">scooter</code> 在时间点 <code class="highlighter-rouge">00:01:00</code>的初始价格是 <code class="highlighter-rouge">11.11</code>, 在 <code class="highlighter-rouge">12:00:00</code> 的时候涨价到了 <code class="highlighter-rouge">12.99</code>, 
在 <code class="highlighter-rouge">18:00:00</code> 的时候这条产品价格记录被删除。</p>

<p>如果我们想输出 <code class="highlighter-rouge">product_changelog</code> 表在 <code class="highlighter-rouge">10:00:00</code> 对应的版本，表的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">update_time</span>  <span class="n">product_id</span> <span class="n">product_name</span> <span class="n">price</span>
<span class="o">===========</span>  <span class="o">==========</span> <span class="o">============</span> <span class="o">=====</span> 
<span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">11</span><span class="p">.</span><span class="mi">11</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_002</span>      <span class="n">basketball</span>   <span class="mi">23</span><span class="p">.</span><span class="mi">11</span></code></pre></figure>

<p>如果我们想输出 <code class="highlighter-rouge">product_changelog</code> 表在 <code class="highlighter-rouge">13:00:00</code> 对应的版本，表的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">update_time</span>  <span class="n">product_id</span> <span class="n">product_name</span> <span class="n">price</span>
<span class="o">===========</span>  <span class="o">==========</span> <span class="o">============</span> <span class="o">=====</span> 
<span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_001</span>      <span class="n">scooter</span>      <span class="mi">12</span><span class="p">.</span><span class="mi">99</span>
<span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>     <span class="n">p_002</span>      <span class="n">basketball</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">99</span></code></pre></figure>

<p>上述例子中，<code class="highlighter-rouge">products</code> 表的版本是通过 <code class="highlighter-rouge">update_time</code> 和 <code class="highlighter-rouge">product_id</code> 进行追踪的，<code class="highlighter-rouge">product_id</code> 对应 <code class="highlighter-rouge">product_changelog</code> 表的主键，<code class="highlighter-rouge">update_time</code> 对应事件时间。</p>

<p>在 Flink 中, 这由<a href="#声明版本表"><em>版本表</em></a>表示。</p>

<h3 id="关联一张普通表">关联一张普通表</h3>

<p>另一方面，某些用户案列需要连接变化的维表，该表是外部数据库表。</p>

<p>假设 <code class="highlighter-rouge">LatestRates</code> 是一个物化的最新汇率表 (比如：一张 HBase 表)，<code class="highlighter-rouge">LatestRates</code> 总是表示 HBase 表 <code class="highlighter-rouge">Rates</code> 的最新内容。</p>

<p>我们在 <code class="highlighter-rouge">10:15:00</code> 时查询到的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span> <span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">LatestRates</span><span class="p">;</span>

<span class="n">currency</span>  <span class="n">rate</span>
<span class="o">=========</span> <span class="o">====</span>
<span class="n">US</span> <span class="n">Dollar</span> <span class="mi">102</span>
<span class="n">Euro</span>      <span class="mi">114</span>
<span class="n">Yen</span>       <span class="mi">1</span></code></pre></figure>

<p>我们在 <code class="highlighter-rouge">11:00:00</code> 时查询到的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="mi">11</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">LatestRates</span><span class="p">;</span>

<span class="n">currency</span>  <span class="n">rate</span>
<span class="o">=========</span> <span class="o">====</span>
<span class="n">US</span> <span class="n">Dollar</span> <span class="mi">102</span>
<span class="n">Euro</span>      <span class="mi">116</span>
<span class="n">Yen</span>       <span class="mi">1</span></code></pre></figure>

<p>在 Flink 中, 这由<a href="#声明普通表"><em>普通表</em></a>表示。</p>

<h2 id="时态表">时态表</h2>
<p><span class="label label-danger">注意</span> 仅 Blink planner 支持此功能。</p>

<p>Flink 使用主键约束和事件时间来定义一张版本表和版本视图。</p>

<h3 id="声明版本表">声明版本表</h3>
<p>在 Flink 中，定义了主键约束和事件时间属性的表就是版本表。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- 定义一张版本表</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">product_changelog</span> <span class="p">(</span>
  <span class="n">product_id</span> <span class="n">STRING</span><span class="p">,</span>
  <span class="n">product_name</span> <span class="n">STRING</span><span class="p">,</span>
  <span class="n">product_price</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
  <span class="n">update_time</span> <span class="nb">TIMESTAMP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">METADATA</span> <span class="k">FROM</span> <span class="s1">'value.source.timestamp'</span> <span class="n">VIRTUAL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">(</span><span class="n">product_id</span><span class="p">)</span> <span class="k">NOT</span> <span class="n">ENFORCED</span><span class="p">,</span>      <span class="c1">-- (1) 定义主键约束</span>
  <span class="n">WATERMARK</span> <span class="k">FOR</span> <span class="n">update_time</span> <span class="k">AS</span> <span class="n">update_time</span>   <span class="c1">-- (2) 通过 watermark 定义事件时间              </span>
<span class="p">)</span> <span class="k">WITH</span> <span class="p">(</span>
  <span class="s1">'connector'</span> <span class="o">=</span> <span class="s1">'kafka'</span><span class="p">,</span>
  <span class="s1">'topic'</span> <span class="o">=</span> <span class="s1">'products'</span><span class="p">,</span>
  <span class="s1">'scan.startup.mode'</span> <span class="o">=</span> <span class="s1">'earliest-offset'</span><span class="p">,</span>
  <span class="s1">'properties.bootstrap.servers'</span> <span class="o">=</span> <span class="s1">'localhost:9092'</span><span class="p">,</span>
  <span class="s1">'value.format'</span> <span class="o">=</span> <span class="s1">'debezium-json'</span>
<span class="p">);</span></code></pre></figure>

<p>行 <code class="highlighter-rouge">(1)</code> 为表 <code class="highlighter-rouge">product_changelog</code> 定义了主键, 行 <code class="highlighter-rouge">(2)</code> 把 <code class="highlighter-rouge">update_time</code> 定义为表 <code class="highlighter-rouge">product_changelog</code> 的事件时间，因此 <code class="highlighter-rouge">product_changelog</code> 是一张版本表。</p>

<p><strong>注意</strong>: <code class="highlighter-rouge">METADATA FROM 'value.source.timestamp' VIRTUAL</code> 语法的意思是从每条 changelog 中抽取 changelog 对应的数据库表中操作的执行时间，强烈推荐使用数据库表中操作的
执行时间作为事件时间 ，否则通过时间抽取的版本可能和数据库中的版本不匹配。</p>

<h3 id="声明版本视图">声明版本视图</h3>

<p>Flink 也支持定义版本视图只要一个视图包含主键和事件时间便是一个版本视图。</p>

<p>假设我们有表 <code class="highlighter-rouge">RatesHistory</code> 如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- 定义一张 append-only 表</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">RatesHistory</span> <span class="p">(</span>
    <span class="n">currency_time</span> <span class="nb">TIMESTAMP</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">currency</span> <span class="n">STRING</span><span class="p">,</span>
    <span class="n">rate</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">WATERMARK</span> <span class="k">FOR</span> <span class="n">currency_time</span> <span class="k">AS</span> <span class="n">currency_time</span>   <span class="c1">-- 定义事件时间</span>
<span class="p">)</span> <span class="k">WITH</span> <span class="p">(</span>
  <span class="s1">'connector'</span> <span class="o">=</span> <span class="s1">'kafka'</span><span class="p">,</span>
  <span class="s1">'topic'</span> <span class="o">=</span> <span class="s1">'rates'</span><span class="p">,</span>
  <span class="s1">'scan.startup.mode'</span> <span class="o">=</span> <span class="s1">'earliest-offset'</span><span class="p">,</span>
  <span class="s1">'properties.bootstrap.servers'</span> <span class="o">=</span> <span class="s1">'localhost:9092'</span><span class="p">,</span>
  <span class="s1">'format'</span> <span class="o">=</span> <span class="s1">'json'</span>                                <span class="c1">-- 普通的 append-only 流</span>
<span class="p">)</span></code></pre></figure>

<p>表 <code class="highlighter-rouge">RatesHistory</code> 代表一个兑换日元货币汇率表（日元汇率为1），该表是不断增长的 append-only 表。
例如，<code class="highlighter-rouge">欧元</code> 兑换 <code class="highlighter-rouge">日元</code> 从 <code class="highlighter-rouge">09:00:00</code> 到 <code class="highlighter-rouge">10:45:00</code> 的汇率为 <code class="highlighter-rouge">114</code>。从 <code class="highlighter-rouge">10:45:00</code> 到 <code class="highlighter-rouge">11:15:00</code> 的汇率为 <code class="highlighter-rouge">116</code>。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">RatesHistory</span><span class="p">;</span>

<span class="n">currency_time</span> <span class="n">currency</span>  <span class="n">rate</span>
<span class="o">=============</span> <span class="o">=========</span> <span class="o">====</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">US</span> <span class="n">Dollar</span> <span class="mi">102</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>      <span class="mi">114</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Yen</span>       <span class="mi">1</span>
<span class="mi">10</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>      <span class="mi">116</span>
<span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>      <span class="mi">119</span>
<span class="mi">11</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Pounds</span>    <span class="mi">108</span></code></pre></figure>

<p>为了在 <code class="highlighter-rouge">RatesHistory</code> 上定义版本表，Flink 支持通过<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html#去重">去重查询</a>定义版本视图，
去重查询可以产出一个有序的 changelog 流，去重查询能够推断主键并保留原始数据流的事件时间属性。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">versioned_rates</span> <span class="k">AS</span>              
<span class="k">SELECT</span> <span class="n">currency</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">currency_time</span>            <span class="c1">-- (1) `currency_time` 保留了事件时间</span>
  <span class="k">FROM</span> <span class="p">(</span>
      <span class="k">SELECT</span> <span class="o">*</span><span class="p">,</span>
      <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">currency</span>  <span class="c1">-- (2) `currency` 是去重 query 的 unique key，可以作为主键</span>
         <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">currency_time</span> <span class="k">DESC</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rowNum</span> 
      <span class="k">FROM</span> <span class="n">RatesHistory</span> <span class="p">)</span>
<span class="k">WHERE</span> <span class="n">rowNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 

<span class="c1">-- 视图 `versioned_rates` 将会产出如下的 changelog:</span>

<span class="p">(</span><span class="n">changelog</span> <span class="n">kind</span><span class="p">)</span> <span class="n">currency_time</span> <span class="n">currency</span>   <span class="n">rate</span>
<span class="o">================</span> <span class="o">=============</span> <span class="o">=========</span>  <span class="o">====</span>
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>        <span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">US</span> <span class="n">Dollar</span>  <span class="mi">102</span>
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>        <span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>       <span class="mi">114</span>
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>        <span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Yen</span>        <span class="mi">1</span>
<span class="o">+</span><span class="p">(</span><span class="n">UPDATE_AFTER</span><span class="p">)</span>  <span class="mi">10</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>       <span class="mi">116</span>
<span class="o">+</span><span class="p">(</span><span class="n">UPDATE_AFTER</span><span class="p">)</span>  <span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>       <span class="mi">119</span>
<span class="o">+</span><span class="p">(</span><span class="k">INSERT</span><span class="p">)</span>        <span class="mi">11</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Pounds</span>     <span class="mi">108</span></code></pre></figure>

<p>行 <code class="highlighter-rouge">(1)</code> 保留了事件时间作为视图 <code class="highlighter-rouge">versioned_rates</code> 的事件时间，行 <code class="highlighter-rouge">(2)</code> 使得视图 <code class="highlighter-rouge">versioned_rates</code> 有了主键, 因此视图 <code class="highlighter-rouge">versioned_rates</code> 是一个版本视图。</p>

<p>视图中的去重 query 会被 Flink 优化并高效地产出 changelog stream, 产出的 changelog 保留了主键约束和事件时间。</p>

<p>如果我们想输出 <code class="highlighter-rouge">versioned_rates</code> 表在 <code class="highlighter-rouge">11:00:00</code> 对应的版本，表的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">currency_time</span> <span class="n">currency</span>   <span class="n">rate</span>  
<span class="o">=============</span> <span class="o">==========</span> <span class="o">====</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">US</span> <span class="n">Dollar</span>  <span class="mi">102</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Yen</span>        <span class="mi">1</span>
<span class="mi">10</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>       <span class="mi">116</span></code></pre></figure>

<p>如果我们想输出 <code class="highlighter-rouge">versioned_rates</code> 表在 <code class="highlighter-rouge">12:00:00</code> 对应的版本，表的内容如下所示：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">currency_time</span> <span class="n">currency</span>   <span class="n">rate</span>  
<span class="o">=============</span> <span class="o">==========</span> <span class="o">====</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">US</span> <span class="n">Dollar</span>  <span class="mi">102</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Yen</span>        <span class="mi">1</span>
<span class="mi">10</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Euro</span>       <span class="mi">119</span>
<span class="mi">11</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">00</span>      <span class="n">Pounds</span>     <span class="mi">108</span></code></pre></figure>

<h3 id="声明普通表">声明普通表</h3>

<p>普通表的声明和 Flink 建表 DDL 一致，参考 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html#create-table">create table</a> 页面获取更多如何建表的信息。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- 用 DDL 定义一张 HBase 表，然后我们可以在 SQL 中将其当作一张时态表使用</span>
<span class="c1">-- 'currency' 列是 HBase 表中的 rowKey</span>
 <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">LatestRates</span> <span class="p">(</span>   
     <span class="n">currency</span> <span class="n">STRING</span><span class="p">,</span>   
     <span class="n">fam1</span> <span class="k">ROW</span><span class="o">&lt;</span><span class="n">rate</span> <span class="nb">DOUBLE</span><span class="o">&gt;</span>   
 <span class="p">)</span> <span class="k">WITH</span> <span class="p">(</span>   
    <span class="s1">'connector'</span> <span class="o">=</span> <span class="s1">'hbase-1.4'</span><span class="p">,</span>   
    <span class="s1">'table-name'</span> <span class="o">=</span> <span class="s1">'rates'</span><span class="p">,</span>   
    <span class="s1">'zookeeper.quorum'</span> <span class="o">=</span> <span class="s1">'localhost:2181'</span>   
 <span class="p">);</span></code></pre></figure>

<p><span class="label label-danger">注意</span> 理论上讲任意都能用作时态表并在基于处理时间的时态表 Join 中使用，但当前支持作为时态表的普通表必须实现接口 <code class="highlighter-rouge">LookupableTableSource</code>。接口 <code class="highlighter-rouge">LookupableTableSource</code> 的实例只能作为时态表用于基于处理时间的时态 Join 。</p>

<p>通过 <code class="highlighter-rouge">LookupableTableSource</code> 定义的表意味着该表具备了在运行时通过一个或多个 key 去查询外部存储系统的能力，当前支持在 基于处理时间的时态表 join 中使用的表包括
<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a>, <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a> 和 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html#temporal-table-join">Hive</a>。</p>

<p>另请参阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html#lookup-table-source">LookupableTableSource</a>页面了解更多信息。</p>

<p>在基于处理时间的时态表 Join 中支持任意表作为时态表会在不远的将来支持。</p>

<h2 id="时态表函数">时态表函数</h2>
<p>时态表函数是一种过时的方式去定义时态表并关联时态表的数据，现在我们可以用时态表 DDL 去定义时态表，用<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html#时态表-join">时态表 Join</a> 语法去关联时态表。</p>

<p>时态表函数和时态表 DDL 最大的区别在于，时态表 DDL 可以在纯 SQL 环境中使用但是时态表函数不支持，用时态表 DDL 声明的时态表支持 changelog 流和 append-only 流但时态表函数仅支持 append-only 流。</p>

<p>为了访问时态表中的数据，必须传递一个<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a>，该属性确定将要返回的表的版本。
Flink 使用<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html#表值函数">表函数</a>的 SQL 语法提供一种表达它的方法。</p>

<p>定义后，<em>时态表函数</em>将使用单个时间参数 timeAttribute 并返回一个行集合。
该集合包含相对于给定时间属性的所有现有主键的行的最新版本。</p>

<p>假设我们基于 <code class="highlighter-rouge">RatesHistory</code> 表定义了一个时态表函数，我们可以通过以下方式查询该函数 <code class="highlighter-rouge">Rates(timeAttribute)</code>：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Rates</span><span class="p">(</span><span class="s1">'10:15:00'</span><span class="p">);</span>

<span class="n">rowtime</span>  <span class="n">currency</span>  <span class="n">rate</span>
<span class="o">=======</span>  <span class="o">=========</span> <span class="o">====</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">US</span> <span class="n">Dollar</span> <span class="mi">102</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">Euro</span>      <span class="mi">114</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">Yen</span>       <span class="mi">1</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Rates</span><span class="p">(</span><span class="s1">'11:00:00'</span><span class="p">);</span>

<span class="n">rowtime</span>  <span class="n">currency</span>  <span class="n">rate</span>
<span class="o">========</span> <span class="o">=========</span> <span class="o">====</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">US</span> <span class="n">Dollar</span> <span class="mi">102</span>
<span class="mi">10</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">00</span> <span class="n">Euro</span>      <span class="mi">116</span>
<span class="mi">09</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">Yen</span>       <span class="mi">1</span></code></pre></figure>

<p>对 <code class="highlighter-rouge">Rates(timeAttribute)</code> 的每个查询都将返回给定 <code class="highlighter-rouge">timeAttribute</code> 的 <code class="highlighter-rouge">Rates</code> 状态。</p>

<p><strong>注意</strong>：当前 Flink 不支持使用常量时间属性参数直接查询时态表函数。目前，时态表函数只能在 join 中使用。上面的示例用于为函数 <code class="highlighter-rouge">Rates(timeAttribute)</code> 返回内容提供直观信息。</p>

<p>另请参阅有关<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">用于持续查询的 join </a>页面，以获取有关如何与时态表 join 的更多信息。</p>

<h3 id="定义时态表函数">定义时态表函数</h3>

<p>以下代码段说明了如何从 append-only 表中创建时态表函数。</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.flink.table.functions.TemporalTableFunction</span><span class="o">;</span>
<span class="o">(...)</span>

<span class="c1">// 获取 stream 和 table 环境</span>
<span class="nc">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="nc">StreamTableEnvironment</span> <span class="n">tEnv</span> <span class="o">=</span> <span class="nc">StreamTableEnvironment</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// 提供一个汇率历史记录表静态数据集</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;&gt;</span> <span class="n">ratesHistoryData</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">ratesHistoryData</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"US Dollar"</span><span class="o">,</span> <span class="mi">102L</span><span class="o">));</span>
<span class="n">ratesHistoryData</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">114L</span><span class="o">));</span>
<span class="n">ratesHistoryData</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Yen"</span><span class="o">,</span> <span class="mi">1L</span><span class="o">));</span>
<span class="n">ratesHistoryData</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">116L</span><span class="o">));</span>
<span class="n">ratesHistoryData</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">119L</span><span class="o">));</span>

<span class="c1">// 用上面的数据集创建并注册一个示例表</span>
<span class="c1">// 在实际设置中，应使用自己的表替换它</span>
<span class="nc">DataStream</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;&gt;</span> <span class="n">ratesHistoryStream</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">fromCollection</span><span class="o">(</span><span class="n">ratesHistoryData</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">ratesHistory</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">ratesHistoryStream</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"r_currency"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"r_rate"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"r_proctime"</span><span class="o">).</span><span class="na">proctime</span><span class="o">());</span>

<span class="n">tEnv</span><span class="o">.</span><span class="na">createTemporaryView</span><span class="o">(</span><span class="s">"RatesHistory"</span><span class="o">,</span> <span class="n">ratesHistory</span><span class="o">);</span>

<span class="c1">// 创建和注册时态表函数</span>
<span class="c1">// 指定 "r_proctime" 为时间属性，指定 "r_currency" 为主键</span>
<span class="nc">TemporalTableFunction</span> <span class="n">rates</span> <span class="o">=</span> <span class="n">ratesHistory</span><span class="o">.</span><span class="na">createTemporalTableFunction</span><span class="o">(</span><span class="s">"r_proctime"</span><span class="o">,</span> <span class="s">"r_currency"</span><span class="o">);</span> <span class="c1">// &lt;==== (1)</span>
<span class="n">tEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"Rates"</span><span class="o">,</span> <span class="n">rates</span><span class="o">);</span>                                                              <span class="c1">// &lt;==== (2)</span></code></pre></figure>

  </div>
  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// 获取 stream 和 table 环境</span>
<span class="k">val</span> <span class="nv">env</span> <span class="k">=</span> <span class="nv">StreamExecutionEnvironment</span><span class="o">.</span><span class="py">getExecutionEnvironment</span>
<span class="k">val</span> <span class="nv">tEnv</span> <span class="k">=</span> <span class="nv">StreamTableEnvironment</span><span class="o">.</span><span class="py">create</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// 提供一个汇率历史记录表静态数据集</span>
<span class="k">val</span> <span class="nv">ratesHistoryData</span> <span class="k">=</span> <span class="k">new</span> <span class="nv">mutable</span><span class="o">.</span><span class="py">MutableList</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Long</span><span class="o">)]</span>
<span class="n">ratesHistoryData</span><span class="o">.+=((</span><span class="s">"US Dollar"</span><span class="o">,</span> <span class="mi">102L</span><span class="o">))</span>
<span class="n">ratesHistoryData</span><span class="o">.+=((</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">114L</span><span class="o">))</span>
<span class="n">ratesHistoryData</span><span class="o">.+=((</span><span class="s">"Yen"</span><span class="o">,</span> <span class="mi">1L</span><span class="o">))</span>
<span class="n">ratesHistoryData</span><span class="o">.+=((</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">116L</span><span class="o">))</span>
<span class="n">ratesHistoryData</span><span class="o">.+=((</span><span class="s">"Euro"</span><span class="o">,</span> <span class="mi">119L</span><span class="o">))</span>

<span class="c1">// 用上面的数据集创建并注册一个示例表</span>
<span class="c1">// 在实际设置中，应使用自己的表替换它</span>
<span class="k">val</span> <span class="nv">ratesHistory</span> <span class="k">=</span> <span class="n">env</span>
  <span class="o">.</span><span class="py">fromCollection</span><span class="o">(</span><span class="n">ratesHistoryData</span><span class="o">)</span>
  <span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">,</span> <span class="ss">'r_currency</span><span class="o">,</span> <span class="ss">'r_rate</span><span class="o">,</span> <span class="ss">'r_proctime</span><span class="o">.</span><span class="py">proctime</span><span class="o">)</span>

<span class="nv">tEnv</span><span class="o">.</span><span class="py">createTemporaryView</span><span class="o">(</span><span class="s">"RatesHistory"</span><span class="o">,</span> <span class="n">ratesHistory</span><span class="o">)</span>

<span class="c1">// 创建和注册时态表函数</span>
<span class="c1">// 指定 "r_proctime" 为时间属性，指定 "r_currency" 为主键</span>
<span class="k">val</span> <span class="nv">rates</span> <span class="k">=</span> <span class="nv">ratesHistory</span><span class="o">.</span><span class="py">createTemporalTableFunction</span><span class="o">(</span><span class="n">$</span><span class="s">"r_proctime"</span><span class="o">,</span> <span class="n">$</span><span class="s">"r_currency"</span><span class="o">)</span> <span class="c1">// &lt;==== (1)</span>
<span class="nv">tEnv</span><span class="o">.</span><span class="py">registerFunction</span><span class="o">(</span><span class="s">"Rates"</span><span class="o">,</span> <span class="n">rates</span><span class="o">)</span>                                          <span class="c1">// &lt;==== (2)</span></code></pre></figure>

  </div>
</div>

<p>行<code class="highlighter-rouge">(1)</code>创建了一个 <code class="highlighter-rouge">rates</code> <a href="#时态表函数">时态表函数</a>，
这使我们可以在<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html#joins"> Table API </a>中使用 <code class="highlighter-rouge">rates</code> 函数。</p>

<p>行<code class="highlighter-rouge">(2)</code>在表环境中注册名称为 <code class="highlighter-rouge">Rates</code> 的函数，这使我们可以在<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html#joins"> SQL </a>中使用 <code class="highlighter-rouge">Rates</code> 函数。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      想参与贡献翻译？
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
