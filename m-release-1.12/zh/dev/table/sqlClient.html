<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: SQL 客户端</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/zh/dev/table/sqlClient.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/local_installation.html">本地模式安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/datastream_api.html">基于 DataStream API 实现欺诈检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/table_api.html">基于 Table API 实现实时报表</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/flink-operations-playground.html">Flink 操作场景</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> 实践练习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/datastream_api.html">DataStream API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/etl.html">数据管道 & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/streaming_analytics.html">流式分析</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/event_driven.html">事件驱动应用</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/fault_tolerance.html">容错处理</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> 概念透析<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/index.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/stateful-stream-processing.html">有状态流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">及时流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/flink-architecture.html">Flink 架构</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/glossary.html">词汇表</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_time.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamps_watermarks.html">生成 Watermark</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamp_extractors.html">内置 Watermark 生成器</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/broadcast_state.html">Broadcast State 模式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/schema_evolution.html">状态数据结构升级</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/user_defined_functions.html">用户自定义 Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">算子<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/windows.html">窗口</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/asyncio.html">异步 I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/side_output.html">旁路输出</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/testing.html">测试</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/experimental.html">实验功能</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/java_lambdas.html">Java Lambda 表达式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/iterations.html">迭代</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/hadoop_compatibility.html">Hadoop 兼容</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/local_execution.html">本地执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/cluster_execution.html">集群执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/examples.html">Batch 示例</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse"class="active">Table API & SQL</a><div class="collapse in" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">概念与通用 API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">流式概念<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表 (Dynamic Table)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">流上的 Join</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">时态表（Temporal Tables）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/match_recognize.html">模式检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html">查询语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html">CREATE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/drop.html">DROP 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/alter.html">ALTER 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/insert.html">INSERT 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/describe.html">DESCRIBE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/use.html">USE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/show.html">SHOW 语句</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html">系统（内置）函数</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/modules.html">模块</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sqlClient.html" class="active">SQL 客户端</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/config.html">配置</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tuning/streaming_aggregation_optimization.html">流式聚合</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse">Python API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/installation.html">环境安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table_api_tutorial.html">Table API 教程</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream_tutorial.html">DataStream API 教程</a></li>
<li><a href="#collapse-103" data-toggle="collapse">Table API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html">Python Table API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/built_in_functions.html">系统（内置）函数</a></li>
<li><a href="#collapse-109" data-toggle="collapse">自定义函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通自定义函数（UDF）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html">PyFlink Table 和 Pandas DataFrame 互转</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_table_api_connectors.html">连接器</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/data_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/operators.html">算子</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/dependency_management.html">依赖管理</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/environment_variables.html">环境变量</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/faq.html">常见问题</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">数据类型以及序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/types_serialization.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/custom_serializers.html">自定义序列化器</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_configuration.html">执行配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/packaging.html">程序打包</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/parallel.html">并行执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_plans.html">执行计划</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">Task 故障恢复</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/migration.html">API 迁移指南</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/cep.html">事件处理 (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/guarantees.html">容错保证</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/">概览</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_dialect.html">Hive 方言</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_functions.html">Hive 函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/downloads.html">下载</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/">概览</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/local.html">本地集群</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/config.html">配置参数</a></li>
<li><a href="#collapse-213" data-toggle="collapse">内存配置<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup.html">配置 Flink 进程的内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_tm.html">配置 TaskManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_jobmanager.html">配置 JobManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_tuning.html">调优指南</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_trouble.html">常见问题</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_migration.html">升级指南</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">文件系统<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/common.html">通用配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/oss.html">阿里云 OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/azure.html">Azure Blob 存储</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-ssl.html">SSL 设置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/external_resources.html">扩展资源</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/logging.html">日志</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/large_state_tuning.html">大状态与 Checkpoint 调优</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_event_time.html">调试窗口与事件时间</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_classloading.html">调试类加载</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/application_profiling.html">应用程序分析</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/checkpoint_monitoring.html">监控 Checkpoint</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/back_pressure.html">监控反压</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/upgrading.html">升级应用程序和 Flink 版本</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/production_ready.html">生产就绪情况核对清单</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink 开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/ide_setup.html">导入 Flink 到 IDE 中</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/building.html">从源码构建 Flink</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> 内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/job_scheduling.html">作业调度</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/task_lifecycle.html">Task 生命周期</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/filesystems.html">文件系统</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">选择文档版本<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/sqlClient.html">
      <button type="submit" class="btn btn-default">English</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">Table API & SQL</a></li>
  
    <li class="active">SQL 客户端</li>
</ol>

<h1>SQL 客户端</h1>




<p>Flink 的 Table &amp; SQL API 可以处理 SQL 语言编写的查询语句，但是这些查询需要嵌入用 Java 或 Scala 编写的表程序中。此外，这些程序在提交到集群前需要用构建工具打包。这或多或少限制了 Java/Scala 程序员对 Flink 的使用。</p>

<p><em>SQL 客户端</em> 的目的是提供一种简单的方式来编写、调试和提交表程序到 Flink 集群上，而无需写一行 Java 或 Scala 代码。<em>SQL 客户端命令行界面（CLI）</em> 能够在命令行中检索和可视化分布式应用中实时产生的结果。</p>

<p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/fig/sql_client_demo.gif"><img class="offset" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/fig/sql_client_demo.gif" alt="Animated demo of the Flink SQL Client CLI running table programs on a cluster" width="80%" /></a></p>

<ul id="markdown-toc">
  <li><a href="#入门" id="markdown-toc-入门">入门</a>    <ul>
      <li><a href="#启动-sql-客户端命令行界面" id="markdown-toc-启动-sql-客户端命令行界面">启动 SQL 客户端命令行界面</a></li>
      <li><a href="#执行-sql-查询" id="markdown-toc-执行-sql-查询">执行 SQL 查询</a></li>
    </ul>
  </li>
  <li><a href="#配置" id="markdown-toc-配置">配置</a>    <ul>
      <li><a href="#环境配置文件" id="markdown-toc-环境配置文件">环境配置文件</a></li>
      <li><a href="#依赖" id="markdown-toc-依赖">依赖</a></li>
      <li><a href="#自定义函数user-defined-functions" id="markdown-toc-自定义函数user-defined-functions">自定义函数（User-defined Functions）</a></li>
    </ul>
  </li>
  <li><a href="#catalogs" id="markdown-toc-catalogs">Catalogs</a></li>
  <li><a href="#分离的-sql-查询" id="markdown-toc-分离的-sql-查询">分离的 SQL 查询</a></li>
  <li><a href="#sql-视图" id="markdown-toc-sql-视图">SQL 视图</a></li>
  <li><a href="#临时表temporal-table" id="markdown-toc-临时表temporal-table">临时表（Temporal Table）</a></li>
  <li><a href="#局限与未来" id="markdown-toc-局限与未来">局限与未来</a></li>
</ul>

<h2 id="入门">入门</h2>

<p>本节介绍如何在命令行里启动（setup）和运行你的第一个 Flink SQL 程序。</p>

<p>SQL 客户端捆绑在常规 Flink 发行版中，因此可以直接运行。它仅需要一个正在运行的 Flink 集群就可以在其中执行表程序。有关设置 Flink 群集的更多信息，请参见<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">集群和部署</a>部分。如果仅想试用 SQL 客户端，也可以使用以下命令启动本地集群：</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./bin/start-cluster.sh</code></pre></figure>

<h3 id="启动-sql-客户端命令行界面">启动 SQL 客户端命令行界面</h3>

<p>SQL Client 脚本也位于 Flink 的 bin 目录中。<a href="sqlClient.html#limitations--future">将来</a>，用户可以通过启动嵌入式 standalone 进程或通过连接到远程 SQL 客户端网关来启动 SQL 客户端命令行界面。目前仅支持 <code class="highlighter-rouge">embedded</code> 模式。可以通过以下方式启动 CLI：</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">./bin/sql-client.sh embedded</code></pre></figure>

<p>默认情况下，SQL 客户端将从 <code class="highlighter-rouge">./conf/sql-client-defaults.yaml</code> 中读取配置。有关环境配置文件结构的更多信息，请参见<a href="sqlClient.html#environment-files">配置部分</a>。</p>

<h3 id="执行-sql-查询">执行 SQL 查询</h3>

<p>命令行界面启动后，你可以使用 <code class="highlighter-rouge">HELP</code> 命令列出所有可用的 SQL 语句。输入第一条 SQL 查询语句并按 <code class="highlighter-rouge">Enter</code> 键执行，可以验证你的设置及集群连接是否正确：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="s1">'Hello World'</span><span class="p">;</span></code></pre></figure>

<p>该查询不需要 table source，并且只产生一行结果。CLI 将从集群中检索结果并将其可视化。按 <code class="highlighter-rouge">Q</code> 键退出结果视图。</p>

<p>CLI 为维护和可视化结果提供<strong>三种模式</strong>。</p>

<p><strong>表格模式</strong>（table mode）在内存中实体化结果，并将结果用规则的分页表格可视化展示出来。执行如下命令启用：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">SET execution.result-mode=table;</code></pre></figure>

<p><strong>变更日志模式</strong>（changelog mode）不会实体化和可视化结果，而是由插入（<code class="highlighter-rouge">+</code>）和撤销（<code class="highlighter-rouge">-</code>）组成的持续查询产生结果流。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">SET execution.result-mode=changelog;</code></pre></figure>

<p><strong>Tableau模式</strong>（tableau mode）更接近传统的数据库，会将执行的结果以制表的形式直接打在屏幕之上。具体显示的内容会取决于作业
执行模式的不同(<code class="highlighter-rouge">execution.type</code>)：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">SET execution.result-mode=tableau;</code></pre></figure>

<p>注意当你使用这个模式运行一个流式查询的时候，Flink 会将结果持续的打印在当前的屏幕之上。如果这个流式查询的输入是有限的数据集，
那么Flink在处理完所有的数据之后，会自动的停止作业，同时屏幕上的打印也会相应的停止。如果你想提前结束这个查询，那么可以直接使用
<code class="highlighter-rouge">CTRL-C</code> 按键，这个会停掉作业同时停止屏幕上的打印。</p>

<p>你可以用如下查询来查看三种结果模式的运行情况：</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cnt</span> <span class="k">FROM</span> <span class="p">(</span><span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Bob'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'Alice'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'Greg'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'Bob'</span><span class="p">))</span> <span class="k">AS</span> <span class="n">NameTable</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">name</span><span class="p">;</span></code></pre></figure>

<p>此查询执行一个有限字数示例：</p>

<p><em>变更日志模式</em> 下，看到的结果应该类似于：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">+ Bob, 1
+ Alice, 1
+ Greg, 1
- Bob, 1
+ Bob, 2</code></pre></figure>

<p><em>表格模式</em> 下，可视化结果表将不断更新，直到表程序以如下内容结束：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Bob, 2
Alice, 1
Greg, 1</code></pre></figure>

<p><em>Tableau模式</em> 下，如果这个查询以流的方式执行，那么将显示以下内容：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">+-----+----------------------+----------------------+
| +/- |                 name |                  cnt |
+-----+----------------------+----------------------+
|   + |                  Bob |                    1 |
|   + |                Alice |                    1 |
|   + |                 Greg |                    1 |
|   - |                  Bob |                    1 |
|   + |                  Bob |                    2 |
+-----+----------------------+----------------------+
Received a total of 5 rows</code></pre></figure>

<p>如果这个查询以批的方式执行，显示的内容如下：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">+-------+-----+
|  name | cnt |
+-------+-----+
| Alice |   1 |
|   Bob |   2 |
|  Greg |   1 |
+-------+-----+
3 rows in set</code></pre></figure>

<p>这几种结果模式在 SQL 查询的原型设计过程中都非常有用。这些模式的结果都存储在 SQL 客户端 的 Java 堆内存中。为了保持 CLI 界面及时响应，变更日志模式仅显示最近的 1000 个更改。表格模式支持浏览更大的结果，这些结果仅受可用主内存和配置的<a href="sqlClient.html#configuration">最大行数</a>（<code class="highlighter-rouge">max-table-result-rows</code>）的限制。</p>

<p><span class="label label-danger">注意</span> 在批处理环境下执行的查询只能用表格模式或者Tableau模式进行检索。</p>

<p>定义查询语句后，可以将其作为长时间运行的独立 Flink 作业提交给集群。为此，其目标系统需要使用 <a href="sqlClient.html#detached-sql-queries">INSERT INTO 语句</a>指定存储结果。<a href="sqlClient.html#configuration">配置部分</a>解释如何声明读取数据的 table source，写入数据的 sink 以及配置其他表程序属性的方法。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<p><a name="configuration"></a></p>

<h2 id="配置">配置</h2>

<p>SQL 客户端启动时可以添加 CLI 选项，具体如下。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">./bin/sql-client.sh embedded --help

Mode "embedded" submits Flink jobs from the local machine.

  Syntax: embedded [OPTIONS]
  "embedded" mode options:
     -d,--defaults &lt;environment file&gt;      The environment properties with which
                                           every new session is initialized.
                                           Properties might be overwritten by
                                           session properties.
     -e,--environment &lt;environment file&gt;   The environment properties to be
                                           imported into the session. It might
                                           overwrite default environment
                                           properties.
     -h,--help                             Show the help message with
                                           descriptions of all options.
     -hist,--history &lt;History file path&gt;   The file which you want to save the
                                           command history into. If not
                                           specified, we will auto-generate one
                                           under your user's home directory.
     -j,--jar &lt;JAR file&gt;                   A JAR file to be imported into the
                                           session. The file might contain
                                           user-defined classes needed for the
                                           execution of statements such as
                                           functions, table sources, or sinks.
                                           Can be used multiple times.
     -l,--library &lt;JAR directory&gt;          A JAR file directory with which every
                                           new session is initialized. The files
                                           might contain user-defined classes
                                           needed for the execution of
                                           statements such as functions, table
                                           sources, or sinks. Can be used
                                           multiple times.
     -pyarch,--pyArchives &lt;arg&gt;            Add python archive files for job. The
                                           archive files will be extracted to
                                           the working directory of python UDF
                                           worker. Currently only zip-format is
                                           supported. For each archive file, a
                                           target directory be specified. If the
                                           target directory name is specified,
                                           the archive file will be extracted to
                                           a name can directory with the
                                           specified name. Otherwise, the
                                           archive file will be extracted to a
                                           directory with the same name of the
                                           archive file. The files uploaded via
                                           this option are accessible via
                                           relative path. '#' could be used as
                                           the separator of the archive file
                                           path and the target directory name.
                                           Comma (',') could be used as the
                                           separator to specify multiple archive
                                           files. This option can be used to
                                           upload the virtual environment, the
                                           data files used in Python UDF (e.g.:
                                           --pyArchives
                                           file:///tmp/py37.zip,file:///tmp/data
                                           .zip#data --pyExecutable
                                           py37.zip/py37/bin/python). The data
                                           files could be accessed in Python
                                           UDF, e.g.: f = open('data/data.txt',
                                           'r').
     -pyexec,--pyExecutable &lt;arg&gt;          Specify the path of the python
                                           interpreter used to execute the
                                           python UDF worker (e.g.:
                                           --pyExecutable
                                           /usr/local/bin/python3). The python
                                           UDF worker depends on Python 3.5+,
                                           Apache Beam (version == 2.23.0), Pip
                                           (version &gt;= 7.1.0) and SetupTools
                                           (version &gt;= 37.0.0). Please ensure
                                           that the specified environment meets
                                           the above requirements.
     -pyfs,--pyFiles &lt;pythonFiles&gt;         Attach custom python files for job.
                                           These files will be added to the
                                           PYTHONPATH of both the local client
                                           and the remote python UDF worker. The
                                           standard python resource file
                                           suffixes such as .py/.egg/.zip or
                                           directory are all supported. Comma
                                           (',') could be used as the separator
                                           to specify multiple files (e.g.:
                                           --pyFiles
                                           file:///tmp/myresource.zip,hdfs:///$n
                                           amenode_address/myresource2.zip).
     -pyreq,--pyRequirements &lt;arg&gt;         Specify a requirements.txt file which
                                           defines the third-party dependencies.
                                           These dependencies will be installed
                                           and added to the PYTHONPATH of the
                                           python UDF worker. A directory which
                                           contains the installation packages of
                                           these dependencies could be specified
                                           optionally. Use '#' as the separator
                                           if the optional parameter exists
                                           (e.g.: --pyRequirements
                                           file:///tmp/requirements.txt#file:///
                                           tmp/cached_dir).
     -s,--session &lt;session identifier&gt;     The identifier for a session.
                                           'default' is the default identifier.
     -u,--update &lt;SQL update statement&gt;    Experimental (for testing only!):
                                           Instructs the SQL Client to
                                           immediately execute the given update
                                           statement after starting up. The
                                           process is shut down after the
                                           statement has been submitted to the
                                           cluster and returns an appropriate
                                           return code. Currently, this feature
                                           is only supported for INSERT INTO
                                           statements that declare the target
                                           sink table.</code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<p><a name="environment-files"></a></p>

<h3 id="环境配置文件">环境配置文件</h3>

<p>SQL 查询执行前需要配置相关环境变量。<em>环境配置文件</em> 定义了 catalog、table sources、table sinks、用户自定义函数和其他执行或部署所需属性。</p>

<p>每个环境配置文件是常规的 <a href="http://yaml.org/">YAML 文件</a>，例子如下。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="c1"># 定义表，如 source、sink、视图或临时表。</span>

<span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyTableSource</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">source-table</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
    <span class="na">connector</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">filesystem</span>
      <span class="na">path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/path/to/something.csv"</span>
    <span class="na">format</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">csv</span>
      <span class="na">fields</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField1</span>
          <span class="na">data-type</span><span class="pi">:</span> <span class="s">INT</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField2</span>
          <span class="na">data-type</span><span class="pi">:</span> <span class="s">VARCHAR</span>
      <span class="na">line-delimiter</span><span class="pi">:</span> <span class="s2">"</span><span class="se">\n</span><span class="s">"</span>
      <span class="na">comment-prefix</span><span class="pi">:</span> <span class="s2">"</span><span class="s">#"</span>
    <span class="na">schema</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField1</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">INT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField2</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">VARCHAR</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyCustomView</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">view</span>
    <span class="na">query</span><span class="pi">:</span> <span class="s2">"</span><span class="s">SELECT</span><span class="nv"> </span><span class="s">MyField2</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">MyTableSource"</span>

<span class="c1"># 定义用户自定义函数</span>

<span class="na">functions</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myUDF</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s">class</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s">foo.bar.AggregateUDF</span>
    <span class="na">constructor</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="m">7.6</span>
      <span class="pi">-</span> <span class="no">false</span>

<span class="c1"># 定义 catalogs</span>

<span class="na">catalogs</span><span class="pi">:</span>
   <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog_1</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">hive</span>
     <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
     <span class="na">hive-conf-dir</span><span class="pi">:</span> <span class="s">...</span>
   <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog_2</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">hive</span>
     <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
     <span class="na">default-database</span><span class="pi">:</span> <span class="s">mydb2</span>
     <span class="na">hive-conf-dir</span><span class="pi">:</span> <span class="s">...</span>

<span class="c1"># 改变表程序基本的执行行为属性。</span>

<span class="na">execution</span><span class="pi">:</span>
  <span class="na">planner</span><span class="pi">:</span> <span class="s">blink</span>                    <span class="c1"># 可选： 'blink' （默认）或 'old'</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">streaming</span>                   <span class="c1"># 必选：执行模式为 'batch' 或 'streaming'</span>
  <span class="na">result-mode</span><span class="pi">:</span> <span class="s">table</span>                <span class="c1"># 必选：'table' 或 'changelog'</span>
  <span class="na">max-table-result-rows</span><span class="pi">:</span> <span class="m">1000000</span>    <span class="c1"># 可选：'table' 模式下可维护的最大行数（默认为 1000000，小于 1 则表示无限制）</span>
  <span class="na">time-characteristic</span><span class="pi">:</span> <span class="s">event-time</span>   <span class="c1"># 可选： 'processing-time' 或 'event-time' （默认）</span>
  <span class="na">parallelism</span><span class="pi">:</span> <span class="m">1</span>                    <span class="c1"># 可选：Flink 的并行数量（默认为 1）</span>
  <span class="na">periodic-watermarks-interval</span><span class="pi">:</span> <span class="m">200</span> <span class="c1"># 可选：周期性 watermarks 的间隔时间（默认 200 ms）</span>
  <span class="na">max-parallelism</span><span class="pi">:</span> <span class="m">16</span>               <span class="c1"># 可选：Flink 的最大并行数量（默认 128）</span>
  <span class="na">min-idle-state-retention</span><span class="pi">:</span> <span class="m">0</span>       <span class="c1"># 可选：表程序的最小空闲状态时间</span>
  <span class="na">max-idle-state-retention</span><span class="pi">:</span> <span class="m">0</span>       <span class="c1"># 可选：表程序的最大空闲状态时间</span>
  <span class="na">current-catalog</span><span class="pi">:</span> <span class="s">catalog_1</span>        <span class="c1"># 可选：当前会话 catalog 的名称（默认为 'default_catalog'）</span>
  <span class="na">current-database</span><span class="pi">:</span> <span class="s">mydb1</span>           <span class="c1"># 可选：当前 catalog 的当前数据库名称</span>
                                    <span class="c1">#   （默认为当前 catalog 的默认数据库）</span>
  <span class="na">restart-strategy</span><span class="pi">:</span>                 <span class="c1"># 可选：重启策略（restart-strategy）</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">fallback</span>                  <span class="c1">#   默认情况下“回退”到全局重启策略</span>

<span class="c1"># 用于调整和调优表程序的配置选项。</span>

<span class="c1"># 在专用的”配置”页面上可以找到完整的选项列表及其默认值。</span>
<span class="na">configuration</span><span class="pi">:</span>
  <span class="s">table.optimizer.join-reorder-enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="s">table.exec.spill-compression.enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="s">table.exec.spill-compression.block-size</span><span class="pi">:</span> <span class="s">128kb</span>

<span class="c1"># 描述表程序提交集群的属性。</span>

<span class="na">deployment</span><span class="pi">:</span>
  <span class="na">response-timeout</span><span class="pi">:</span> <span class="s">5000</span></code></pre></figure>

<p>上述配置：</p>

<ul>
  <li>定义一个从 CSV 文件中读取的 table source <code class="highlighter-rouge">MyTableSource</code> 所需的环境，</li>
  <li>定义了一个视图 <code class="highlighter-rouge">MyCustomView</code> ，该视图是用 SQL 查询声明的虚拟表，</li>
  <li>定义了一个用户自定义函数 <code class="highlighter-rouge">myUDF</code>，该函数可以使用类名和两个构造函数参数进行实例化，</li>
  <li>连接到两个 Hive catalogs 并用 <code class="highlighter-rouge">catalog_1</code> 来作为当前目录，用 <code class="highlighter-rouge">mydb1</code> 来作为该目录的当前数据库，</li>
  <li>streaming 模式下用 blink planner 来运行时间特征为 event-time 和并行度为 1 的语句，</li>
  <li>在 <code class="highlighter-rouge">table</code> 结果模式下运行试探性的（exploratory）的查询，</li>
  <li>并通过配置选项对联结（join）重排序和溢出进行一些计划调整。</li>
</ul>

<p>根据使用情况，配置可以被拆分为多个文件。因此，一般情况下（用 <code class="highlighter-rouge">--defaults</code> 指定<em>默认环境配置文件</em>）以及基于每个会话（用 <code class="highlighter-rouge">--environment</code> 指定<em>会话环境配置文件</em>）来创建环境配置文件。每个 CLI 会话均会被属于 session 属性的默认属性初始化。例如，默认环境配置文件可以指定在每个会话中都可用于查询的所有 table source，而会话环境配置文件仅声明特定的状态保留时间和并行性。启动 CLI 应用程序时，默认环境配置文件和会话环境配置文件都可以被指定。如果未指定默认环境配置文件，则 SQL 客户端将在 Flink 的配置目录中搜索 <code class="highlighter-rouge">./conf/sql-client-defaults.yaml</code>。</p>

<p><span class="label label-danger">注意</span> 在 CLI 会话中设置的属性（如 <code class="highlighter-rouge">SET</code> 命令）优先级最高：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">CLI commands &gt; session environment file &gt; defaults environment file</code></pre></figure>

<h4 id="重启策略restart-strategies">重启策略（Restart Strategies）</h4>

<p>重启策略控制 Flink 作业失败时的重启方式。与 Flink 集群的<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html#restart-strategies">全局重启策略</a>相似，更细精度的重启配置可以在环境配置文件中声明。</p>

<p>Flink 支持以下策略：</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">execution</span><span class="pi">:</span>
  <span class="c1"># 退回到 flink-conf.yaml 中定义的全局策略</span>
  <span class="na">restart-strategy</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">fallback</span>

  <span class="c1"># 作业直接失败并且不尝试重启</span>
  <span class="na">restart-strategy</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">none</span>

  <span class="c1"># 最多重启作业的给定次数</span>
  <span class="na">restart-strategy</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">fixed-delay</span>
    <span class="na">attempts</span><span class="pi">:</span> <span class="m">3</span>      <span class="c1"># 作业被宣告失败前的重试次数（默认：Integer.MAX_VALUE）</span>
    <span class="na">delay</span><span class="pi">:</span> <span class="m">10000</span>     <span class="c1"># 重试之间的间隔时间，以毫秒为单位（默认：10 秒）</span>

  <span class="c1"># 只要不超过每个时间间隔的最大故障数就继续尝试</span>
  <span class="na">restart-strategy</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">failure-rate</span>
    <span class="na">max-failures-per-interval</span><span class="pi">:</span> <span class="m">1</span>   <span class="c1"># 每个间隔重试的最大次数（默认：1）</span>
    <span class="na">failure-rate-interval</span><span class="pi">:</span> <span class="m">60000</span>   <span class="c1"># 监测失败率的间隔时间，以毫秒为单位</span>
    <span class="na">delay</span><span class="pi">:</span> <span class="m">10000</span>                   <span class="c1"># 重试之间的间隔时间，以毫秒为单位（默认：10 秒）</span></code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="依赖">依赖</h3>

<p>SQL 客户端不要求用 Maven 或者 SBT 设置 Java 项目。相反，你可以以常规的 JAR 包给集群提交依赖项。你也可以分别（用 <code class="highlighter-rouge">--jar</code>）指定每一个 JAR 包或者（用 <code class="highlighter-rouge">--library</code>）定义整个 library 依赖库。为连接扩展系统（如 Apache Kafka）和相应的数据格式（如 JSON），Flink提供了<strong>开箱即用型 JAR 捆绑包（ready-to-use JAR bundles）</strong>。这些 JAR 包各个发行版都可以从 Maven 中央库中下载到。</p>

<p>提供的 SQL JARs 和使用文档的完整清单可以在<a href="connect.html">连接扩展系统页面</a>中找到。</p>

<p>如下例子展示了从 Apache Kafka 中读取 JSON 文件并作为 table source 的环境配置文件。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">TaxiRides</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">source-table</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
    <span class="na">connector</span><span class="pi">:</span>
      <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">kafka</span>
      <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.11"</span>
      <span class="na">topic</span><span class="pi">:</span> <span class="s">TaxiRides</span>
      <span class="na">startup-mode</span><span class="pi">:</span> <span class="s">earliest-offset</span>
      <span class="na">properties</span><span class="pi">:</span>
        <span class="s">bootstrap.servers</span><span class="pi">:</span> <span class="s">localhost:9092</span>
        <span class="s">group.id</span><span class="pi">:</span> <span class="s">testGroup</span>
    <span class="na">format</span><span class="pi">:</span>
      <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">json</span>
      <span class="na">schema</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ROW&lt;rideId</span><span class="nv"> </span><span class="s">LONG,</span><span class="nv"> </span><span class="s">lon</span><span class="nv"> </span><span class="s">FLOAT,</span><span class="nv"> </span><span class="s">lat</span><span class="nv"> </span><span class="s">FLOAT,</span><span class="nv"> </span><span class="s">rideTime</span><span class="nv"> </span><span class="s">TIMESTAMP&gt;"</span>
    <span class="na">schema</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rideId</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">BIGINT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">lon</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">FLOAT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">lat</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">FLOAT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rowTime</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">TIMESTAMP(3)</span>
        <span class="na">rowtime</span><span class="pi">:</span>
          <span class="na">timestamps</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">from-field"</span>
            <span class="na">from</span><span class="pi">:</span> <span class="s2">"</span><span class="s">rideTime"</span>
          <span class="na">watermarks</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">periodic-bounded"</span>
            <span class="na">delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60000"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">procTime</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">TIMESTAMP(3)</span>
        <span class="na">proctime</span><span class="pi">:</span> <span class="no">true</span></code></pre></figure>

<p><code class="highlighter-rouge">TaxiRide</code> 表的结果格式与绝大多数的 JSON 格式相似。此外，它还添加了 rowtime 属性 <code class="highlighter-rouge">rowTime</code> 和 processing-time 属性 <code class="highlighter-rouge">procTime</code>。</p>

<p><code class="highlighter-rouge">connector</code> 和 <code class="highlighter-rouge">format</code> 都允许定义属性版本（当前版本为 <code class="highlighter-rouge">1</code> ）以便将来向后兼容。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="自定义函数user-defined-functions">自定义函数（User-defined Functions）</h3>
<p>SQL 客户端允许用户创建用户自定义的函数来进行 SQL 查询。当前，这些自定义函数仅限于 Java/Scala 编写的类以及 Python 文件。</p>

<p>为提供 Java/Scala 的自定义函数，你首先需要实现和编译函数类，该函数继承自 <code class="highlighter-rouge">ScalarFunction</code>、 <code class="highlighter-rouge">AggregateFunction</code> 或 <code class="highlighter-rouge">TableFunction</code>（见<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a>）。一个或多个函数可以打包到 SQL 客户端的 JAR 依赖中。</p>

<p>为提供 Python 的自定义函数，你需要编写 Python 函数并且用装饰器 <code class="highlighter-rouge">pyflink.table.udf.udf</code> 或 <code class="highlighter-rouge">pyflink.table.udf.udtf</code> 来装饰（见 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">Python UDFs</a>)）。Python 文件中可以放置一个或多个函数。其Python 文件和相关依赖需要通过在环境配置文件中或命令行选项（见 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html#usage">命令行用法</a>）配置中特别指定（见 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">Python 配置</a>）。</p>

<p>所有函数在被调用之前，必须在环境配置文件中提前声明。<code class="highlighter-rouge">functions</code> 列表中每个函数类都必须指定</p>

<ul>
  <li>用来注册函数的 <code class="highlighter-rouge">name</code>，</li>
  <li>函数的来源 <code class="highlighter-rouge">from</code>（目前仅限于 <code class="highlighter-rouge">class</code>（Java/Scala UDF）或 <code class="highlighter-rouge">python</code>（Python UDF）），</li>
</ul>

<p>Java/Scala UDF 必须指定：</p>
<ul>
  <li>声明了全限定名的函数类 <code class="highlighter-rouge">class</code> 以及用于实例化的 <code class="highlighter-rouge">constructor</code> 参数的可选列表。</li>
</ul>

<p>Python UDF 必须指定：</p>

<ul>
  <li>声明全程名称的 <code class="highlighter-rouge">fully-qualified-name</code>，即函数的 “[module name].[object name]”</li>
</ul>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">functions</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">java_udf</span>               <span class="c1"># required: name of the function</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s">class</span>                  <span class="c1"># required: source of the function</span>
    <span class="na">class</span><span class="pi">:</span> <span class="s">...</span>                   <span class="c1"># required: fully qualified class name of the function</span>
    <span class="na">constructor</span><span class="pi">:</span>                 <span class="c1"># optional: constructor parameters of the function class</span>
      <span class="pi">-</span> <span class="s">...</span>                      <span class="c1"># optional: a literal parameter with implicit type</span>
      <span class="pi">-</span> <span class="na">class</span><span class="pi">:</span> <span class="s">...</span>               <span class="c1"># optional: full class name of the parameter</span>
        <span class="na">constructor</span><span class="pi">:</span>             <span class="c1"># optional: constructor parameters of the parameter's class</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">...</span>            <span class="c1"># optional: type of the literal parameter</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s">...</span>           <span class="c1"># optional: value of the literal parameter</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">python_udf</span>             <span class="c1"># required: name of the function</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s">python</span>                 <span class="c1"># required: source of the function </span>
    <span class="na">fully-qualified-name</span><span class="pi">:</span> <span class="s">...</span>    <span class="c1"># required: fully qualified class name of the function      </span></code></pre></figure>

<p>对于 Java/Scala UDF，要确保函数类指定的构造参数顺序和类型都要严格匹配。</p>

<h4 id="构造函数参数">构造函数参数</h4>

<p>根据用户自定义函数可知，在用到 SQL 语句中之前，有必要将构造参数匹配对应的类型。</p>

<p>如上述示例所示，当声明一个用户自定义函数时，可以使用构造参数来配置相应的类，有以下三种方式：</p>

<p><strong>隐式类型的文本值：</strong>SQL 客户端将自动根据文本推导对应的类型。目前，只支持 <code class="highlighter-rouge">BOOLEAN</code>、<code class="highlighter-rouge">INT</code>、 <code class="highlighter-rouge">DOUBLE</code> 和 <code class="highlighter-rouge">VARCHAR</code> 。</p>

<p>如果自动推导的类型与期望不符（例如，你需要 VARCHAR 类型的 <code class="highlighter-rouge">false</code>），可以改用显式类型。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">-</span> <span class="no">true</span>         <span class="c1"># -&gt; BOOLEAN (case sensitive)</span>
<span class="pi">-</span> <span class="m">42</span>           <span class="c1"># -&gt; INT</span>
<span class="pi">-</span> <span class="m">1234.222</span>     <span class="c1"># -&gt; DOUBLE</span>
<span class="pi">-</span> <span class="s">foo</span>          <span class="c1"># -&gt; VARCHAR</span></code></pre></figure>

<p><strong>显式类型的文本值：</strong>为保证类型安全，需明确声明 <code class="highlighter-rouge">type</code> 和 <code class="highlighter-rouge">value</code> 属性的参数。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">DECIMAL</span>
  <span class="na">value</span><span class="pi">:</span> <span class="s">11111111111111111</span></code></pre></figure>

<p>下表列出支持的 Java 参数类型和与之相对应的 SQL 类型。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Java 类型</th>
      <th style="text-align: left">SQL 类型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.math.BigDecimal</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DECIMAL</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Boolean</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BOOLEAN</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Byte</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">TINYINT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Double</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DOUBLE</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Float</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">REAL</code>, <code class="highlighter-rouge">FLOAT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Integer</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">INTEGER</code>, <code class="highlighter-rouge">INT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Long</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BIGINT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.Short</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">SMALLINT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">java.lang.String</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">VARCHAR</code></td>
    </tr>
  </tbody>
</table>

<p>其他类型 （例如 <code class="highlighter-rouge">TIMESTAMP</code> 和 <code class="highlighter-rouge">ARRAY</code>）、原始类型和 <code class="highlighter-rouge">null</code> 目前还不支持。</p>

<p><strong>（嵌套）类实例：</strong>除了文本值外，还可以通过指定构造参数的 <code class="highlighter-rouge">class</code> 和 <code class="highlighter-rouge">constructor</code> 属性来创建（嵌套）类实例。这个过程可以递归执行，直到最后的构造参数是用文本值来描述的。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="pi">-</span> <span class="na">class</span><span class="pi">:</span> <span class="s">foo.bar.paramClass</span>
  <span class="na">constructor</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">StarryName</span>
    <span class="pi">-</span> <span class="na">class</span><span class="pi">:</span> <span class="s">java.lang.Integer</span>
      <span class="na">constructor</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">class</span><span class="pi">:</span> <span class="s">java.lang.String</span>
          <span class="na">constructor</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">VARCHAR</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s">3</span></code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="catalogs">Catalogs</h2>

<p>Catalogs 可以由 YAML 属性集合定义，并且在 SQL 客户端启动之前自动注册到运行环境中。</p>

<p>用户可以指定在 SQL CLI 中哪些 catalog 要被作为当前的 catalog，以及哪个数据库的 catalog 可以用于当前数据库。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">catalogs</span><span class="pi">:</span>
   <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog_1</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">hive</span>
     <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
     <span class="na">default-database</span><span class="pi">:</span> <span class="s">mydb2</span>
     <span class="na">hive-conf-dir</span><span class="pi">:</span> <span class="s">&lt;path of Hive conf directory&gt;</span>
   <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">catalog_2</span>
     <span class="na">type</span><span class="pi">:</span> <span class="s">hive</span>
     <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
     <span class="na">hive-conf-dir</span><span class="pi">:</span> <span class="s">&lt;path of Hive conf directory&gt;</span>

<span class="na">execution</span><span class="pi">:</span>
   <span class="s">...</span>
   <span class="s">current-catalog</span><span class="pi">:</span> <span class="s">catalog_1</span>
   <span class="na">current-database</span><span class="pi">:</span> <span class="s">mydb1</span></code></pre></figure>

<p>更多关于 catalog 的内容，参考 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a>。</p>

<p><a name="detached-sql-queries"></a></p>

<h2 id="分离的-sql-查询">分离的 SQL 查询</h2>

<p>为定义端到端的 SQL 管道，SQL 的 <code class="highlighter-rouge">INSERT INTO</code> 语句可以向 Flink 集群提交长时间运行的分离查询。查询产生的结果输出到除 SQL 客户端外的扩展系统中。这样可以应对更高的并发和更多的数据。CLI 自身在提交后不对分离查询做任何控制。</p>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">MyTableSink</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">MyTableSource</span></code></pre></figure>

<p>sink <code class="highlighter-rouge">MyTableSink</code> 必须在环境配置文件中声明。查看更多关于 Flink 支持的外部系统及其配置信息，参见 <a href="connect.html">connection page</a>。如下展示 Apache Kafka 的 sink 示例。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyTableSink</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">sink-table</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
    <span class="na">connector</span><span class="pi">:</span>
      <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">kafka</span>
      <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.11"</span>
      <span class="na">topic</span><span class="pi">:</span> <span class="s">OutputTopic</span>
      <span class="na">properties</span><span class="pi">:</span>
        <span class="s">bootstrap.servers</span><span class="pi">:</span> <span class="s">localhost:9092</span>
        <span class="s">group.id</span><span class="pi">:</span> <span class="s">testGroup</span>
    <span class="na">format</span><span class="pi">:</span>
      <span class="na">property-version</span><span class="pi">:</span> <span class="m">1</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">json</span>
      <span class="na">derive-schema</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">schema</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rideId</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">BIGINT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">lon</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">FLOAT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">lat</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">FLOAT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rideTime</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">TIMESTAMP(3)</span></code></pre></figure>

<p>SQL 客户端要确保语句成功提交到集群上。一旦提交查询，CLI 将展示关于 Flink 作业的相关信息。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">[INFO] Table update statement has been successfully submitted to the cluster:
Cluster ID: StandaloneClusterId
Job ID: 6f922fe5cba87406ff23ae4a7bb79044
Web interface: http://localhost:8081</code></pre></figure>

<p><span class="label label-danger">注意</span> 提交后，SQL 客户端不追踪正在运行的 Flink 作业状态。提交后可以关闭 CLI 进程，并且不会影响分离的查询。Flink 的<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">重启策略</a>负责容错。取消查询可以用 Flink 的 web 接口、命令行或 REST API 。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="sql-视图">SQL 视图</h2>

<p>视图是一张虚拟表，允许通过 SQL 查询来定义。视图的定义会被立即解析与验证。然而，提交常规 <code class="highlighter-rouge">INSERT INTO</code> 或 <code class="highlighter-rouge">SELECT</code> 语句后不会立即执行，在访问视图时才会真正执行。</p>

<p>视图可以用<a href="sqlClient.html#environment-files">环境配置文件</a>或者 CLI 会话来定义。</p>

<p>下例展示如何在一个文件里定义多张视图。视图注册的顺序和定义它们的环境配置文件一致。支持诸如 <em>视图 A 依赖视图 B ，视图 B 依赖视图 C</em> 的引用链。</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyTableSource</span>
    <span class="c1"># ...</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyRestrictedView</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">view</span>
    <span class="na">query</span><span class="pi">:</span> <span class="s2">"</span><span class="s">SELECT</span><span class="nv"> </span><span class="s">MyField2</span><span class="nv"> </span><span class="s">FROM</span><span class="nv"> </span><span class="s">MyTableSource"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyComplexView</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">view</span>
    <span class="na">query</span><span class="pi">:</span> <span class="pi">&gt;</span>
      <span class="s">SELECT MyField2 + 42, CAST(MyField1 AS VARCHAR)</span>
      <span class="s">FROM MyTableSource</span>
      <span class="s">WHERE MyField2 &gt; 200</span></code></pre></figure>

<p>相较于 table soruce 和 sink，会话环境配置文件中定义的视图具有最高优先级。</p>

<p>视图还可以在 CLI 会话中用 <code class="highlighter-rouge">CREATE VIEW</code> 语句来创建：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">CREATE VIEW MyNewView AS SELECT MyField2 FROM MyTableSource;</code></pre></figure>

<p>视图能在 CLI 会话中创建，也能用 <code class="highlighter-rouge">DROP VIEW</code> 语句删除：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">DROP VIEW MyNewView;</code></pre></figure>

<p><span class="label label-danger">注意</span> CLI 中视图的定义仅限于上述语法。将来版本会支持定义视图结构以及在表名中加入转义的空格。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="临时表temporal-table">临时表（Temporal Table）</h2>

<p><a href="./streaming/temporal_tables.html">临时表</a>是在变化的历史记录表上的（参数化）视图，该视图在某个特定时间点返回表的内容。这对于在特定的时间戳将一张表的内容联结另一张表是非常有用的。更多信息见<a href="./streaming/joins.html#join-with-a-temporal-table">联结临时表</a>页面。</p>

<p>下例展示如何定义一张临时表 <code class="highlighter-rouge">SourceTemporalTable</code>：</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>

  <span class="c1"># 定义包含对临时表的更新的 table source （或视图）</span>

  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">HistorySource</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">source-table</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
    <span class="na">connector</span><span class="pi">:</span> <span class="c1"># ...</span>
    <span class="na">format</span><span class="pi">:</span> <span class="c1"># ...</span>
    <span class="na">schema</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">integerField</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">INT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">stringField</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">STRING</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rowtimeField</span>
        <span class="na">data-type</span><span class="pi">:</span> <span class="s">TIMESTAMP(3)</span>
        <span class="na">rowtime</span><span class="pi">:</span>
          <span class="na">timestamps</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">from-field</span>
            <span class="na">from</span><span class="pi">:</span> <span class="s">rowtimeField</span>
          <span class="na">watermarks</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">from-source</span>

  <span class="c1"># 在具有时间属性和主键的变化历史记录表上定义临时表</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">SourceTemporalTable</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">temporal-table</span>
    <span class="na">history-table</span><span class="pi">:</span> <span class="s">HistorySource</span>
    <span class="na">primary-key</span><span class="pi">:</span> <span class="s">integerField</span>
    <span class="na">time-attribute</span><span class="pi">:</span> <span class="s">rowtimeField</span>  <span class="c1"># could also be a proctime field</span></code></pre></figure>

<p>如例子中所示，table source，视图和临时表的定义可以相互混合。它们按照在环境配置文件中定义的顺序进行注册。例如，临时表可以引用一个视图，该视图依赖于另一个视图或 table source。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<p><a name="limitations--future"></a></p>

<h2 id="局限与未来">局限与未来</h2>

<p>当前的 SQL 客户端仅支持嵌入式模式。在将来，社区计划提供基于 REST 的 <a href="sqlClient.html#limitations--future">SQL 客户端网关（Gateway）</a> 的功能，详见 <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-24+-+SQL+Client">FLIP-24</a> 和 <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-91%3A+Support+SQL+Client+Gateway">FLIP-91</a>。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      想参与贡献翻译？
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
