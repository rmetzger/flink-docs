<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: Table API</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/zh/dev/table/tableApi.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/local_installation.html">本地模式安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/datastream_api.html">基于 DataStream API 实现欺诈检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/table_api.html">基于 Table API 实现实时报表</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/flink-operations-playground.html">Flink 操作场景</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> 实践练习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/datastream_api.html">DataStream API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/etl.html">数据管道 & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/streaming_analytics.html">流式分析</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/event_driven.html">事件驱动应用</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/fault_tolerance.html">容错处理</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> 概念透析<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/index.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/stateful-stream-processing.html">有状态流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">及时流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/flink-architecture.html">Flink 架构</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/glossary.html">词汇表</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_time.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamps_watermarks.html">生成 Watermark</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamp_extractors.html">内置 Watermark 生成器</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/broadcast_state.html">Broadcast State 模式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/schema_evolution.html">状态数据结构升级</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/user_defined_functions.html">用户自定义 Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">算子<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/windows.html">窗口</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/asyncio.html">异步 I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/side_output.html">旁路输出</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/testing.html">测试</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/experimental.html">实验功能</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/java_lambdas.html">Java Lambda 表达式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/iterations.html">迭代</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/hadoop_compatibility.html">Hadoop 兼容</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/local_execution.html">本地执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/cluster_execution.html">集群执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/examples.html">Batch 示例</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse"class="active">Table API & SQL</a><div class="collapse in" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">概念与通用 API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">流式概念<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表 (Dynamic Table)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">流上的 Join</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">时态表（Temporal Tables）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/match_recognize.html">模式检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html" class="active">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html">查询语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html">CREATE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/drop.html">DROP 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/alter.html">ALTER 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/insert.html">INSERT 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/describe.html">DESCRIBE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/use.html">USE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/show.html">SHOW 语句</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html">系统（内置）函数</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/modules.html">模块</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sqlClient.html">SQL 客户端</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/config.html">配置</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tuning/streaming_aggregation_optimization.html">流式聚合</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse">Python API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/installation.html">环境安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table_api_tutorial.html">Table API 教程</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream_tutorial.html">DataStream API 教程</a></li>
<li><a href="#collapse-103" data-toggle="collapse">Table API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html">Python Table API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/built_in_functions.html">系统（内置）函数</a></li>
<li><a href="#collapse-109" data-toggle="collapse">自定义函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通自定义函数（UDF）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html">PyFlink Table 和 Pandas DataFrame 互转</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_table_api_connectors.html">连接器</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/data_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/operators.html">算子</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/dependency_management.html">依赖管理</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/environment_variables.html">环境变量</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/faq.html">常见问题</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">数据类型以及序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/types_serialization.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/custom_serializers.html">自定义序列化器</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_configuration.html">执行配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/packaging.html">程序打包</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/parallel.html">并行执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_plans.html">执行计划</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">Task 故障恢复</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/migration.html">API 迁移指南</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/cep.html">事件处理 (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/guarantees.html">容错保证</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/">概览</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_dialect.html">Hive 方言</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_functions.html">Hive 函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/downloads.html">下载</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/">概览</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/local.html">本地集群</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/config.html">配置参数</a></li>
<li><a href="#collapse-213" data-toggle="collapse">内存配置<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup.html">配置 Flink 进程的内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_tm.html">配置 TaskManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_jobmanager.html">配置 JobManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_tuning.html">调优指南</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_trouble.html">常见问题</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_migration.html">升级指南</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">文件系统<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/common.html">通用配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/oss.html">阿里云 OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/azure.html">Azure Blob 存储</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-ssl.html">SSL 设置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/external_resources.html">扩展资源</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/logging.html">日志</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/large_state_tuning.html">大状态与 Checkpoint 调优</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_event_time.html">调试窗口与事件时间</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_classloading.html">调试类加载</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/application_profiling.html">应用程序分析</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/checkpoint_monitoring.html">监控 Checkpoint</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/back_pressure.html">监控反压</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/upgrading.html">升级应用程序和 Flink 版本</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/production_ready.html">生产就绪情况核对清单</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink 开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/ide_setup.html">导入 Flink 到 IDE 中</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/building.html">从源码构建 Flink</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> 内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/job_scheduling.html">作业调度</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/task_lifecycle.html">Task 生命周期</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/filesystems.html">文件系统</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">选择文档版本<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/table/tableApi.html">
      <button type="submit" class="btn btn-default">English</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">Table API & SQL</a></li>
  
    <li class="active">Table API</li>
</ol>

<h1>Table API</h1>




<p>The Table API is a unified, relational API for stream and batch processing. Table API queries can be run on batch or streaming input without modifications. The Table API is a super set of the SQL language and is specially designed for working with Apache Flink. The Table API is a language-integrated API for Scala, Java and Python. Instead of specifying queries as String values as common with SQL, Table API queries are defined in a language-embedded style in Java, Scala or Python with IDE support like autocompletion and syntax validation.</p>

<p>The Table API shares many concepts and parts of its API with Flink’s SQL integration. Have a look at the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">Common Concepts &amp; API</a> to learn how to register tables or to create a <code class="highlighter-rouge">Table</code> object. The <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">Streaming Concepts</a> pages discuss streaming specific concepts such as dynamic tables and time attributes.</p>

<p>The following examples assume a registered table called <code class="highlighter-rouge">Orders</code> with attributes <code class="highlighter-rouge">(a, b, c, rowtime)</code>. The <code class="highlighter-rouge">rowtime</code> field is either a logical <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">time attribute</a> in streaming or a regular timestamp field in batch.</p>

<ul id="markdown-toc">
  <li><a href="#overview--examples" id="markdown-toc-overview--examples">Overview &amp; Examples</a></li>
  <li><a href="#operations" id="markdown-toc-operations">Operations</a>    <ul>
      <li><a href="#scan-projection-and-filter" id="markdown-toc-scan-projection-and-filter">Scan, Projection, and Filter</a></li>
      <li><a href="#column-operations" id="markdown-toc-column-operations">Column Operations</a></li>
      <li><a href="#aggregations" id="markdown-toc-aggregations">Aggregations</a></li>
      <li><a href="#joins" id="markdown-toc-joins">Joins</a></li>
      <li><a href="#set-operations" id="markdown-toc-set-operations">Set Operations</a></li>
      <li><a href="#orderby-offset--fetch" id="markdown-toc-orderby-offset--fetch">OrderBy, Offset &amp; Fetch</a></li>
      <li><a href="#insert" id="markdown-toc-insert">Insert</a></li>
      <li><a href="#group-windows" id="markdown-toc-group-windows">Group Windows</a></li>
      <li><a href="#over-windows" id="markdown-toc-over-windows">Over Windows</a></li>
      <li><a href="#row-based-operations" id="markdown-toc-row-based-operations">Row-based Operations</a></li>
    </ul>
  </li>
  <li><a href="#data-types" id="markdown-toc-data-types">Data Types</a></li>
  <li><a href="#expression-syntax" id="markdown-toc-expression-syntax">Expression Syntax</a></li>
</ul>

<h2 id="overview--examples">Overview &amp; Examples</h2>

<p>The Table API is available for Scala, Java and Python. The Scala Table API leverages on Scala expressions, the Java Table API supports both Expression DSL and strings which are parsed and converted into equivalent expressions, the Python Table API currently only supports strings which are parsed and converted into equivalent expressions.</p>

<p>The following example shows the differences between the Scala, Java and Python Table API. The table program is executed in a batch environment. It scans the <code class="highlighter-rouge">Orders</code> table, groups by field <code class="highlighter-rouge">a</code>, and counts the resulting rows per group.</p>

<div class="codetabs">
  <div data-lang="java">

    <p>The Java Table API is enabled by importing <code class="highlighter-rouge">org.apache.flink.table.api.java.*</code>. The following example shows how a Java Table API program is constructed and how expressions are specified as strings.
For the Expression DSL it is also necessary to import static <code class="highlighter-rouge">org.apache.flink.table.api.Expressions.*</code></p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.flink.table.api.*</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">flink</span><span class="o">.</span><span class="na">table</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Expressions</span><span class="o">.*</span>

<span class="c1">// environment configuration</span>
<span class="nc">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="nc">BatchTableEnvironment</span> <span class="n">tEnv</span> <span class="o">=</span> <span class="nc">BatchTableEnvironment</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register Orders table in table environment</span>
<span class="c1">// ...</span>

<span class="c1">// specify table program</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span> <span class="c1">// schema (a, b, c, rowtime)</span>

<span class="nc">Table</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">orders</span>
        <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">count</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"cnt"</span><span class="o">));</span>

<span class="c1">// conversion to DataSet</span>
<span class="nc">DataSet</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">toDataSet</span><span class="o">(</span><span class="n">counts</span><span class="o">,</span> <span class="nc">Row</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">result</span><span class="o">.</span><span class="na">print</span><span class="o">();</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <p>The Scala Table API is enabled by importing <code class="highlighter-rouge">org.apache.flink.table.api._</code>, <code class="highlighter-rouge">org.apache.flink.api.scala._</code>, and <code class="highlighter-rouge">org.apache.flink.table.api.bridge.scala._</code> (for bridging to/from DataStream).</p>

    <p>The following example shows how a Scala Table API program is constructed. Table fields are referenced using Scala’s String interpolation using a dollar character (<code class="highlighter-rouge">$</code>).</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.flink.api.scala._</span>
<span class="k">import</span> <span class="nn">org.apache.flink.table.api._</span>
<span class="k">import</span> <span class="nn">org.apache.flink.table.api.bridge.scala._</span>

<span class="c1">// environment configuration</span>
<span class="k">val</span> <span class="nv">env</span> <span class="k">=</span> <span class="nv">ExecutionEnvironment</span><span class="o">.</span><span class="py">getExecutionEnvironment</span>
<span class="k">val</span> <span class="nv">tEnv</span> <span class="k">=</span> <span class="nv">BatchTableEnvironment</span><span class="o">.</span><span class="py">create</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register Orders table in table environment</span>
<span class="c1">// ...</span>

<span class="c1">// specify table program</span>
<span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span> <span class="c1">// schema (a, b, c, rowtime)</span>

<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="n">orders</span>
               <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">)</span>
               <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">count</span> <span class="n">as</span> <span class="s">"cnt"</span><span class="o">)</span>
               <span class="o">.</span><span class="py">toDataSet</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="c1">// conversion to DataSet</span>
               <span class="o">.</span><span class="py">print</span><span class="o">()</span></code></pre></figure>

  </div>
  <div data-lang="python">

    <p>下面这个例子演示了如何组织一个 Python Table API 程序，以及字符串形式的表达式用法。</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># environment configuration
</span><span class="n">t_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">environment_settings</span><span class="o">=</span><span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">())</span>

<span class="c1"># register Orders table and Result table sink in table environment
</span><span class="n">source_data_path</span> <span class="o">=</span> <span class="s">"/path/to/source/directory/"</span>
<span class="n">result_data_path</span> <span class="o">=</span> <span class="s">"/path/to/result/directory/"</span>
<span class="n">source_ddl</span> <span class="o">=</span> <span class="s">f"""
        create table Orders(
            a VARCHAR,
            b BIGINT,
            c BIGINT,
            rowtime TIMESTAMP(3),
            WATERMARK FOR rowtime AS rowtime - INTERVAL '1' SECOND
        ) with (
            'connector' = 'filesystem',
            'format' = 'csv',
            'path' = '</span><span class="si">{</span><span class="n">source_data_path</span><span class="si">}</span><span class="s">'
        )
        """</span>
<span class="n">t_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="n">source_ddl</span><span class="p">)</span>

<span class="n">sink_ddl</span> <span class="o">=</span> <span class="s">f"""
    create table `Result`(
        a VARCHAR,
        cnt BIGINT
    ) with (
        'connector' = 'filesystem',
        'format' = 'csv',
        'path' = '</span><span class="si">{</span><span class="n">result_data_path</span><span class="si">}</span><span class="s">'
    )
    """</span>
<span class="n">t_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="n">sink_ddl</span><span class="p">)</span>

<span class="c1"># specify table program
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>  <span class="c1"># schema (a, b, c, rowtime)
</span>
<span class="n">orders</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="s">"a"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">count</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'cnt'</span><span class="p">)).</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"result"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

  </div>
</div>

<p>The next example shows a more complex Table API program. The program scans again the <code class="highlighter-rouge">Orders</code> table. It filters null values, normalizes the field <code class="highlighter-rouge">a</code> of type String, and calculates for each hour and product <code class="highlighter-rouge">a</code> the average billing amount <code class="highlighter-rouge">b</code>.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// environment configuration</span>
<span class="c1">// ...</span>

<span class="c1">// specify table program</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span> <span class="c1">// schema (a, b, c, rowtime)</span>

<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span>
            <span class="n">and</span><span class="o">(</span>
                <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isNotNull</span><span class="o">(),</span>
                <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">isNotNull</span><span class="o">(),</span>
                <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">).</span><span class="na">isNotNull</span><span class="o">()</span>
            <span class="o">))</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">lowerCase</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">hours</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"hourlyWindow"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"hourlyWindow"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"hourlyWindow"</span><span class="o">).</span><span class="na">end</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"hour"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">avg</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"avgBillingAmount"</span><span class="o">));</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// environment configuration</span>
<span class="c1">// ...</span>

<span class="c1">// specify table program</span>
<span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span> <span class="c1">// schema (a, b, c, rowtime)</span>

<span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">orders</span>
        <span class="o">.</span><span class="py">filter</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">isNotNull</span> <span class="o">&amp;&amp;</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">isNotNull</span> <span class="o">&amp;&amp;</span> <span class="n">$</span><span class="s">"c"</span><span class="o">.</span><span class="py">isNotNull</span><span class="o">)</span>
        <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">lowerCase</span><span class="o">()</span> <span class="n">as</span> <span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rowtime"</span><span class="o">)</span>
        <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">1.</span><span class="n">hour</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="s">"hourlyWindow"</span><span class="o">)</span>
        <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"hourlyWindow"</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">)</span>
        <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"hourlyWindow"</span><span class="o">.</span><span class="py">end</span> <span class="n">as</span> <span class="s">"hour"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">avg</span> <span class="n">as</span> <span class="s">"avgBillingAmount"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># specify table program
</span><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span><span class="p">,</span> <span class="n">lit</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>  <span class="c1"># schema (a, b, c, rowtime)
</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">is_not_null</span> <span class="o">&amp;</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">is_not_null</span> <span class="o">&amp;</span> <span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">is_not_null</span><span class="p">)</span> \
               <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">lower_case</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">)</span> \
               <span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">hour</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"hourly_window"</span><span class="p">))</span> \
               <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'hourly_window'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">))</span> \
               <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'hourly_window'</span><span class="p">).</span><span class="n">end</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'hour'</span><span class="p">),</span> <span class="n">b</span><span class="p">.</span><span class="n">avg</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'avg_billing_amount'</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<p>Since the Table API is a unified API for batch and streaming data, both example programs can be executed on batch and streaming inputs without any modification of the table program itself. In both cases, the program produces the same results given that streaming records are not late (see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">Streaming Concepts</a> for details).</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="operations">Operations</h2>

<p>The Table API supports the following operations. Please note that not all operations are available in both batch and streaming yet; they are tagged accordingly.</p>

<h3 id="scan-projection-and-filter">Scan, Projection, and Filter</h3>

<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
  		<td>
        <strong>From</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
  		<td>
        <p>Similar to the FROM clause in a SQL query. Performs a scan of a registered table.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span></code></pre></figure>

      </td>
  	</tr>
  	<tr>
      <td>
            <strong>Values</strong><br />
            <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
          <p>Similar to the VALUES clause in a SQL query. Produces an inline table out of the provided rows.</p>
          <p>You can use a `row(...)` expression to create composite rows:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromValues</span><span class="o">(</span>
   <span class="n">row</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"ABC"</span><span class="o">),</span>
   <span class="n">row</span><span class="o">(</span><span class="mi">2L</span><span class="o">,</span> <span class="s">"ABCDE"</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure>

          <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- f0: BIGINT NOT NULL     // original types INT and BIGINT are generalized to BIGINT
|-- f1: VARCHAR(5) NOT NULL // original types CHAR(3) and CHAR(5) are generalized
                            // to VARCHAR(5). VARCHAR is used instead of CHAR so that
                            // no padding is applied</code></pre></figure>

          <p>The method will derive the types automatically from the input expressions. If types
          at a certain position differ, the method will try to find a common super type for all types. If a common
          super type does not exist, an exception will be thrown.</p> 
          <p>You can also specify the requested type explicitly. It might be helpful for assigning more generic types like  e.g. DECIMAL or naming the columns.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromValues</span><span class="o">(</span>
    <span class="nc">DataTypes</span><span class="o">.</span><span class="na">ROW</span><span class="o">(</span>
        <span class="nc">DataTypes</span><span class="o">.</span><span class="na">FIELD</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="nc">DataTypes</span><span class="o">.</span><span class="na">DECIMAL</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">2</span><span class="o">)),</span>
        <span class="nc">DataTypes</span><span class="o">.</span><span class="na">FIELD</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="nc">DataTypes</span><span class="o">.</span><span class="na">STRING</span><span class="o">())</span>
    <span class="o">),</span>
    <span class="n">row</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"ABC"</span><span class="o">),</span>
    <span class="n">row</span><span class="o">(</span><span class="mi">2L</span><span class="o">,</span> <span class="s">"ABCDE"</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure>

                    <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- id: DECIMAL(10, 2)
|-- name: STRING</code></pre></figure>

      </td>
    </tr>
    <tr>
      <td>
        <strong>Select</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL SELECT statement. Performs a select operation.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">));</span></code></pre></figure>

        <p>You can use star (<code>*</code>) to act as a wild card, selecting all of the columns in the table.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"*"</span><span class="o">));</span></code></pre></figure>

</td>
        </tr>
    <tr>
      <td>
        <strong>As</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Renames fields.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"x, y, z, t"</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Where / Filter</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL WHERE clause. Filters out rows that do not pass the filter predicate.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="s">"red"</span><span class="o">));</span></code></pre></figure>

or

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">mod</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="mi">0</span><span class="o">));</span></code></pre></figure>

      </td>
    </tr>
  </tbody>
</table>

  </div>
  <div data-lang="scala">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
  		<td>
        <strong>From</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
  		<td>
        <p>Similar to the FROM clause in a SQL query. Performs a scan of a registered table.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span></code></pre></figure>

      </td>
  	</tr>
  	<tr>
      <td>
            <strong>Values</strong><br />
            <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
          <p>Similar to the VALUES clause in a SQL query. Produces an inline table out of the provided rows.</p>
          <p>You can use a `row(...)` expression to create composite rows:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="nv">tEnv</span><span class="o">.</span><span class="py">fromValues</span><span class="o">(</span>
   <span class="nf">row</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"ABC"</span><span class="o">),</span>
   <span class="nf">row</span><span class="o">(</span><span class="mi">2L</span><span class="o">,</span> <span class="s">"ABCDE"</span><span class="o">)</span>
<span class="o">)</span></code></pre></figure>

          <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- f0: BIGINT NOT NULL     // original types INT and BIGINT are generalized to BIGINT
|-- f1: VARCHAR(5) NOT NULL // original types CHAR(3) and CHAR(5) are generalized
                            // to VARCHAR(5). VARCHAR is used instead of CHAR so that
                            // no padding is applied</code></pre></figure>

          <p>The method will derive the types automatically from the input expressions. If types
          at a certain position differ, the method will try to find a common super type for all types. If a common
          super type does not exist, an exception will be thrown.</p> 
          <p>You can also specify the requested type explicitly. It might be helpful for assigning more generic types like  e.g. DECIMAL or naming the columns.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="nv">tEnv</span><span class="o">.</span><span class="py">fromValues</span><span class="o">(</span>
    <span class="nv">DataTypes</span><span class="o">.</span><span class="py">ROW</span><span class="o">(</span>
        <span class="nv">DataTypes</span><span class="o">.</span><span class="py">FIELD</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="nv">DataTypes</span><span class="o">.</span><span class="py">DECIMAL</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">2</span><span class="o">)),</span>
        <span class="nv">DataTypes</span><span class="o">.</span><span class="py">FIELD</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="nv">DataTypes</span><span class="o">.</span><span class="py">STRING</span><span class="o">())</span>
    <span class="o">),</span>
    <span class="nf">row</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"ABC"</span><span class="o">),</span>
    <span class="nf">row</span><span class="o">(</span><span class="mi">2L</span><span class="o">,</span> <span class="s">"ABCDE"</span><span class="o">)</span>
<span class="o">)</span></code></pre></figure>

                    <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- id: DECIMAL(10, 2)
|-- name: STRING</code></pre></figure>

      </td>
    </tr>
  	<tr>
      <td>
        <strong>Select</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL SELECT statement. Performs a select operation.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span> <span class="n">as</span> <span class="s">"d"</span><span class="o">)</span></code></pre></figure>

        <p>You can use star (<code>*</code>) to act as a wild card, selecting all of the columns in the table.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"*"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>
    <tr>
      <td>
        <strong>As</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Renames fields.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">).</span><span class="py">as</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">,</span> <span class="s">"z"</span><span class="o">,</span> <span class="s">"t"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Where / Filter</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL WHERE clause. Filters out rows that do not pass the filter predicate.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">filter</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">===</span> <span class="mi">0</span><span class="o">)</span></code></pre></figure>

or

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">where</span><span class="o">(</span><span class="n">$</span><span class="s">"b"</span> <span class="o">===</span> <span class="s">"red"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>
  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
  		<td>
        <strong>FromPath</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
  		<td>
        <p>类似于 SQL 请求中的 FROM 子句，将一个环境中已注册的表转换成 Table 对象。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span></code></pre></figure>

      </td>
  	</tr>
  	<tr>
      <td>
            <strong>FromElements</strong><br />
            <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
          <p>Similar to the VALUES clause in a SQL query. Produces an inline table out of the provided rows.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'ABC'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'ABCDE'</span><span class="p">)])</span></code></pre></figure>

          <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- _1: BIGINT
|-- _2: STRING</code></pre></figure>

          <p>The method will derive the types automatically from the input data. The elements types must be acceptable
          atomic types or acceptable composite types. All elements must be of the same type. If the elements types are
          composite types, the composite types must be strictly equal, and its subtypes must also be acceptable types,
          e.g. if the elements are tuples, the length of the tuples must be equal, the element types of the tuples must
          be equal in order.</p>
          <p>The built-in acceptable atomic element types contains:</p>
          <p>int, long, str, unicode, bool, float, bytearray, datetime.date,
          datetime.time, datetime.datetime, datetime.timedelta, decimal.Decimal</p>
          <p>The built-in acceptable composite element types contains:</p>
          <p>list, tuple, dict, array, pyflink.table.Row</p>
          <p>You can also specify the requested type explicitly. It might be helpful for assigning more generic types
          like  e.g. DECIMAL or naming the columns.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'ABC'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'ABCDE'</span><span class="p">)],</span>
    <span class="n">schema</span><span class="o">=</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">ROW</span><span class="p">([</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">'id'</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">INT</span><span class="p">()),</span>
                          <span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">'name'</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">STRING</span><span class="p">())]))</span>
<span class="p">)</span></code></pre></figure>

                    <p>will produce a Table with a schema as follows:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">root
|-- id: INT
|-- name: STRING</code></pre></figure>

      </td>
    </tr>
    <tr>
      <td>
        <strong>Select</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 请求中的 SELECT 子句，执行一个 select 操作。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'d'</span><span class="p">))</span></code></pre></figure>

        <p>你可以使用星号（<code>*</code>）表示选择表中的所有列。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"*"</span><span class="p">))</span></code></pre></figure>

</td>
        </tr>
    <tr>
      <td>
        <strong>Alias</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>重命名字段。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">"x, y, z, t"</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Where / Filter</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 请求中的 WHERE 子句，过滤掉表中不满足条件的行。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="s">'red'</span><span class="p">)</span></code></pre></figure>

or

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>
  </tbody>
</table>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="column-operations">Column Operations</h3>
<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  <tr>
          <td>
            <strong>AddColumns</strong><br />
            <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
          </td>
          <td>
          <p>Performs a field add operation. It will throw an exception if the added fields already exist.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">addColumns</span><span class="o">(</span><span class="n">concat</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">),</span> <span class="s">"sunny"</span><span class="o">));</span></code></pre></figure>

</td>
        </tr>
        
 <tr>
     <td>
                    <strong>AddOrReplaceColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                  <p>Performs a field add operation. Existing fields will be replaced if the added column name is the same as the existing column name.  Moreover, if the added fields have duplicate field name, then the last one is used. </p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">addOrReplaceColumns</span><span class="o">(</span><span class="n">concat</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">),</span> <span class="s">"sunny"</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"desc"</span><span class="o">));</span></code></pre></figure>

                  </td>
                </tr>
         <tr>
                  <td>
                    <strong>DropColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                  <p>Performs a field drop operation. The field expressions should be field reference expressions, and only existing fields can be dropped.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">dropColumns</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">));</span></code></pre></figure>

                  </td>
                </tr>
         <tr>
                  <td>
                    <strong>RenameColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                  <p>Performs a field rename operation. The field expressions should be alias expressions, and only the existing fields can be renamed.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">renameColumns</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"b2"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"c2"</span><span class="o">));</span></code></pre></figure>

                  </td>
                </tr>
  </tbody>
</table>

  </div>
  <div data-lang="scala">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
     <tr>
          <td>
            <strong>AddColumns</strong><br />
            <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
          </td>
          <td>
            <p>Performs a field add operation. It will throw an exception if the added fields already exist.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">addColumns</span><span class="o">(</span><span class="nf">concat</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">,</span> <span class="s">"Sunny"</span><span class="o">))</span></code></pre></figure>

          </td>
        </tr>
         <tr>
                  <td>
                    <strong>AddOrReplaceColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                     <p>Performs a field add operation. Existing fields will be replaced if the added column name is the same as the existing column name.  Moreover, if the added fields have duplicate field name, then the last one is used. </p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">addOrReplaceColumns</span><span class="o">(</span><span class="nf">concat</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">,</span> <span class="s">"Sunny"</span><span class="o">)</span> <span class="n">as</span> <span class="s">"desc"</span><span class="o">)</span></code></pre></figure>

                  </td>
                </tr>
         <tr>
                  <td>
                    <strong>DropColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                    <p>Performs a field drop operation. The field expressions should be field reference expressions, and only existing fields can be dropped.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">dropColumns</span><span class="o">(</span><span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span></code></pre></figure>

                  </td>
                </tr>
 <tr>
                  <td>
                    <strong>RenameColumns</strong><br />
                    <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
                  </td>
                  <td>
                    <p>Performs a field rename operation. The field expressions should be alias expressions, and only the existing fields can be renamed.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">renameColumns</span><span class="o">(</span><span class="n">$</span><span class="s">"b"</span> <span class="n">as</span> <span class="s">"b2"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span> <span class="n">as</span> <span class="s">"c2"</span><span class="o">)</span></code></pre></figure>

                  </td>
                </tr>                
  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
  <tr>
          <td>
            <strong>AddColumns</strong><br />
            <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
          </td>
          <td>
          <p>执行新增字段操作。如果欲添加字段已经存在，将会抛出异常。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">concat</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">add_columns</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="s">'sunny'</span><span class="p">))</span></code></pre></figure>

</td>
        </tr>
        
 <tr>
     <td>
                    <strong>AddOrReplaceColumns</strong><br />
                    <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
                  </td>
                  <td>
                  <p>执行新增字段操作。如果欲添加字段已经存在，将会替换该字段。如果新增字段列表中有同名字段，取最靠后的为有效字段。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">concat</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">add_or_replace_columns</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="s">'sunny'</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">'desc'</span><span class="p">))</span></code></pre></figure>

                  </td>
                </tr>
         <tr>
                  <td>
                    <strong>DropColumns</strong><br />
                    <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
                  </td>
                  <td>
                  <p>执行删除字段操作。参数必须是字段列表，并且必须是已经存在的字段才能被删除。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">drop_columns</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">)</span></code></pre></figure>

                  </td>
                </tr>
         <tr>
                  <td>
                    <strong>RenameColumns</strong><br />
                    <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
                  </td>
                  <td>
                  <p>执行重命名字段操作。参数必须是字段别名（例：b as b2）列表，并且必须是已经存在的字段才能被重命名。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">rename_columns</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'b2'</span><span class="p">),</span> <span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'c2'</span><span class="p">))</span></code></pre></figure>

                  </td>
                </tr>
  </tbody>
</table>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="aggregations">Aggregations</h3>

<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>GroupBy Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span><br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL GROUP BY clause. Groups the rows on the grouping keys with a following running aggregation operator to aggregate rows group-wise.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">));</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the type of aggregation and the number of distinct grouping keys. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
    	<td>
        <strong>GroupBy Window Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
    	<td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// group by key and window</span>
    <span class="c1">// access window properties and aggregate</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">start</span><span class="o">(),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">end</span><span class="o">(),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">rowtime</span><span class="o">(),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">)</span>
    <span class="o">);</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Over Window Aggregation</strong><br />
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
       <p>Similar to a SQL OVER clause. Over window aggregates are computed for each row, based on a window (range) of preceding and succeeding rows. See the <a href="#over-windows">over windows section</a> for more details.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="c1">// define window</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span>
        <span class="nc">Over</span>
          <span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>
          <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
          <span class="o">.</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_RANGE</span><span class="o">)</span>
          <span class="o">.</span><span class="na">following</span><span class="o">(</span><span class="no">CURRENT_RANGE</span><span class="o">)</span>
          <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
    <span class="c1">// sliding aggregate</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">avg</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">max</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">min</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
    <span class="o">);</span></code></pre></figure>

       <p><b>Note:</b> All aggregates must be defined over the same window, i.e., same partitioning, sorting, and range. Currently, only windows with PRECEDING (UNBOUNDED and bounded) to CURRENT ROW range are supported. Ranges with FOLLOWING are not supported yet. ORDER BY must be specified on a single <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">time attribute</a>.</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span> <br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL DISTINCT aggregation clause such as COUNT(DISTINCT a). Distinct aggregation declares that an aggregation function (built-in or user-defined) is only applied on distinct input values. Distinct can be applied to <b>GroupBy Aggregation</b>, <b>GroupBy Window Aggregation</b> and <b>Over Window Aggregation</b>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="c1">// Distinct aggregation on group by</span>
<span class="nc">Table</span> <span class="n">groupByDistinctResult</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">().</span><span class="na">distinct</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">));</span>
<span class="c1">// Distinct aggregation on time window group by</span>
<span class="nc">Table</span> <span class="n">groupByWindowDistinctResult</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span>
            <span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
            <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">)</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">().</span><span class="na">distinct</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">));</span>
<span class="c1">// Distinct aggregation on over window</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span>
        <span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_RANGE</span><span class="o">)</span>
        <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">avg</span><span class="o">().</span><span class="na">distinct</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">max</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">min</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
    <span class="o">);</span></code></pre></figure>

        <p>User-defined aggregation function can also be used with DISTINCT modifiers. To calculate the aggregate results only for distinct values, simply add the distinct modifier towards the aggregation function. </p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>

<span class="c1">// Use distinct aggregation for user-defined aggregate functions</span>
<span class="n">tEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"myUdagg"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyUdagg</span><span class="o">());</span>
<span class="n">orders</span><span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="s">"users"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"users"</span><span class="o">),</span>
        <span class="n">call</span><span class="o">(</span><span class="s">"myUdagg"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"points"</span><span class="o">)).</span><span class="na">distinct</span><span class="o">().</span><span class="na">as</span><span class="o">(</span><span class="s">"myDistinctResult"</span><span class="o">)</span>
    <span class="o">);</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct fields. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span> <br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL DISTINCT clause. Returns records with distinct value combinations.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="na">distinct</span><span class="o">();</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct fields. Please provide a query configuration with valid retention interval to prevent excessive state size. If state cleaning is enabled, distinct have to emit messages to prevent too early state eviction of downstream operators which makes distinct contains result updating. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
  </tbody>
</table>

  </div>
  <div data-lang="scala">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>

    <tr>
      <td>
        <strong>GroupBy Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span><br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL GROUP BY clause. Groups the rows on the grouping keys with a following running aggregation operator to aggregate rows group-wise.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span><span class="o">().</span><span class="py">as</span><span class="o">(</span><span class="s">"d"</span><span class="o">))</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the type of aggregation and the number of distinct grouping keys. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
    	<td>
        <strong>GroupBy Window Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
    	<td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span> <span class="c1">// group by key and window</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">start</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">end</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">rowtime</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span> <span class="n">as</span> <span class="s">"d"</span><span class="o">)</span> <span class="c1">// access window properties and aggregate</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Over Window Aggregation</strong><br />
        <span class="label label-primary">Streaming</span>
      </td>
    	<td>
       <p>Similar to a SQL OVER clause. Over window aggregates are computed for each row, based on a window (range) of preceding and succeeding rows. See the <a href="#over-windows">over windows section</a> for more details.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="c1">// define window</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span>
        <span class="nc">Over</span>
          <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span>
          <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span>
          <span class="n">preceding</span> <span class="nc">UNBOUNDED_RANGE</span>
          <span class="n">following</span> <span class="nc">CURRENT_RANGE</span>
          <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">avg</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">max</span><span class="o">().</span><span class="py">over</span><span class="o">(</span><span class="n">$</span><span class="s">"w"</span><span class="o">),</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">min</span><span class="o">().</span><span class="py">over</span><span class="o">(</span><span class="n">$</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// sliding aggregate</span></code></pre></figure>

       <p><b>Note:</b> All aggregates must be defined over the same window, i.e., same partitioning, sorting, and range. Currently, only windows with PRECEDING (UNBOUNDED and bounded) to CURRENT ROW range are supported. Ranges with FOLLOWING are not supported yet. ORDER BY must be specified on a single <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">time attribute</a>.</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct Aggregation</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span> <br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL DISTINCT AGGREGATION clause such as COUNT(DISTINCT a). Distinct aggregation declares that an aggregation function (built-in or user-defined) is only applied on distinct input values. Distinct can be applied to <b>GroupBy Aggregation</b>, <b>GroupBy Window Aggregation</b> and <b>Over Window Aggregation</b>.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="c1">// Distinct aggregation on group by</span>
<span class="k">val</span> <span class="nv">groupByDistinctResult</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span><span class="o">.</span><span class="py">distinct</span> <span class="n">as</span> <span class="s">"d"</span><span class="o">)</span>
<span class="c1">// Distinct aggregation on time window group by</span>
<span class="k">val</span> <span class="nv">groupByWindowDistinctResult</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">).</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span><span class="o">.</span><span class="py">distinct</span> <span class="n">as</span> <span class="s">"d"</span><span class="o">)</span>
<span class="c1">// Distinct aggregation on over window</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span>
        <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span>
        <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span>
        <span class="n">preceding</span> <span class="nc">UNBOUNDED_RANGE</span>
        <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">avg</span><span class="o">.</span><span class="py">distinct</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">max</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">min</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span></code></pre></figure>

        <p>User-defined aggregation function can also be used with DISTINCT modifiers. To calculate the aggregate results only for distinct values, simply add the distinct modifier towards the aggregation function. </p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>

<span class="c1">// Use distinct aggregation for user-defined aggregate functions</span>
<span class="k">val</span> <span class="nv">myUdagg</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyUdagg</span><span class="o">();</span>
<span class="nv">orders</span><span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"users"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"users"</span><span class="o">,</span> <span class="nv">myUdagg</span><span class="o">.</span><span class="py">distinct</span><span class="o">(</span><span class="n">$</span><span class="s">"points"</span><span class="o">)</span> <span class="n">as</span> <span class="s">"myDistinctResult"</span><span class="o">);</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct fields. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span> <br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a SQL DISTINCT clause. Returns records with distinct value combinations.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">orders</span><span class="o">.</span><span class="py">distinct</span><span class="o">()</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct fields. Please provide a query configuration with valid retention interval to prevent excessive state size. If state cleaning is enabled, distinct have to emit messages to prevent too early state eviction of downstream operators which makes distinct contains result updating. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>GroupBy Aggregation</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span><br />
        <span class="label label-info">结果持续更新</span>
      </td>
      <td>
        <p>类似于 SQL 的 GROUP BY 子句。将数据按照指定字段进行分组，之后对各组内数据执行聚合操作。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'d'</span><span class="p">))</span></code></pre></figure>

        <p><b>注意：</b> 对于流式查询，计算查询结果所需的状态（state）可能会无限增长，具体情况取决于聚合操作的类型和分组的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>
    <tr>
    	<td>
        <strong>GroupBy Window Aggregation</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
    	<td>
        <p>在一个窗口上分组和聚合数据，可包含其它分组字段。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.window</span> <span class="kn">import</span> <span class="n">Tumble</span>
<span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">lit</span><span class="p">,</span> <span class="n">col</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \ 
               <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">))</span> \
               <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">).</span><span class="n">start</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">).</span><span class="n">end</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'d'</span><span class="p">))</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Over Window Aggregation</strong><br />
        <span class="label label-primary">流处理</span>
      </td>
      <td>
       <p>类似于 SQL 中的 OVER 开窗函数。Over 窗口聚合对每一行都进行一次聚合计算，聚合的对象是以当前行的位置为基准，向前向后取一个区间范围内的所有数据。详情请见 <a href="#over-windows">Over 窗口</a>一节。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.window</span> <span class="kn">import</span> <span class="n">Over</span>
<span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span><span class="p">,</span> <span class="n">UNBOUNDED_RANGE</span><span class="p">,</span> <span class="n">CURRENT_RANGE</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">).</span><span class="n">order_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">)</span>
                            <span class="p">.</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_RANGE</span><span class="p">).</span><span class="n">following</span><span class="p">(</span><span class="n">CURRENT_RANGE</span><span class="p">)</span>
                            <span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
               <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">avg</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)),</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">max</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)),</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">min</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)))</span></code></pre></figure>

       <p><b>注意：</b> 所有的聚合操作必须在同一个窗口上定义，即分组，排序，范围等属性必须一致。目前，窗口区间范围的向前（PRECEDING）取值没有限制，可以为无界（UNBOUNDED），但是向后（FOLLOWING）只支持当前行（CURRENT ROW），其它向后范围取值暂不支持。排序（ORDER BY）属性必须指定单个<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a>。</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct Aggregation</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span> <br />
        <span class="label label-info">结果持续更新</span>
      </td>
      <td>
        <p>类似于 SQL 聚合函数中的的 DISTINCT 关键字比如 COUNT(DISTINCT a)。带有 distinct 标记的聚合函数只会接受不重复的输入，重复输入将被丢弃。这个去重特性可以在<b>分组聚合（GroupBy Aggregation）</b>，<b>分组窗口聚合（GroupBy Window Aggregation）</b>以及<b> Over窗口聚合（Over Window Aggregation）</b>上使用。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span><span class="p">,</span> <span class="n">lit</span><span class="p">,</span> <span class="n">UNBOUNDED_RANGE</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="c1"># Distinct aggregation on group by
</span><span class="n">group_by_distinct_result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> \
                                 <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">distinct</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'d'</span><span class="p">))</span>
<span class="c1"># Distinct aggregation on time window group by
</span><span class="n">group_by_window_distinct_result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">window</span><span class="p">(</span>
    <span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">)).</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">))</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">distinct</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'d'</span><span class="p">))</span>
<span class="c1"># Distinct aggregation on over window
</span><span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span>
                       <span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">)</span>
                       <span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">rowtime</span><span class="p">)</span>
                       <span class="p">.</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_RANGE</span><span class="p">)</span>
                       <span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
                       <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">avg</span><span class="p">.</span><span class="n">distinct</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)),</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">max</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)),</span> <span class="n">orders</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">min</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)))</span></code></pre></figure>

        <p><b>注意：</b> 对于流式查询，计算查询结果所需的状态（state）可能会无限增长，具体情况取决于执行去重判断时参与判断的字段的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Distinct</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span> <br />
        <span class="label label-info">结果持续更新</span>
      </td>
      <td>
        <p>类似于 SQL 中的 DISTINCT 子句。返回去重后的数据。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">distinct</span><span class="p">()</span></code></pre></figure>

        <p><b>注意：</b> 对于流式查询，计算查询结果所需的状态（state）可能会无限增长，具体情况取决于执行去重判断时参与判断的字段的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>
  </tbody>
</table>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="joins">Joins</h3>

<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
      <td>
        <strong>Inner Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL JOIN clause. Joins two tables. Both tables must have distinct field names and at least one equality join predicate must be defined through join operator or using a where or filter operator.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"d, e, f"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">right</span><span class="o">)</span>
    <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">)))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">));</span></code></pre></figure>

<p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>Outer Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to SQL LEFT/RIGHT/FULL OUTER JOIN clauses. Joins two tables. Both tables must have distinct field names and at least one equality join predicate must be defined.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"d, e, f"</span><span class="o">);</span>

<span class="nc">Table</span> <span class="n">leftOuterResult</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">leftOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">)))</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">));</span>
<span class="nc">Table</span> <span class="n">rightOuterResult</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">rightOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">)))</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">));</span>
<span class="nc">Table</span> <span class="n">fullOuterResult</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">fullOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">)))</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">));</span></code></pre></figure>

<p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
      <td><strong>Inner/Outer Interval Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p><b>Note:</b> Interval joins are a subset of regular joins that can be processed in a streaming fashion. Both inner and outer joins are supported.</p>

        <p>An interval join requires at least one equi-join predicate and a join condition that bounds the time on both sides. Such a condition can be defined by two appropriate range predicates (<code>&lt;, &lt;=, &gt;=, &gt;</code>) or a single equality predicate that compares <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">time attributes</a> of the same type (i.e., processing time or event time) of both input tables.</p>
        <p>For example, the following predicates are valid interval join conditions:</p>

        <ul>
          <li><code>ltime === rtime</code></li>
          <li><code>ltime &gt;= rtime &amp;&amp; ltime &lt; rtime + 10.minutes</code></li>
        </ul>


<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"ltime"</span><span class="o">).</span><span class="na">rowtime</span><span class="o">());</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"f"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"rtime"</span><span class="o">).</span><span class="na">rowtime</span><span class="o">()));</span>

<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">right</span><span class="o">)</span>
  <span class="o">.</span><span class="na">where</span><span class="o">(</span>
    <span class="n">and</span><span class="o">(</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"d"</span><span class="o">)),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"ltime"</span><span class="o">).</span><span class="na">isGreaterOrEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rtime"</span><span class="o">).</span><span class="na">minus</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())),</span>
        <span class="err">$</span><span class="o">(</span><span class="s">"ltime"</span><span class="o">).</span><span class="na">isLess</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rtime"</span><span class="o">).</span><span class="na">plus</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">()))</span>
    <span class="o">))</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"e"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"ltime"</span><span class="o">));</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Inner Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
    	<td>
        <p>Joins a table with the results of a table function. Each row of the left (outer) table is joined with all rows produced by the corresponding call of the table function. A row of the left (outer) table is dropped, if its table function call returns an empty result.
        </p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// register User-Defined Table Function</span>
<span class="nc">TableFunction</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">split</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MySplitUDTF</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"split"</span><span class="o">,</span> <span class="n">split</span><span class="o">);</span>

<span class="c1">// join</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">joinLateral</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"split"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"s"</span><span class="o">,</span> <span class="s">"t"</span><span class="o">,</span> <span class="s">"v"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"s"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"t"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"v"</span><span class="o">));</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Left Outer Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Joins a table with the results of a table function. Each row of the left (outer) table is joined with all rows produced by the corresponding call of the table function. If a table function call returns an empty result, the corresponding outer row is preserved and the result padded with null values.</p>
        <p><b>Note:</b> Currently, the predicate of a table function left outer join can only be empty or literal <code>true</code>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// register User-Defined Table Function</span>
<span class="nc">TableFunction</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">split</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MySplitUDTF</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"split"</span><span class="o">,</span> <span class="n">split</span><span class="o">);</span>

<span class="c1">// join</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">leftOuterJoinLateral</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"split"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"s"</span><span class="o">,</span> <span class="s">"t"</span><span class="o">,</span> <span class="s">"v"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"s"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"t"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"v"</span><span class="o">));</span></code></pre></figure>

      </td>
    </tr>
    <tr>
      <td>
        <strong>Join with Temporal Table</strong><br />
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">Temporal tables</a> are tables that track changes over time.</p>
        <p>A <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html#temporal-table-functions">temporal table function</a> provides access to the state of a temporal table at a specific point in time.
        The syntax to join a table with a temporal table function is the same as in <i>Inner Join with Table Function</i>.</p>

        <p>Currently only inner joins with temporal tables are supported.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">ratesHistory</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"RatesHistory"</span><span class="o">);</span>

<span class="c1">// register temporal table function with a time attribute and primary key</span>
<span class="nc">TemporalTableFunction</span> <span class="n">rates</span> <span class="o">=</span> <span class="n">ratesHistory</span><span class="o">.</span><span class="na">createTemporalTableFunction</span><span class="o">(</span>
    <span class="s">"r_proctime"</span><span class="o">,</span>
    <span class="s">"r_currency"</span><span class="o">);</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"rates"</span><span class="o">,</span> <span class="n">rates</span><span class="o">);</span>

<span class="c1">// join with "Orders" based on the time attribute and key</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">joinLateral</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"rates"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"o_proctime"</span><span class="o">)),</span> <span class="err">$</span><span class="o">(</span><span class="s">"o_currency"</span><span class="o">).</span><span class="na">isEqual</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"r_currency"</span><span class="o">)))</span></code></pre></figure>

        <p>For more information please check the more detailed <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">temporal tables concept description</a>.</p>
      </td>
    </tr>

  </tbody>
</table>

  </div>
  <div data-lang="scala">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>

  	<tr>
      <td>
        <strong>Inner Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL JOIN clause. Joins two tables. Both tables must have distinct field names and at least one equality join predicate must be defined through join operator or using a where or filter operator.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"d"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"f"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">join</span><span class="o">(</span><span class="n">right</span><span class="o">).</span><span class="py">where</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"d"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">)</span></code></pre></figure>

<p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
      <td>
        <strong>Outer Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to SQL LEFT/RIGHT/FULL OUTER JOIN clauses. Joins two tables. Both tables must have distinct field names and at least one equality join predicate must be defined.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="n">$</span><span class="s">"d"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"f"</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">leftOuterResult</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">leftOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"d"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">rightOuterResult</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">rightOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"d"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">fullOuterResult</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">fullOuterJoin</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"d"</span><span class="o">).</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">)</span></code></pre></figure>

<p><b>Note:</b> For streaming queries the required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
    <tr>
      <td><strong>Interval Join</strong><br />
        <span class="label label-primary">Batch</span>
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p><b>Note:</b> Interval joins are a subset of regular joins that can be processed in a streaming fashion.</p>

        <p>An interval join requires at least one equi-join predicate and a join condition that bounds the time on both sides. Such a condition can be defined by two appropriate range predicates (<code>&lt;, &lt;=, &gt;=, &gt;</code>) or a single equality predicate that compares <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">time attributes</a> of the same type (i.e., processing time or event time) of both input tables.</p>
        <p>For example, the following predicates are valid interval join conditions:</p>

        <ul>
          <li><code>$"ltime" === $"rtime"</code></li>
          <li><code>$"ltime" &gt;= $"rtime" &amp;&amp; $"ltime" &lt; $"rtime" + 10.minutes</code></li>
        </ul>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">,</span> <span class="n">$</span><span class="s">"ltime"</span><span class="o">.</span><span class="py">rowtime</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"d"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"f"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rtime"</span><span class="o">.</span><span class="py">rowtime</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">join</span><span class="o">(</span><span class="n">right</span><span class="o">)</span>
  <span class="o">.</span><span class="py">where</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"d"</span> <span class="o">&amp;&amp;</span> <span class="n">$</span><span class="s">"ltime"</span> <span class="o">&gt;=</span> <span class="n">$</span><span class="s">"rtime"</span> <span class="o">-</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="o">&amp;&amp;</span> <span class="n">$</span><span class="s">"ltime"</span> <span class="o">&lt;</span> <span class="n">$</span><span class="s">"rtime"</span> <span class="o">+</span> <span class="mf">10.</span><span class="n">minutes</span><span class="o">)</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"ltime"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Inner Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
    	<td>
        <p>Joins a table with the results of a table function. Each row of the left (outer) table is joined with all rows produced by the corresponding call of the table function. A row of the left (outer) table is dropped, if its table function call returns an empty result.
        </p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// instantiate User-Defined Table Function</span>
<span class="k">val</span> <span class="nv">split</span><span class="k">:</span> <span class="kt">TableFunction</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MySplitUDTF</span><span class="o">()</span>

<span class="c1">// join</span>
<span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">table</span>
    <span class="o">.</span><span class="py">joinLateral</span><span class="o">(</span><span class="nf">split</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="s">"s"</span><span class="o">,</span> <span class="s">"t"</span><span class="o">,</span> <span class="s">"v"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"s"</span><span class="o">,</span> <span class="n">$</span><span class="s">"t"</span><span class="o">,</span> <span class="n">$</span><span class="s">"v"</span><span class="o">)</span></code></pre></figure>

        </td>
    </tr>
    <tr>
    	<td>
        <strong>Left Outer Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span></td>
    	<td>
        <p>Joins a table with the results of a table function. Each row of the left (outer) table is joined with all rows produced by the corresponding call of the table function. If a table function call returns an empty result, the corresponding outer row is preserved and the result padded with null values.</p>
        <p><b>Note:</b> Currently, the predicate of a table function left outer join can only be empty or literal <code>true</code>.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// instantiate User-Defined Table Function</span>
<span class="k">val</span> <span class="nv">split</span><span class="k">:</span> <span class="kt">TableFunction</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MySplitUDTF</span><span class="o">()</span>

<span class="c1">// join</span>
<span class="k">val</span> <span class="nv">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">table</span>
    <span class="o">.</span><span class="py">leftOuterJoinLateral</span><span class="o">(</span><span class="nf">split</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="s">"s"</span><span class="o">,</span> <span class="s">"t"</span><span class="o">,</span> <span class="s">"v"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"s"</span><span class="o">,</span> <span class="n">$</span><span class="s">"t"</span><span class="o">,</span> <span class="n">$</span><span class="s">"v"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Join with Temporal Table</strong><br />
        <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">Temporal tables</a> are tables that track their changes over time.</p>
        <p>A <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html#temporal-table-functions">temporal table function</a> provides access to the state of a temporal table at a specific point in time.
        The syntax to join a table with a temporal table function is the same as in <i>Inner Join with Table Function</i>.</p>

        <p>Currently only inner joins with temporal tables are supported.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">ratesHistory</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"RatesHistory"</span><span class="o">)</span>

<span class="c1">// register temporal table function with a time attribute and primary key</span>
<span class="k">val</span> <span class="nv">rates</span> <span class="k">=</span> <span class="nv">ratesHistory</span><span class="o">.</span><span class="py">createTemporalTableFunction</span><span class="o">(</span><span class="n">$</span><span class="s">"r_proctime"</span><span class="o">,</span> <span class="n">$</span><span class="s">"r_currency"</span><span class="o">)</span>

<span class="c1">// join with "Orders" based on the time attribute and key</span>
<span class="k">val</span> <span class="nv">orders</span> <span class="k">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">joinLateral</span><span class="o">(</span><span class="nf">rates</span><span class="o">(</span><span class="n">$</span><span class="s">"o_rowtime"</span><span class="o">),</span> <span class="n">$</span><span class="s">"r_currency"</span> <span class="o">===</span> <span class="n">$</span><span class="s">"o_currency"</span><span class="o">)</span></code></pre></figure>

        <p>For more information please check the more detailed <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">temporal tables concept description</a>.</p>
      </td>
    </tr>

  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
      <td>
        <strong>Inner Join</strong><br />
        <span class="label label-primary">批处理</span>
        <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 JOIN 子句。对两张表执行内连接操作。两张表必须具有不同的字段名称，并且必须在 join 方法或者随后的 where 或 filter 方法中定义至少一个等值连接条件。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'d'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'e'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'f'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">).</span><span class="n">where</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">d</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">e</span><span class="p">)</span></code></pre></figure>

<p><b>注意：</b> 对于流式查询，计算查询结果所需的状态（state）可能会无限增长，具体取决于不重复的输入行的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>Outer Join</strong><br />
        <span class="label label-primary">批处理</span>
        <span class="label label-primary">流处理</span>
        <span class="label label-info">结果持续更新</span>
      </td>
      <td>
        <p>类似于 SQL 的 LEFT/RIGHT/FULL OUTER JOIN 子句。对两张表执行外连接操作。两张表必须具有不同的字段名称，并且必须定义至少一个等值连接条件。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'d'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'e'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'f'</span><span class="p">))</span>

<span class="n">left_outer_result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">left_outer_join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">d</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">e</span><span class="p">)</span>
<span class="n">right_outer_result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">right_outer_join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">d</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">e</span><span class="p">)</span>
<span class="n">full_outer_result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">full_outer_join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">d</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">right</span><span class="p">.</span><span class="n">e</span><span class="p">)</span></code></pre></figure>

<p><b>注意：</b> 对于流式查询，计算查询结果所需的状态（state）可能会无限增长，具体取决于不重复的输入行的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>
    <tr>
      <td><strong>Interval Join</strong><br />
        <span class="label label-primary">批处理</span>
        <span class="label label-primary">流处理</span>
      </td>
      
      <td>
                    <p><b>注意：</b> Interval Join 是所有常规流式数据处理 join 操作中的其中一种场景。</p>               
                    <p>Interval Join 要求至少有一个等值连接条件以及一个用于划定时间间隔的条件。对两条数据流时间的划定可以通过两个范围比较确定一个合适时间区间（<code>&lt;, &lt;=, &gt;=, &gt;</code>），也可以简单的通过对相同<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a>（当前处理时间或事件时间）的时间值进行等值比较确定。</p>
                    <p>如下示例是合法的 Interval Join 条件：</p>
            
                    <ul>
                      <li><code>ltime = rtime</code></li>
                      <li><code>ltime &gt;= rtime &amp;&amp; ltime &lt; rtime + 2.second</code></li>
                    </ul>
            
            
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'rowtime1'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'d'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'e'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'f'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'rowtime2'</span><span class="p">))</span>
  
<span class="n">joined_table</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">).</span><span class="n">where</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span> <span class="o">==</span> <span class="n">right</span><span class="p">.</span><span class="n">d</span> <span class="o">&amp;</span> <span class="n">left</span><span class="p">.</span><span class="n">rowtime1</span> <span class="o">&gt;=</span> <span class="n">right</span><span class="p">.</span><span class="n">rowtime2</span> <span class="o">-</span> <span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">second</span> <span class="o">&amp;</span> <span class="n">left</span><span class="p">.</span><span class="n">rowtime1</span> <span class="o">&lt;=</span> <span class="n">right</span><span class="p">.</span><span class="n">rowtime2</span> <span class="o">+</span> <span class="n">lit</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">seconds</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">joined_table</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">e</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">rowtime1</span><span class="p">)</span>
      </code></pre></figure>

      </td>
      
    </tr>
    <tr>
    	<td>
        <strong>Inner Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
    	<td>
        <p>将一张表与一个表函数的执行结果执行内连接操作。左表的每一行都会进行一次表函数调用，调用将会返回 0 个，1 个或多个结果，再与这些结果执行连接操作。如果一行数据对应的表函数调用返回了一个空的结果集，则这行数据会被丢弃。
        </p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># register User-Defined Table Function
</span><span class="o">@</span><span class="n">udtf</span><span class="p">(</span><span class="n">result_types</span><span class="o">=</span><span class="p">[</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">(),</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">(),</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">()])</span>
<span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="c1"># join
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">joined_table</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">join_lateral</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"s, t, v"</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">joined_table</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">s</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">t</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">v</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>
    <tr>
    	<td>
        <strong>Left Outer Join with Table Function (UDTF)</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>将一张表与一个表函数的执行结果执行左连接操作。左表的每一行都会进行一次表函数调用，调用将会返回 0 个，1 个或多个结果，再与这些结果执行连接操作。如果一行数据对应的表函数调用返回了一个空的结果集，这行数据依然会被保留，对应的右表数值用 null（python为None）填充。</p>
        <p><b>注意：</b>目前，表函数的左连接操作的连接条件（join predicate）只能为空或者为"true"常量。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># register User-Defined Table Function
</span><span class="o">@</span><span class="n">udtf</span><span class="p">(</span><span class="n">result_types</span><span class="o">=</span><span class="p">[</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">(),</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">(),</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">BIGINT</span><span class="p">()])</span>
<span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>

<span class="c1"># join
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">joined_table</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">left_outer_join_lateral</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">c</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"s, t, v"</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">joined_table</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">s</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">t</span><span class="p">,</span> <span class="n">joined_table</span><span class="p">.</span><span class="n">v</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>
    <tr>
      <td>
        <strong>Join with Temporal Table</strong><br />
        <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>

  </tbody>
</table>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="set-operations">Set Operations</h3>

<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
      <td>
        <strong>Union</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL UNION clause. Unions two tables with duplicate records removed. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">union</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>UnionAll</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL UNION ALL clause. Unions two tables. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">unionAll</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Intersect</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL INTERSECT clause. Intersect returns records that exist in both tables. If a record is present one or both tables more than once, it is returned just once, i.e., the resulting table has no duplicate records. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"d, e, f"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">intersect</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>IntersectAll</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL INTERSECT ALL clause. IntersectAll returns records that exist in both tables. If a record is present in both tables more than once, it is returned as many times as it is present in both tables, i.e., the resulting table might have duplicate records. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"d, e, f"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">intersectAll</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Minus</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL EXCEPT clause. Minus returns records from the left table that do not exist in the right table. Duplicate records in the left table are returned exactly once, i.e., duplicates are removed. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">minus</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>MinusAll</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL EXCEPT ALL clause. MinusAll returns the records that do not exist in the right table. A record that is present n times in the left table and m times in the right table is returned (n - m) times, i.e., as many duplicates as are present in the right table are removed. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds1</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds2</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">minusAll</span><span class="o">(</span><span class="n">right</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>In</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL IN clause. In returns true if an expression exists in a given table sub-query. The sub-query table must consist of one column. This column must have the same data type as the expression.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">left</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="na">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">right</span> <span class="o">=</span> <span class="n">ds2</span><span class="o">.</span><span class="na">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="s">"a"</span><span class="o">);</span>

<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">)).</span><span class="na">where</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">in</span><span class="o">(</span><span class="n">right</span><span class="o">));</span></code></pre></figure>


        <p><b>Note:</b> For streaming queries the operation is rewritten in a join and group operation. The required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>
  </tbody>
</table>

  </div>
  <div data-lang="scala">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
      <td>
        <strong>Union</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL UNION clause. Unions two tables with duplicate records removed, both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">union</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>UnionAll</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>

      </td>
      <td>
        <p>Similar to a SQL UNION ALL clause. Unions two tables, both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">unionAll</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Intersect</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL INTERSECT clause. Intersect returns records that exist in both tables. If a record is present in one or both tables more than once, it is returned just once, i.e., the resulting table has no duplicate records. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"f"</span><span class="o">,</span> <span class="n">$</span><span class="s">"g"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">intersect</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>IntersectAll</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL INTERSECT ALL clause. IntersectAll returns records that exist in both tables. If a record is present in both tables more than once, it is returned as many times as it is present in both tables, i.e., the resulting table might have duplicate records. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"e"</span><span class="o">,</span> <span class="n">$</span><span class="s">"f"</span><span class="o">,</span> <span class="n">$</span><span class="s">"g"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">intersectAll</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Minus</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL EXCEPT clause. Minus returns records from the left table that do not exist in the right table. Duplicate records in the left table are returned exactly once, i.e., duplicates are removed. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">minus</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>MinusAll</strong><br />
        <span class="label label-primary">Batch</span>
      </td>
      <td>
        <p>Similar to a SQL EXCEPT ALL clause. MinusAll returns the records that do not exist in the right table. A record that is present n times in the left table and m times in the right table is returned (n - m) times, i.e., as many duplicates as are present in the right table are removed. Both tables must have identical field types.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">minusAll</span><span class="o">(</span><span class="n">right</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>In</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL IN clause. In returns true if an expression exists in a given table sub-query. The sub-query table must consist of one column. This column must have the same data type as the expression.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">left</span> <span class="k">=</span> <span class="nv">ds1</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">right</span> <span class="k">=</span> <span class="nv">ds2</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">left</span><span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">).</span><span class="py">where</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">in</span><span class="o">(</span><span class="n">right</span><span class="o">))</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries the operation is rewritten in a join and group operation. The required state to compute the query result might grow infinitely depending on the number of distinct input rows. Please provide a query configuration with valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>

  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
  	<tr>
      <td>
        <strong>Union</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 UNION 子句。将两张表组合成一张表，这张表拥有二者去除重复后的全部数据。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table.expressions</span> <span class="kn">import</span> <span class="n">col</span>

<span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">union</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>UnionAll</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 UNION ALL 子句。将两张表组合成一张表，这张表拥有二者的全部数据。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">union_all</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Intersect</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 INTERSECT 子句。Intersect 返回在两张表中都存在的数据。如果一个记录在两张表中不止出现一次，则只返回一次，即结果表没有重复记录。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>IntersectAll</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 INTERSECT ALL 子句。IntersectAll 返回在两张表中都存在的数据。如果一个记录在两张表中不止出现一次，则按照它在两张表中都出现的次数返回，即结果表可能包含重复数据。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">intersect_all</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Minus</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 EXCEPT 子句。Minus 返回仅存在于左表，不存在于右表中的数据。左表中的相同数据只会返回一次，即数据会被去重。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">minus</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>MinusAll</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 EXCEPT ALL 子句。MinusAll 返回仅存在于左表，不存在于右表中的数据。如果一条数据在左表中出现了 n 次，在右表中出现了 m 次，最终这条数据将会被返回（n - m）次，即按右表中出现的次数来移除数据。两张表的字段和类型必须完全一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">minus_all</span><span class="p">(</span><span class="n">right</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>In</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 IN 子句。如果 In 左边表达式的值在给定的子查询结果中则返回 true。子查询的结果必须为单列。此列数据类型必须和表达式一致。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">left</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source2"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">))</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">left</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">b</span><span class="p">,</span> <span class="n">left</span><span class="p">.</span><span class="n">c</span><span class="p">).</span><span class="n">where</span><span class="p">(</span><span class="n">left</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">in_</span><span class="p">(</span><span class="n">right</span><span class="p">))</span></code></pre></figure>


        <p><b>注意：</b> 对于流式查询，这个操作会被替换成一个连接操作和一个分组操作。计算查询结果所需的状态（state）可能会无限增长，具体取决于不重复的输入行的数量。你可能需要在查询配置中设置状态保留时间，以防止状态过大。详情请看<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">查询配置</a>。</p>
      </td>
    </tr>
  </tbody>
</table>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="orderby-offset--fetch">OrderBy, Offset &amp; Fetch</h3>

<div class="codetabs">
  <div data-lang="java">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Order By</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL ORDER BY clause. Returns records globally sorted across all parallel partitions. For unbounded tables, this operation requires a sorting on a time attribute or a subsequent fetch operation.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">asc</span><span class="o">()</span><span class="err">"</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Offset &amp; Fetch</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to the SQL OFFSET and FETCH clauses. The offset operation limits a (possibly sorted) result from an offset position. The fetch operation limits a (possibly sorted) result to the first n rows. Usually, the two operations are preceded by an ordering operator. For unbounded tables, a fetch operation is required for an offset operation.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">in</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataSet</span><span class="o">(</span><span class="n">ds</span><span class="o">,</span> <span class="s">"a, b, c"</span><span class="o">);</span>

<span class="c1">// returns the first 5 records from the sorted result</span>
<span class="nc">Table</span> <span class="n">result1</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">asc</span><span class="o">()).</span><span class="na">fetch</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>

<span class="c1">// skips the first 3 records and returns all following records from the sorted result</span>
<span class="nc">Table</span> <span class="n">result2</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">asc</span><span class="o">()).</span><span class="na">offset</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>

<span class="c1">// skips the first 10 records and returns the next 5 records from the sorted result</span>
<span class="nc">Table</span> <span class="n">result3</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">asc</span><span class="o">()).</span><span class="na">offset</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">fetch</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>

  <div data-lang="scala">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Order By</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to a SQL ORDER BY clause. Returns records globally sorted across all parallel partitions. For unbounded tables, this operation requires a sorting on a time attribute or a subsequent fetch operation.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">in</span> <span class="k">=</span> <span class="nv">ds</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="nv">in</span><span class="o">.</span><span class="py">orderBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">asc</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Offset &amp; Fetch</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to the SQL OFFSET and FETCH clauses. The offset operation limits a (possibly sorted) result from an offset position. The fetch operation limits a (possibly sorted) result to the first n rows. Usually, the two operations are preceded by an ordering operator. For unbounded tables, a fetch operation is required for an offset operation.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">in</span> <span class="k">=</span> <span class="nv">ds</span><span class="o">.</span><span class="py">toTable</span><span class="o">(</span><span class="n">tableEnv</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">)</span>

<span class="c1">// returns the first 5 records from the sorted result</span>
<span class="k">val</span> <span class="nv">result1</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">in</span><span class="o">.</span><span class="py">orderBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">asc</span><span class="o">).</span><span class="py">fetch</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>

<span class="c1">// skips the first 3 records and returns all following records from the sorted result</span>
<span class="k">val</span> <span class="nv">result2</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">in</span><span class="o">.</span><span class="py">orderBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">asc</span><span class="o">).</span><span class="py">offset</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>

<span class="c1">// skips the first 10 records and returns the next 5 records from the sorted result</span>
<span class="k">val</span> <span class="nv">result3</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">in</span><span class="o">.</span><span class="py">orderBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">.</span><span class="py">asc</span><span class="o">).</span><span class="py">offset</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="py">fetch</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>
  <div data-lang="python">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Order By</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 ORDER BY 子句。返回包括所有子并发分区内所有数据的全局排序结果。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="ow">in</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>
<span class="n">result</span> <span class="o">=</span> <span class="ow">in</span><span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="ow">in</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">asc</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Offset &amp; Fetch</strong><br />
        <span class="label label-primary">批处理</span>
      </td>
      <td>
        <p>类似于 SQL 的 OFFSET 和 FETCH 子句。Offset 和 Fetch 从已排序的结果中返回指定数量的数据。Offset 和 Fetch 在技术上是 Order By 操作的一部分，因此必须紧跟其后出现。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Source1"</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'b'</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s">'c'</span><span class="p">))</span>

<span class="c1"># returns the first 5 records from the sorted result
</span><span class="n">result1</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">asc</span><span class="p">).</span><span class="n">fetch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># skips the first 3 records and returns all following records from the sorted result
</span><span class="n">result2</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">asc</span><span class="p">).</span><span class="n">offset</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># skips the first 10 records and returns the next 5 records from the sorted result
</span><span class="n">result3</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">asc</span><span class="p">).</span><span class="n">offset</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">fetch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>
</div>

<h3 id="insert">Insert</h3>

<div class="codetabs">
  <div data-lang="java">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Insert Into</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to the `INSERT INTO` clause in a SQL query, the method performs an insertion into a registered output table. The `executeInsert()` method will immediately submit a Flink job which execute the insert operation.</p>

        <p>Output tables must be registered in the TableEnvironment (see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html#connector-tables">Connector tables</a>). Moreover, the schema of the registered table must match the schema of the query.</p>


<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="n">orders</span><span class="o">.</span><span class="na">executeInsert</span><span class="o">(</span><span class="s">"OutOrders"</span><span class="o">);</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>

  <div data-lang="scala">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Insert Into</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Similar to the `INSERT INTO` clause in a SQL query, the method performs an insertion into a registered output table. The `executeInsert()` method will immediately submit a Flink job which execute the insert operation.</p>

        <p>Output tables must be registered in the TableEnvironment (see <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html#connector-tables">Connector tables</a>). Moreover, the schema of the registered table must match the schema of the query.</p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="nv">orders</span><span class="o">.</span><span class="py">executeInsert</span><span class="o">(</span><span class="s">"OutOrders"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>
  <div data-lang="python">

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">操作</th>
      <th class="text-center">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Insert Into</strong><br />
        <span class="label label-primary">批处理</span> <span class="label label-primary">流处理</span>
      </td>
      <td>
        <p>类似于 SQL 请求中的 INSERT INTO 子句。将数据输出到一个已注册的输出表中。`execute_insert` 方法会立即提交一个 Flink 作业，触发插入操作。</p>

        <p>输出表必须先在 TableEnvironment 中注册（详见<a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html#register-a-tablesink">注册一个 TableSink</a>）。此外，注册的表的模式（schema）必须和请求的结果的模式（schema）相匹配。</p>


<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">orders</span> <span class="o">=</span> <span class="n">t_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"Orders"</span><span class="p">)</span>
<span class="n">orders</span><span class="p">.</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"OutOrders"</span><span class="p">)</span></code></pre></figure>

      </td>
    </tr>

  </tbody>
</table>
  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="group-windows">Group Windows</h3>

<p>Group window aggregates group rows into finite groups based on time or row-count intervals and evaluate aggregation functions once per group. For batch tables, windows are a convenient shortcut to group records by time intervals.</p>

<div class="codetabs">
  <div data-lang="java">
    <p>Windows are defined using the <code class="highlighter-rouge">window(GroupWindow w)</code> clause and require an alias, which is specified using the <code class="highlighter-rouge">as</code> clause. In order to group a table by a window, the window alias must be referenced in the <code class="highlighter-rouge">groupBy(...)</code> clause like a regular grouping attribute. 
The following example shows how to define a window aggregation on a table.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">window</span><span class="o">([</span><span class="nc">GroupWindow</span> <span class="n">w</span><span class="o">].</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>  <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>  <span class="c1">// group the table by window w</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">());</span>  <span class="c1">// aggregate</span></code></pre></figure>

  </div>

  <div data-lang="scala">
    <p>Windows are defined using the <code class="highlighter-rouge">window(w: GroupWindow)</code> clause and require an alias, which is specified using the <code class="highlighter-rouge">as</code> clause. In order to group a table by a window, the window alias must be referenced in the <code class="highlighter-rouge">groupBy(...)</code> clause like a regular grouping attribute. 
The following example shows how to define a window aggregation on a table.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">window</span><span class="o">([</span><span class="kt">w:</span> <span class="kt">GroupWindow</span><span class="o">]</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>  <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"w"</span><span class="o">)</span>   <span class="c1">// group the table by window w</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span><span class="o">)</span>  <span class="c1">// aggregate</span></code></pre></figure>

  </div>

  <div data-lang="python">
    <p>Windows are defined using the <code class="highlighter-rouge">window(w: GroupWindow)</code> clause and require an alias, which is specified using the <code class="highlighter-rouge">alias</code> clause. In order to group a table by a window, the window alias must be referenced in the <code class="highlighter-rouge">group_by(...)</code> clause like a regular grouping attribute. 
The following example shows how to define a window aggregation on a table.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># define window with alias w, group the table by window w, then aggregate
</span><span class="n">table</span> <span class="o">=</span> <span class="nb">input</span><span class="p">.</span><span class="n">window</span><span class="p">([</span><span class="n">w</span><span class="p">:</span> <span class="n">GroupWindow</span><span class="p">].</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
             <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)).</span><span class="n">select</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span></code></pre></figure>

  </div>
</div>

<div class="codetabs">
  <div data-lang="java">
    <p>In streaming environments, window aggregates can only be computed in parallel if they group on one or more attributes in addition to the window, i.e., the <code class="highlighter-rouge">groupBy(...)</code> clause references a window alias and at least one additional attribute. A <code class="highlighter-rouge">groupBy(...)</code> clause that only references a window alias (such as in the example above) can only be evaluated by a single, non-parallel task.
The following example shows how to define a window aggregation with additional grouping attributes.</p>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">window</span><span class="o">([</span><span class="nc">GroupWindow</span> <span class="n">w</span><span class="o">].</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>  <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>  <span class="c1">// group the table by attribute a and window w</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">());</span>  <span class="c1">// aggregate</span></code></pre></figure>

  </div>

  <div data-lang="scala">
    <p>In streaming environments, window aggregates can only be computed in parallel if they group on one or more attributes in addition to the window, i.e., the <code class="highlighter-rouge">groupBy(...)</code> clause references a window alias and at least one additional attribute. A <code class="highlighter-rouge">groupBy(...)</code> clause that only references a window alias (such as in the example above) can only be evaluated by a single, non-parallel task.
The following example shows how to define a window aggregation with additional grouping attributes.</p>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">window</span><span class="o">([</span><span class="kt">w:</span> <span class="kt">GroupWindow</span><span class="o">]</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span> <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">)</span>  <span class="c1">// group the table by attribute a and window w</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span><span class="o">)</span>  <span class="c1">// aggregate</span></code></pre></figure>

  </div>

  <div data-lang="python">
    <p>In streaming environments, window aggregates can only be computed in parallel if they group on one or more attributes in addition to the window, i.e., the <code class="highlighter-rouge">group_by(...)</code> clause references a window alias and at least one additional attribute. A <code class="highlighter-rouge">group_by(...)</code> clause that only references a window alias (such as in the example above) can only be evaluated by a single, non-parallel task.
The following example shows how to define a window aggregation with additional grouping attributes.</p>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># define window with alias w, group the table by attribute a and window w,
# then aggregate
</span><span class="n">table</span> <span class="o">=</span> <span class="nb">input</span><span class="p">.</span><span class="n">window</span><span class="p">([</span><span class="n">w</span><span class="p">:</span> <span class="n">GroupWindow</span><span class="p">].</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
             <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">),</span> <span class="nb">input</span><span class="p">.</span><span class="n">a</span><span class="p">).</span><span class="n">select</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span></code></pre></figure>

  </div>
</div>

<p>Window properties such as the start, end, or rowtime timestamp of a time window can be added in the select statement as a property of the window alias as <code class="highlighter-rouge">w.start</code>, <code class="highlighter-rouge">w.end</code>, and <code class="highlighter-rouge">w.rowtime</code>, respectively. The window start and rowtime timestamps are the inclusive lower and upper window boundaries. In contrast, the window end timestamp is the exclusive upper window boundary. For example a tumbling window of 30 minutes that starts at 2pm would have <code class="highlighter-rouge">14:00:00.000</code> as start timestamp, <code class="highlighter-rouge">14:29:59.999</code> as rowtime timestamp, and <code class="highlighter-rouge">14:30:00.000</code> as end timestamp.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">window</span><span class="o">([</span><span class="nc">GroupWindow</span> <span class="n">w</span><span class="o">].</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>  <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">))</span>  <span class="c1">// group the table by attribute a and window w</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">start</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">end</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">rowtime</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">count</span><span class="o">());</span> <span class="c1">// aggregate and add window start, end, and rowtime timestamps</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">window</span><span class="o">([</span><span class="kt">w:</span> <span class="kt">GroupWindow</span><span class="o">]</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>  <span class="c1">// define window with alias w</span>
  <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"a"</span><span class="o">)</span>  <span class="c1">// group the table by attribute a and window w</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">start</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">end</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">rowtime</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">count</span><span class="o">)</span> <span class="c1">// aggregate and add window start, end, and rowtime timestamps</span></code></pre></figure>

  </div>

  <div data-lang="python">

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># define window with alias w, group the table by attribute a and window w,
# then aggregate and add window start, end, and rowtime timestamps
</span><span class="n">table</span> <span class="o">=</span> <span class="nb">input</span><span class="p">.</span><span class="n">window</span><span class="p">([</span><span class="n">w</span><span class="p">:</span> <span class="n">GroupWindow</span><span class="p">].</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
             <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">),</span> <span class="nb">input</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> \
             <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">).</span><span class="n">start</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">).</span><span class="n">end</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">).</span><span class="n">rowtime</span><span class="p">,</span> <span class="nb">input</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">count</span><span class="p">)</span></code></pre></figure>

  </div>
</div>

<p>The <code class="highlighter-rouge">Window</code> parameter defines how rows are mapped to windows. <code class="highlighter-rouge">Window</code> is not an interface that users can implement. Instead, the Table API provides a set of predefined <code class="highlighter-rouge">Window</code> classes with specific semantics, which are translated into underlying <code class="highlighter-rouge">DataStream</code> or <code class="highlighter-rouge">DataSet</code> operations. The supported window definitions are listed below.</p>

<h4 id="tumble-tumbling-windows">Tumble (Tumbling Windows)</h4>

<p>A tumbling window assigns rows to non-overlapping, continuous windows of fixed length. For example, a tumbling window of 5 minutes groups rows in 5 minutes intervals. Tumbling windows can be defined on event-time, processing-time, or on a row-count.</p>

<div class="codetabs">
  <div data-lang="java">
    <p>Tumbling windows are defined by using the <code class="highlighter-rouge">Tumble</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Tumbling Event-time Window</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Tumbling Processing-time Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Tumbling Row-count Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">rowInterval</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span></code></pre></figure>

  </div>

  <div data-lang="scala">
    <p>Tumbling windows are defined by using the <code class="highlighter-rouge">Tumble</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Tumbling Event-time Window</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Tumbling Processing-time Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Tumbling Row-count Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">rows</span> <span class="n">on</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">
    <p>Tumbling windows are defined by using the <code class="highlighter-rouge">Tumble</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>alias</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>group_by()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Tumbling Event-time Window
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Tumbling Processing-time Window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Tumbling Row-count Window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Tumble</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">row_interval</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<h4 id="slide-sliding-windows">Slide (Sliding Windows)</h4>

<p>A sliding window has a fixed size and slides by a specified slide interval. If the slide interval is smaller than the window size, sliding windows are overlapping. Thus, rows can be assigned to multiple windows. For example, a sliding window of 15 minutes size and 5 minute slide interval assigns each row to 3 different windows of 15 minute size, which are evaluated in an interval of 5 minutes. Sliding windows can be defined on event-time, processing-time, or on a row-count.</p>

<div class="codetabs">
  <div data-lang="java">
    <p>Sliding windows are defined by using the <code class="highlighter-rouge">Slide</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length of the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>every</code></td>
      <td>Defines the slide interval, either as time or row-count interval. The slide interval must be of the same type as the size interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Sliding Event-time Window</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Slide</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
            <span class="o">.</span><span class="na">every</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
            <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Sliding Processing-time window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Slide</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
            <span class="o">.</span><span class="na">every</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
            <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Sliding Row-count window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Slide</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">rowInterval</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">every</span><span class="o">(</span><span class="n">rowInterval</span><span class="o">(</span><span class="mi">5</span><span class="o">)).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span></code></pre></figure>

  </div>

  <div data-lang="scala">
    <p>Sliding windows are defined by using the <code class="highlighter-rouge">Slide</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length of the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>every</code></td>
      <td>Defines the slide interval, either as time or row-count interval. The slide interval must be of the same type as the size interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Sliding Event-time Window</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Slide</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">every</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Sliding Processing-time window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Slide</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">every</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Sliding Row-count window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Slide</span> <span class="n">over</span> <span class="mf">10.</span><span class="n">rows</span> <span class="n">every</span> <span class="mf">5.</span><span class="n">rows</span> <span class="n">on</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">
    <p>Sliding windows are defined by using the <code class="highlighter-rouge">Slide</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>over</code></td>
      <td>Defines the length of the window, either as time or row-count interval.</td>
    </tr>
    <tr>
      <td><code>every</code></td>
      <td>Defines the slide interval, either as time or row-count interval. The slide interval must be of the same type as the size interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>alias</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>group_by()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Sliding Event-time Window
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Slide</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">every</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Sliding Processing-time window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Slide</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">every</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Sliding Row-count window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Slide</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">row_interval</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="n">every</span><span class="p">(</span><span class="n">row_interval</span><span class="p">(</span><span class="mi">5</span><span class="p">)).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<h4 id="session-session-windows">Session (Session Windows)</h4>

<p>Session windows do not have a fixed size but their bounds are defined by an interval of inactivity, i.e., a session window is closes if no event appears for a defined gap period. For example a session window with a 30 minute gap starts when a row is observed after 30 minutes inactivity (otherwise the row would be added to an existing window) and is closed if no row is added within 30 minutes. Session windows can work on event-time or processing-time.</p>

<div class="codetabs">
  <div data-lang="java">
    <p>A session window is defined by using the <code class="highlighter-rouge">Session</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>withGap</code></td>
      <td>Defines the gap between two windows as time interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Session Event-time Window</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">withGap</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Session Processing-time Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Session</span><span class="o">.</span><span class="na">withGap</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span></code></pre></figure>

  </div>

  <div data-lang="scala">
    <p>A session window is defined by using the <code class="highlighter-rouge">Session</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>withGap</code></td>
      <td>Defines the gap between two windows as time interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>groupBy()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Session Event-time Window</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Session</span> <span class="n">withGap</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Session Processing-time Window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Session</span> <span class="n">withGap</span> <span class="mf">10.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">
    <p>A session window is defined by using the <code class="highlighter-rouge">Session</code> class as follows:</p>

    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>with_gap</code></td>
      <td>Defines the gap between two windows as time interval.</td>
    </tr>
    <tr>
      <td><code>on</code></td>
      <td>The time attribute to group (time interval) or sort (row count) on. For batch queries this might be any Long or Timestamp attribute. For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>.</td>
    </tr>
    <tr>
      <td><code>alias</code></td>
      <td>Assigns an alias to the window. The alias is used to reference the window in the following <code>group_by()</code> clause and optionally to select window properties such as window start, end, or rowtime timestamps in the <code>select()</code> clause.</td>
    </tr>
  </tbody>
</table>

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Session Event-time Window
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Session</span><span class="p">.</span><span class="n">with_gap</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Session Processing-time Window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">window</span><span class="p">(</span><span class="n">Session</span><span class="p">.</span><span class="n">with_gap</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">on</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="over-windows">Over Windows</h3>

<p>Over window aggregates are known from standard SQL (<code class="highlighter-rouge">OVER</code> clause) and defined in the <code class="highlighter-rouge">SELECT</code> clause of a query. Unlike group windows, which are specified in the <code class="highlighter-rouge">GROUP BY</code> clause, over windows do not collapse rows. Instead over window aggregates compute an aggregate for each input row over a range of its neighboring rows.</p>

<p>Over windows are defined using the <code class="highlighter-rouge">window(w: OverWindow*)</code> clause (using <code class="highlighter-rouge">over_window(*OverWindow)</code> in Python API) and referenced via an alias in the <code class="highlighter-rouge">select()</code> method. The following example shows how to define an over window aggregation on a table.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">window</span><span class="o">([</span><span class="nc">OverWindow</span> <span class="n">w</span><span class="o">].</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>           <span class="c1">// define over window with alias w</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">sum</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)),</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">).</span><span class="na">min</span><span class="o">().</span><span class="na">over</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">)));</span> <span class="c1">// aggregate over the over window w</span></code></pre></figure>

  </div>
  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">window</span><span class="o">([</span><span class="kt">w:</span> <span class="kt">OverWindow</span><span class="o">]</span> <span class="n">as</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span>              <span class="c1">// define over window with alias w</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"b"</span><span class="o">.</span><span class="py">sum</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">,</span> <span class="n">$</span><span class="s">"c"</span><span class="o">.</span><span class="py">min</span> <span class="n">over</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span> <span class="c1">// aggregate over the over window w</span></code></pre></figure>

  </div>
  <div data-lang="python">

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># define over window with alias w and aggregate over the over window w
</span><span class="n">table</span> <span class="o">=</span> <span class="nb">input</span><span class="p">.</span><span class="n">over_window</span><span class="p">([</span><span class="n">w</span><span class="p">:</span> <span class="n">OverWindow</span><span class="p">].</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="nb">input</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="nb">input</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)),</span> <span class="nb">input</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nb">min</span><span class="p">.</span><span class="n">over</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'w'</span><span class="p">)))</span></code></pre></figure>

  </div>
</div>

<p>The <code class="highlighter-rouge">OverWindow</code> defines a range of rows over which aggregates are computed. <code class="highlighter-rouge">OverWindow</code> is not an interface that users can implement. Instead, the Table API provides the <code class="highlighter-rouge">Over</code> class to configure the properties of the over window. Over windows can be defined on event-time or processing-time and on ranges specified as time interval or row-count. The supported over window definitions are exposed as methods on <code class="highlighter-rouge">Over</code> (and other classes) and are listed below:</p>

<div class="codetabs" data-hide-tabs="1">
  <div data-lang="java/scala">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Required</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>partitionBy</code></td>
      <td>Optional</td>
      <td>
        <p>Defines a partitioning of the input on one or more attributes. Each partition is individually sorted and aggregate functions are applied to each partition separately.</p>

        <p><b>Note:</b> In streaming environments, over window aggregates can only be computed in parallel if the window includes a partition by clause. Without <code>partitionBy(...)</code> the stream is processed by a single, non-parallel task.</p>
      </td>
    </tr>
    <tr>
      <td><code>orderBy</code></td>
      <td>Required</td>
      <td>
        <p>Defines the order of rows within each partition and thereby the order in which the aggregate functions are applied to rows.</p>

        <p><b>Note:</b> For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>. Currently, only a single sort attribute is supported.</p>
      </td>
    </tr>
    <tr>
      <td><code>preceding</code></td>
      <td>Optional</td>
      <td>
        <p>Defines the interval of rows that are included in the window and precede the current row. The interval can either be specified as time or row-count interval.</p>

        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html#bounded-over-windows">Bounded over windows</a> are specified with the size of the interval, e.g., <code>10.minutes</code> for a time interval or <code>10.rows</code> for a row-count interval.</p>

        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html#unbounded-over-windows">Unbounded over windows</a> are specified using a constant, i.e., <code>UNBOUNDED_RANGE</code> for a time interval or <code>UNBOUNDED_ROW</code> for a row-count interval. Unbounded over windows start with the first row of a partition.</p>

        <p>If the <code>preceding</code> clause is omitted, <code>UNBOUNDED_RANGE</code> and <code>CURRENT_RANGE</code> are used as the default <code>preceding</code> and <code>following</code> for the window.</p>
      </td>
    </tr>
    <tr>
      <td><code>following</code></td>
      <td>Optional</td>
      <td>
        <p>Defines the window interval of rows that are included in the window and follow the current row. The interval must be specified in the same unit as the preceding interval (time or row-count).</p>

        <p>At the moment, over windows with rows following the current row are not supported. Instead you can specify one of two constants:</p>

        <ul>
          <li><code>CURRENT_ROW</code> sets the upper bound of the window to the current row.</li>
          <li><code>CURRENT_RANGE</code> sets the upper bound of the window to sort key of the current row, i.e., all rows with the same sort key as the current row are included in the window.</li>
        </ul>

        <p>If the <code>following</code> clause is omitted, the upper bound of a time interval window is defined as <code>CURRENT_RANGE</code> and the upper bound of a row-count interval window is defined as <code>CURRENT_ROW</code>.</p>
      </td>
    </tr>
    <tr>
      <td><code>as</code></td>
      <td>Required</td>
      <td>
        <p>Assigns an alias to the over window. The alias is used to reference the over window in the following <code>select()</code> clause.</p>
      </td>
    </tr>
  </tbody>
</table>
  </div>

  <div data-lang="python">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Method</th>
      <th class="text-left">Required</th>
      <th class="text-left">Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td><code>partition_by</code></td>
      <td>Optional</td>
      <td>
        <p>Defines a partitioning of the input on one or more attributes. Each partition is individually sorted and aggregate functions are applied to each partition separately.</p>

        <p><b>Note:</b> In streaming environments, over window aggregates can only be computed in parallel if the window includes a partition by clause. Without <code>partition_by(...)</code> the stream is processed by a single, non-parallel task.</p>
      </td>
    </tr>
    <tr>
      <td><code>order_by</code></td>
      <td>Required</td>
      <td>
        <p>Defines the order of rows within each partition and thereby the order in which the aggregate functions are applied to rows.</p>

        <p><b>Note:</b> For streaming queries this must be a <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">declared event-time or processing-time time attribute</a>. Currently, only a single sort attribute is supported.</p>
      </td>
    </tr>
    <tr>
      <td><code>preceding</code></td>
      <td>Optional</td>
      <td>
        <p>Defines the interval of rows that are included in the window and precede the current row. The interval can either be specified as time or row-count interval.</p>

        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html#bounded-over-windows">Bounded over windows</a> are specified with the size of the interval, e.g., <code>10.minutes</code> for a time interval or <code>10.rows</code> for a row-count interval.</p>

        <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html#unbounded-over-windows">Unbounded over windows</a> are specified using a constant, i.e., <code>UNBOUNDED_RANGE</code> for a time interval or <code>UNBOUNDED_ROW</code> for a row-count interval. Unbounded over windows start with the first row of a partition.</p>

        <p>If the <code>preceding</code> clause is omitted, <code>UNBOUNDED_RANGE</code> and <code>CURRENT_RANGE</code> are used as the default <code>preceding</code> and <code>following</code> for the window.</p>
      </td>
    </tr>
    <tr>
      <td><code>following</code></td>
      <td>Optional</td>
      <td>
        <p>Defines the window interval of rows that are included in the window and follow the current row. The interval must be specified in the same unit as the preceding interval (time or row-count).</p>

        <p>At the moment, over windows with rows following the current row are not supported. Instead you can specify one of two constants:</p>

        <ul>
          <li><code>CURRENT_ROW</code> sets the upper bound of the window to the current row.</li>
          <li><code>CURRENT_RANGE</code> sets the upper bound of the window to sort key of the current row, i.e., all rows with the same sort key as the current row are included in the window.</li>
        </ul>

        <p>If the <code>following</code> clause is omitted, the upper bound of a time interval window is defined as <code>CURRENT_RANGE</code> and the upper bound of a row-count interval window is defined as <code>CURRENT_ROW</code>.</p>
      </td>
    </tr>
    <tr>
      <td><code>alias</code></td>
      <td>Required</td>
      <td>
        <p>Assigns an alias to the over window. The alias is used to reference the over window in the following <code>select()</code> clause.</p>
      </td>
    </tr>
  </tbody>
</table>
  </div>
</div>

<p><strong>Note:</strong> Currently, all aggregation functions in the same <code class="highlighter-rouge">select()</code> call must be computed of the same over window.</p>

<h4 id="unbounded-over-windows">Unbounded Over Windows</h4>
<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Unbounded Event-time over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_RANGE</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Unbounded Processing-time over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">).</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_RANGE</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>

<span class="c1">// Unbounded Event-time Row-count over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_ROW</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span>
 
<span class="c1">// Unbounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="no">UNBOUNDED_ROW</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">));</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Unbounded Event-time over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">preceding</span> <span class="nc">UNBOUNDED_RANGE</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Unbounded Processing-time over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">preceding</span> <span class="nc">UNBOUNDED_RANGE</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Unbounded Event-time Row-count over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">preceding</span> <span class="nc">UNBOUNDED_ROW</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>
 
<span class="c1">// Unbounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">preceding</span> <span class="nc">UNBOUNDED_ROW</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Unbounded Event-time over window (assuming an event-time attribute "rowtime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_RANGE</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Unbounded Processing-time over window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_RANGE</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Unbounded Event-time Row-count over window (assuming an event-time attribute "rowtime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_ROW</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>
 
<span class="c1"># Unbounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">UNBOUNDED_ROW</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<h4 id="bounded-over-windows">Bounded Over Windows</h4>
<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Bounded Event-time over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>

<span class="c1">// Bounded Processing-time over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">minutes</span><span class="o">()).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>

<span class="c1">// Bounded Event-time Row-count over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="n">rowInterval</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span>
 
<span class="c1">// Bounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Over</span><span class="o">.</span><span class="na">partitionBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">orderBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"proctime"</span><span class="o">)).</span><span class="na">preceding</span><span class="o">(</span><span class="n">rowInterval</span><span class="o">(</span><span class="mi">10</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Bounded Event-time over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">preceding</span> <span class="mf">1.</span><span class="n">minutes</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Bounded Processing-time over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">preceding</span> <span class="mf">1.</span><span class="n">minutes</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>

<span class="c1">// Bounded Event-time Row-count over window (assuming an event-time attribute "rowtime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">preceding</span> <span class="mf">10.</span><span class="n">rows</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span>
  
<span class="c1">// Bounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")</span>
<span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Over</span> <span class="n">partitionBy</span> <span class="n">$</span><span class="s">"a"</span> <span class="n">orderBy</span> <span class="n">$</span><span class="s">"proctime"</span> <span class="n">preceding</span> <span class="mf">10.</span><span class="n">rows</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="python">

    <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Bounded Event-time over window (assuming an event-time attribute "rowtime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Bounded Processing-time over window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">minutes</span><span class="p">).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>

<span class="c1"># Bounded Event-time Row-count over window (assuming an event-time attribute "rowtime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'rowtime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">row_interval</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span>
 
<span class="c1"># Bounded Processing-time Row-count over window (assuming a processing-time attribute "proctime")
</span><span class="p">.</span><span class="n">over_window</span><span class="p">(</span><span class="n">Over</span><span class="p">.</span><span class="n">partition_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'a'</span><span class="p">)).</span><span class="n">order_by</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">'proctime'</span><span class="p">)).</span><span class="n">preceding</span><span class="p">(</span><span class="n">row_interval</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="n">alias</span><span class="p">(</span><span class="s">"w"</span><span class="p">))</span></code></pre></figure>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="row-based-operations">Row-based Operations</h3>

<p>The row-based operations generate outputs with multiple columns.</p>
<div class="codetabs">
  <div data-lang="java">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Map</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Performs a map operation with a user-defined scalar function or built-in scalar function. The output will be flattened if the output type is a composite type.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyMapFunction</span> <span class="kd">extends</span> <span class="nc">ScalarFunction</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Row</span> <span class="nf">eval</span><span class="o">(</span><span class="nc">String</span> <span class="n">a</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Row</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s">"pre-"</span> <span class="o">+</span> <span class="n">a</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;?&gt;</span> <span class="n">getResultType</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">signature</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">ROW</span><span class="o">(</span><span class="nc">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">(),</span> <span class="nc">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nc">ScalarFunction</span> <span class="n">func</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyMapFunction</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"func"</span><span class="o">,</span> <span class="n">func</span><span class="o">);</span>

<span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"func"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">))</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatMap</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Performs a flatMap operation with a table function.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFlatMapFunction</span> <span class="kd">extends</span> <span class="nc">TableFunction</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eval</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"#"</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">String</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"#"</span><span class="o">);</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">collect</span><span class="o">(</span><span class="nc">Row</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">length</span><span class="o">()));</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="nf">getResultType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Types</span><span class="o">.</span><span class="na">ROW</span><span class="o">(</span><span class="nc">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">(),</span> <span class="nc">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nc">TableFunction</span> <span class="n">func</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyFlatMapFunction</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"func"</span><span class="o">,</span> <span class="n">func</span><span class="o">);</span>

<span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"func"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"c"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">))</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Performs an aggregate operation with an aggregate function. You have to close the "aggregate" with a select statement and the select statement does not support aggregate functions. The output of aggregate will be flattened if the output type is a composite type.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyMinMaxAcc</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyMinMax</span> <span class="kd">extends</span> <span class="nc">AggregateFunction</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">,</span> <span class="nc">MyMinMaxAcc</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accumulate</span><span class="o">(</span><span class="nc">MyMinMaxAcc</span> <span class="n">acc</span><span class="o">,</span> <span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="n">acc</span><span class="o">.</span><span class="na">min</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">acc</span><span class="o">.</span><span class="na">min</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">acc</span><span class="o">.</span><span class="na">max</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">acc</span><span class="o">.</span><span class="na">max</span> <span class="o">=</span> <span class="n">value</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">MyMinMaxAcc</span> <span class="nf">createAccumulator</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">MyMinMaxAcc</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">resetAccumulator</span><span class="o">(</span><span class="nc">MyMinMaxAcc</span> <span class="n">acc</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">acc</span><span class="o">.</span><span class="na">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">acc</span><span class="o">.</span><span class="na">max</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Row</span> <span class="nf">getValue</span><span class="o">(</span><span class="nc">MyMinMaxAcc</span> <span class="n">acc</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Row</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">min</span><span class="o">,</span> <span class="n">acc</span><span class="o">.</span><span class="na">max</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">TypeInformation</span><span class="o">&lt;</span><span class="nc">Row</span><span class="o">&gt;</span> <span class="nf">getResultType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">RowTypeInfo</span><span class="o">(</span><span class="nc">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">,</span> <span class="nc">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nc">AggregateFunction</span> <span class="n">myAggFunc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyMinMax</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"myAggFunc"</span><span class="o">,</span> <span class="n">myAggFunc</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">aggregate</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"myAggFunc"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"x"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"y"</span><span class="o">))</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Group Window Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys. You have to close the "aggregate" with a select statement. And the select statement does not support "*" or aggregate functions.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">AggregateFunction</span> <span class="n">myAggFunc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyMinMax</span><span class="o">();</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"myAggFunc"</span><span class="o">,</span> <span class="n">myAggFunc</span><span class="o">);</span>

<span class="nc">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">input</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
                  <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
                  <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// group by key and window</span>
    <span class="o">.</span><span class="na">aggregate</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"myAggFunc"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"x"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"y"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">start</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">end</span><span class="o">());</span> <span class="c1">// access window properties and aggregate results</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a <b>GroupBy Aggregation</b>. Groups the rows on the grouping keys with the following running table aggregation operator to aggregate rows group-wise. The difference from an AggregateFunction is that TableAggregateFunction may return 0 or more records for a group. You have to close the "flatAggregate" with a select statement. And the select statement does not support aggregate functions.</p>
        <p>Instead of using <code>emitValue</code> to output results, you can also use the <code>emitUpdateWithRetract</code> method. Different from <code>emitValue</code>, <code>emitUpdateWithRetract</code> is used to emit values that have been updated. This method outputs data incrementally in retract mode, i.e., once there is an update, we have to retract old records before sending new updated ones. The <code>emitUpdateWithRetract</code> method will be used in preference to the <code>emitValue</code> method if both methods are defined in the table aggregate function, because the method is treated to be more efficient than <code>emitValue</code> as it can output values incrementally. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html#table-aggregation-functions">Table Aggregation Functions</a> for details.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**
 * Accumulator for Top2.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Top2Accum</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="n">first</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nc">Integer</span> <span class="n">second</span><span class="o">;</span>
<span class="o">}</span>

<span class="cm">/**
 * The top2 user-defined table aggregate function.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Top2</span> <span class="kd">extends</span> <span class="nc">TableAggregateFunction</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;,</span> <span class="nc">Top2Accum</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Top2Accum</span> <span class="nf">createAccumulator</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Top2Accum</span> <span class="n">acc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Top2Accum</span><span class="o">();</span>
        <span class="n">acc</span><span class="o">.</span><span class="na">first</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">;</span>
        <span class="n">acc</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">acc</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accumulate</span><span class="o">(</span><span class="nc">Top2Accum</span> <span class="n">acc</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">acc</span><span class="o">.</span><span class="na">first</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">acc</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="n">acc</span><span class="o">.</span><span class="na">first</span><span class="o">;</span>
            <span class="n">acc</span><span class="o">.</span><span class="na">first</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">acc</span><span class="o">.</span><span class="na">second</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">acc</span><span class="o">.</span><span class="na">second</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">merge</span><span class="o">(</span><span class="nc">Top2Accum</span> <span class="n">acc</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Iterable</span><span class="o">&lt;</span><span class="nc">Top2Accum</span><span class="o">&gt;</span> <span class="n">iterable</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Top2Accum</span> <span class="n">otherAcc</span> <span class="o">:</span> <span class="n">iterable</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="n">otherAcc</span><span class="o">.</span><span class="na">first</span><span class="o">);</span>
            <span class="n">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="n">otherAcc</span><span class="o">.</span><span class="na">second</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">emitValue</span><span class="o">(</span><span class="nc">Top2Accum</span> <span class="n">acc</span><span class="o">,</span> <span class="nc">Collector</span><span class="o">&lt;</span><span class="nc">Tuple2</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">out</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// emit the value and rank</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">first</span> <span class="o">!=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">first</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">second</span> <span class="o">!=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">MIN_VALUE</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">out</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Tuple2</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">acc</span><span class="o">.</span><span class="na">second</span><span class="o">,</span> <span class="mi">2</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">tEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"top2"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Top2</span><span class="o">());</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">flatAggregate</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"top2"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">)).</span><span class="na">as</span><span class="o">(</span><span class="s">"v"</span><span class="o">,</span> <span class="s">"rank"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"key"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"v"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"rank"</span><span class="o">);</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries, the required state to compute the query result might grow infinitely depending on the type of aggregation and the number of distinct grouping keys. Please provide a query configuration with a valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>


    <tr>
      <td>
        <strong>Group Window FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
      </td>
      <td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys. You have to close the "flatAggregate" with a select statement. And the select statement does not support aggregate functions.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">"top2"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Top2</span><span class="o">());</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">);</span>
<span class="nc">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="nc">Tumble</span><span class="o">.</span><span class="na">over</span><span class="o">(</span><span class="n">lit</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">minutes</span><span class="o">())</span>
                  <span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">))</span>
                  <span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">))</span> <span class="c1">// group by key and window</span>
    <span class="o">.</span><span class="na">flatAggregate</span><span class="o">(</span><span class="n">call</span><span class="o">(</span><span class="s">"top2"</span><span class="o">,</span> <span class="err">$</span><span class="o">(</span><span class="s">"b"</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"v"</span><span class="o">,</span> <span class="s">"rank"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="err">$</span><span class="o">(</span><span class="s">"a"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">start</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">end</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"w"</span><span class="o">).</span><span class="na">rowtime</span><span class="o">(),</span> <span class="err">$</span><span class="o">(</span><span class="s">"v"</span><span class="o">),</span> <span class="err">$</span><span class="o">(</span><span class="s">"rank"</span><span class="o">));</span> <span class="c1">// access window properties and aggregate results</span></code></pre></figure>

      </td>
    </tr>
  </tbody>
</table>
  </div>

  <div data-lang="scala">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Map</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Performs a map operation with a user-defined scalar function or built-in scalar function. The output will be flattened if the output type is a composite type.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">MyMapFunction</span> <span class="k">extends</span> <span class="nc">ScalarFunction</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">eval</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Row</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">Row</span><span class="o">.</span><span class="py">of</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s">"pre-"</span> <span class="o">+</span> <span class="n">a</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">getResultType</span><span class="o">(</span><span class="n">signature</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Class</span><span class="o">[</span><span class="k">_</span><span class="o">]])</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span>
    <span class="nv">Types</span><span class="o">.</span><span class="py">ROW</span><span class="o">(</span><span class="nv">Types</span><span class="o">.</span><span class="py">STRING</span><span class="o">,</span> <span class="nv">Types</span><span class="o">.</span><span class="py">STRING</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">func</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMapFunction</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nf">func</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">)).</span><span class="py">as</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatMap</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Performs a flatMap operation with a table function.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">MyFlatMapFunction</span> <span class="k">extends</span> <span class="nc">TableFunction</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">eval</span><span class="o">(</span><span class="n">str</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">str</span><span class="o">.</span><span class="py">contains</span><span class="o">(</span><span class="s">"#"</span><span class="o">))</span> <span class="o">{</span>
      <span class="nv">str</span><span class="o">.</span><span class="py">split</span><span class="o">(</span><span class="s">"#"</span><span class="o">).</span><span class="py">foreach</span><span class="o">({</span> <span class="n">s</span> <span class="k">=&gt;</span>
        <span class="k">val</span> <span class="nv">row</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Row</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
        <span class="nv">row</span><span class="o">.</span><span class="py">setField</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span>
        <span class="nv">row</span><span class="o">.</span><span class="py">setField</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nv">s</span><span class="o">.</span><span class="py">length</span><span class="o">)</span>
        <span class="nf">collect</span><span class="o">(</span><span class="n">row</span><span class="o">)</span>
      <span class="o">})</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">getResultType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nv">Types</span><span class="o">.</span><span class="py">ROW</span><span class="o">(</span><span class="nv">Types</span><span class="o">.</span><span class="py">STRING</span><span class="o">,</span> <span class="nv">Types</span><span class="o">.</span><span class="py">INT</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">func</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyFlatMapFunction</span>
<span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">flatMap</span><span class="o">(</span><span class="nf">func</span><span class="o">(</span><span class="n">$</span><span class="s">"c"</span><span class="o">)).</span><span class="py">as</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Performs an aggregate operation with an aggregate function. You have to close the "aggregate" with a select statement and the select statement does not support aggregate functions. The output of aggregate will be flattened if the output type is a composite type.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">case</span> <span class="k">class</span> <span class="nc">MyMinMaxAcc</span><span class="o">(</span><span class="k">var</span> <span class="n">min</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="k">var</span> <span class="n">max</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">class</span> <span class="nc">MyMinMax</span> <span class="k">extends</span> <span class="nc">AggregateFunction</span><span class="o">[</span><span class="kt">Row</span>, <span class="kt">MyMinMaxAcc</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">MyMinMaxAcc</span><span class="o">,</span> <span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="nv">acc</span><span class="o">.</span><span class="py">min</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">acc</span><span class="o">.</span><span class="py">min</span> <span class="k">=</span> <span class="n">value</span>
    <span class="o">}</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">&gt;</span> <span class="nv">acc</span><span class="o">.</span><span class="py">max</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">acc</span><span class="o">.</span><span class="py">max</span> <span class="k">=</span> <span class="n">value</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">createAccumulator</span><span class="o">()</span><span class="k">:</span> <span class="kt">MyMinMaxAcc</span> <span class="o">=</span> <span class="nc">MyMinMaxAcc</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span>

  <span class="k">def</span> <span class="nf">resetAccumulator</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">MyMinMaxAcc</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">acc</span><span class="o">.</span><span class="py">min</span> <span class="k">=</span> <span class="mi">0</span>
    <span class="nv">acc</span><span class="o">.</span><span class="py">max</span> <span class="k">=</span> <span class="mi">0</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">getValue</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">MyMinMaxAcc</span><span class="o">)</span><span class="k">:</span> <span class="kt">Row</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">Row</span><span class="o">.</span><span class="py">of</span><span class="o">(</span><span class="nv">Integer</span><span class="o">.</span><span class="py">valueOf</span><span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">min</span><span class="o">),</span> <span class="nv">Integer</span><span class="o">.</span><span class="py">valueOf</span><span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">max</span><span class="o">))</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">getResultType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nc">RowTypeInfo</span><span class="o">(</span><span class="nv">Types</span><span class="o">.</span><span class="py">INT</span><span class="o">,</span> <span class="nv">Types</span><span class="o">.</span><span class="py">INT</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">myAggFunc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMinMax</span>
<span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">)</span>
  <span class="o">.</span><span class="py">aggregate</span><span class="o">(</span><span class="nf">myAggFunc</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">))</span>
  <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">,</span> <span class="n">$</span><span class="s">"x"</span><span class="o">,</span> <span class="n">$</span><span class="s">"y"</span><span class="o">)</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>Group Window Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys. You have to close the "aggregate" with a select statement. And the select statement does not support "*" or aggregate functions.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">myAggFunc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyMinMax</span>
<span class="k">val</span> <span class="nv">table</span> <span class="k">=</span> <span class="n">input</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span> <span class="c1">// group by key and window</span>
    <span class="o">.</span><span class="py">aggregate</span><span class="o">(</span><span class="nf">myAggFunc</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="s">"y"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">,</span> <span class="n">$</span><span class="s">"x"</span><span class="o">,</span> <span class="n">$</span><span class="s">"y"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">start</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">end</span><span class="o">)</span> <span class="c1">// access window properties and aggregate results</span></code></pre></figure>

      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Similar to a <b>GroupBy Aggregation</b>. Groups the rows on the grouping keys with the following running table aggregation operator to aggregate rows group-wise. The difference from an AggregateFunction is that TableAggregateFunction may return 0 or more records for a group. You have to close the "flatAggregate" with a select statement. And the select statement does not support aggregate functions.</p>
        <p>Instead of using <code>emitValue</code> to output results, you can also use the <code>emitUpdateWithRetract</code> method. Different from <code>emitValue</code>, <code>emitUpdateWithRetract</code> is used to emit values that have been updated. This method outputs data incrementally in retract mode, i.e., once there is an update, we have to retract old records before sending new updated ones. The <code>emitUpdateWithRetract</code> method will be used in preference to the <code>emitValue</code> method if both methods are defined in the table aggregate function, because the method is treated to be more efficient than <code>emitValue</code> as it can output values incrementally. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html#table-aggregation-functions">Table Aggregation Functions</a> for details.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">java.lang.</span><span class="o">{</span><span class="nc">Integer</span> <span class="k">=&gt;</span> <span class="nc">JInteger</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">org.apache.flink.table.api.Types</span>
<span class="k">import</span> <span class="nn">org.apache.flink.table.functions.TableAggregateFunction</span>

<span class="cm">/**
 * Accumulator for top2.
 */</span>
<span class="k">class</span> <span class="nc">Top2Accum</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">first</span><span class="k">:</span> <span class="kt">JInteger</span> <span class="o">=</span> <span class="k">_</span>
  <span class="k">var</span> <span class="n">second</span><span class="k">:</span> <span class="kt">JInteger</span> <span class="o">=</span> <span class="k">_</span>
<span class="o">}</span>

<span class="cm">/**
 * The top2 user-defined table aggregate function.
 */</span>
<span class="k">class</span> <span class="nc">Top2</span> <span class="k">extends</span> <span class="nc">TableAggregateFunction</span><span class="o">[</span><span class="kt">JTuple2</span><span class="o">[</span><span class="kt">JInteger</span>, <span class="kt">JInteger</span><span class="o">]</span>, <span class="kt">Top2Accum</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">override</span> <span class="k">def</span> <span class="nf">createAccumulator</span><span class="o">()</span><span class="k">:</span> <span class="kt">Top2Accum</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">acc</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Top2Accum</span>
    <span class="nv">acc</span><span class="o">.</span><span class="py">first</span> <span class="k">=</span> <span class="nv">Int</span><span class="o">.</span><span class="py">MinValue</span>
    <span class="nv">acc</span><span class="o">.</span><span class="py">second</span> <span class="k">=</span> <span class="nv">Int</span><span class="o">.</span><span class="py">MinValue</span>
    <span class="n">acc</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">Top2Accum</span><span class="o">,</span> <span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="o">{</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="nv">acc</span><span class="o">.</span><span class="py">first</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">acc</span><span class="o">.</span><span class="py">second</span> <span class="k">=</span> <span class="nv">acc</span><span class="o">.</span><span class="py">first</span>
      <span class="nv">acc</span><span class="o">.</span><span class="py">first</span> <span class="k">=</span> <span class="n">v</span>
    <span class="o">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="nv">acc</span><span class="o">.</span><span class="py">second</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">acc</span><span class="o">.</span><span class="py">second</span> <span class="k">=</span> <span class="n">v</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">merge</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">Top2Accum</span><span class="o">,</span> <span class="n">its</span><span class="k">:</span> <span class="kt">JIterable</span><span class="o">[</span><span class="kt">Top2Accum</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">iter</span> <span class="k">=</span> <span class="nv">its</span><span class="o">.</span><span class="py">iterator</span><span class="o">()</span>
    <span class="nf">while</span> <span class="o">(</span><span class="nv">iter</span><span class="o">.</span><span class="py">hasNext</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">val</span> <span class="nv">top2</span> <span class="k">=</span> <span class="nv">iter</span><span class="o">.</span><span class="py">next</span><span class="o">()</span>
      <span class="nf">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="nv">top2</span><span class="o">.</span><span class="py">first</span><span class="o">)</span>
      <span class="nf">accumulate</span><span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="nv">top2</span><span class="o">.</span><span class="py">second</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="nf">emitValue</span><span class="o">(</span><span class="n">acc</span><span class="k">:</span> <span class="kt">Top2Accum</span><span class="o">,</span> <span class="n">out</span><span class="k">:</span> <span class="kt">Collector</span><span class="o">[</span><span class="kt">JTuple2</span><span class="o">[</span><span class="kt">JInteger</span>, <span class="kt">JInteger</span><span class="o">]])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// emit the value and rank</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">first</span> <span class="o">!=</span> <span class="nv">Int</span><span class="o">.</span><span class="py">MinValue</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">out</span><span class="o">.</span><span class="py">collect</span><span class="o">(</span><span class="nv">JTuple2</span><span class="o">.</span><span class="py">of</span><span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">first</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
    <span class="o">}</span>
    <span class="nf">if</span> <span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">second</span> <span class="o">!=</span> <span class="nv">Int</span><span class="o">.</span><span class="py">MinValue</span><span class="o">)</span> <span class="o">{</span>
      <span class="nv">out</span><span class="o">.</span><span class="py">collect</span><span class="o">(</span><span class="nv">JTuple2</span><span class="o">.</span><span class="py">of</span><span class="o">(</span><span class="nv">acc</span><span class="o">.</span><span class="py">second</span><span class="o">,</span> <span class="mi">2</span><span class="o">))</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="nv">top2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Top2</span>
<span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">flatAggregate</span><span class="o">(</span><span class="nf">top2</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="n">$</span><span class="s">"v"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rank"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"key"</span><span class="o">,</span> <span class="n">$</span><span class="s">"v"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rank"</span><span class="o">)</span></code></pre></figure>

        <p><b>Note:</b> For streaming queries, the required state to compute the query result might grow infinitely depending on the type of aggregation and the number of distinct grouping keys. Please provide a query configuration with a valid retention interval to prevent excessive state size. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a> for details.</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>Group Window FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
      </td>
      <td>
        <p>Groups and aggregates a table on a <a href="#group-windows">group window</a> and possibly one or more grouping keys. You have to close the "flatAggregate" with a select statement. And the select statement does not support aggregate functions.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">top2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Top2</span>
<span class="k">val</span> <span class="nv">orders</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="nv">tableEnv</span><span class="o">.</span><span class="py">from</span><span class="o">(</span><span class="s">"Orders"</span><span class="o">)</span>
<span class="k">val</span> <span class="nv">result</span> <span class="k">=</span> <span class="n">orders</span>
    <span class="o">.</span><span class="py">window</span><span class="o">(</span><span class="nc">Tumble</span> <span class="n">over</span> <span class="mf">5.</span><span class="n">minutes</span> <span class="n">on</span> <span class="n">$</span><span class="s">"rowtime"</span> <span class="n">as</span> <span class="s">"w"</span><span class="o">)</span> <span class="c1">// define window</span>
    <span class="o">.</span><span class="py">groupBy</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">)</span> <span class="c1">// group by key and window</span>
    <span class="o">.</span><span class="py">flatAggregate</span><span class="o">(</span><span class="nf">top2</span><span class="o">(</span><span class="n">$</span><span class="s">"b"</span><span class="o">)</span> <span class="nf">as</span> <span class="o">(</span><span class="n">$</span><span class="s">"v"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rank"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">select</span><span class="o">(</span><span class="n">$</span><span class="s">"a"</span><span class="o">,</span> <span class="nv">w</span><span class="o">.</span><span class="py">start</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">end</span><span class="o">,</span> <span class="n">$</span><span class="s">"w"</span><span class="o">.</span><span class="py">rowtime</span><span class="o">,</span> <span class="n">$</span><span class="s">"v"</span><span class="o">,</span> <span class="n">$</span><span class="s">"rank"</span><span class="o">)</span> <span class="c1">// access window properties and aggregate results</span></code></pre></figure>

      </td>
    </tr>
  </tbody>
</table>
  </div>
  <div data-lang="python">
    <table class="table table-bordered">
  <thead>
    <tr>
      <th class="text-left" style="width: 20%">Operators</th>
      <th class="text-center">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <strong>Map</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatMap</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>Group Window Aggregate</strong><br />
        <span class="label label-primary">Batch</span> <span class="label label-primary">Streaming</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>

    <tr>
      <td>
        <strong>FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
        <span class="label label-info">Result Updating</span>
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>


    <tr>
      <td>
        <strong>Group Window FlatAggregate</strong><br />
        <span class="label label-primary">Streaming</span><br />
      </td>
      <td>
        <p>Python Table API 暂不支持。</p>
      </td>
    </tr>
  </tbody>
</table>
  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="data-types">Data Types</h2>

<p>Please see the dedicated page about <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">data types</a>.</p>

<p>Generic types and (nested) composite types (e.g., POJOs, tuples, rows, Scala case classes) can be fields of a row as well.</p>

<p>Fields of composite types with arbitrary nesting can be accessed with <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html#value-access-functions">value access functions</a>.</p>

<p>Generic types are treated as a black box and can be passed on or processed by <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">user-defined functions</a>.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="expression-syntax">Expression Syntax</h2>

<p>Some of the operators in previous sections expect one or more expressions. Expressions can be specified using an embedded Scala DSL or as Strings. Please refer to the examples above to learn how expressions can be specified.</p>

<p>This is the EBNF grammar for expressions:</p>

<figure class="highlight"><pre><code class="language-ebnf" data-lang="ebnf">expressionList = expression , { "," , expression } ;

expression = overConstant | alias ;

alias = logic | ( logic , "as" , fieldReference ) | ( logic , "as" , "(" , fieldReference , { "," , fieldReference } , ")" ) ;

logic = comparison , [ ( "&amp;&amp;" | "||" ) , comparison ] ;

comparison = term , [ ( "=" | "==" | "===" | "!=" | "!==" | "&gt;" | "&gt;=" | "&lt;" | "&lt;=" ) , term ] ;

term = product , [ ( "+" | "-" ) , product ] ;

product = unary , [ ( "*" | "/" | "%") , unary ] ;

unary = [ "!" | "-" | "+" ] , composite ;

composite = over | suffixed | nullLiteral | prefixed | atom ;

suffixed = interval | suffixAs | suffixCast | suffixIf | suffixDistinct | suffixFunctionCall | timeIndicator ;

prefixed = prefixAs | prefixCast | prefixIf | prefixDistinct | prefixFunctionCall ;

interval = timeInterval | rowInterval ;

timeInterval = composite , "." , ("year" | "years" | "quarter" | "quarters" | "month" | "months" | "week" | "weeks" | "day" | "days" | "hour" | "hours" | "minute" | "minutes" | "second" | "seconds" | "milli" | "millis") ;

rowInterval = composite , "." , "rows" ;

suffixCast = composite , ".cast(" , dataType , ")" ;

prefixCast = "cast(" , expression , dataType , ")" ;

dataType = "BYTE" | "SHORT" | "INT" | "LONG" | "FLOAT" | "DOUBLE" | "BOOLEAN" | "STRING" | "DECIMAL" | "SQL_DATE" | "SQL_TIME" | "SQL_TIMESTAMP" | "INTERVAL_MONTHS" | "INTERVAL_MILLIS" | ( "MAP" , "(" , dataType , "," , dataType , ")" ) | ( "PRIMITIVE_ARRAY" , "(" , dataType , ")" ) | ( "OBJECT_ARRAY" , "(" , dataType , ")" ) ;

suffixAs = composite , ".as(" , fieldReference , ")" ;

prefixAs = "as(" , expression, fieldReference , ")" ;

suffixIf = composite , ".?(" , expression , "," , expression , ")" ;

prefixIf = "?(" , expression , "," , expression , "," , expression , ")" ;

suffixDistinct = composite , "distinct.()" ;

prefixDistinct = functionIdentifier , ".distinct" , [ "(" , [ expression , { "," , expression } ] , ")" ] ;

suffixFunctionCall = composite , "." , functionIdentifier , [ "(" , [ expression , { "," , expression } ] , ")" ] ;

prefixFunctionCall = functionIdentifier , [ "(" , [ expression , { "," , expression } ] , ")" ] ;

atom = ( "(" , expression , ")" ) | literal | fieldReference ;

fieldReference = "*" | identifier ;

nullLiteral = "nullOf(" , dataType , ")" ;

timeIntervalUnit = "YEAR" | "YEAR_TO_MONTH" | "MONTH" | "QUARTER" | "WEEK" | "DAY" | "DAY_TO_HOUR" | "DAY_TO_MINUTE" | "DAY_TO_SECOND" | "HOUR" | "HOUR_TO_MINUTE" | "HOUR_TO_SECOND" | "MINUTE" | "MINUTE_TO_SECOND" | "SECOND" ;

timePointUnit = "YEAR" | "MONTH" | "DAY" | "HOUR" | "MINUTE" | "SECOND" | "QUARTER" | "WEEK" | "MILLISECOND" | "MICROSECOND" ;

over = composite , "over" , fieldReference ;

overConstant = "current_row" | "current_range" | "unbounded_row" | "unbounded_row" ;

timeIndicator = fieldReference , "." , ( "proctime" | "rowtime" ) ;</code></pre></figure>

<p><strong>Literals:</strong> Here, <code class="highlighter-rouge">literal</code> is a valid Java literal. String literals can be specified using single or double quotes. Duplicate the quote for escaping (e.g. <code class="highlighter-rouge">'It''s me.'</code> or <code class="highlighter-rouge">"I ""like"" dogs."</code>).</p>

<p><strong>Null literals:</strong> Null literals must have a type attached. Use <code class="highlighter-rouge">nullOf(type)</code> (e.g. <code class="highlighter-rouge">nullOf(INT)</code>) for creating a null value.</p>

<p><strong>Field references:</strong> The <code class="highlighter-rouge">fieldReference</code> specifies a column in the data (or all columns if <code class="highlighter-rouge">*</code> is used), and <code class="highlighter-rouge">functionIdentifier</code> specifies a supported scalar function. The column names and function names follow Java identifier syntax.</p>

<p><strong>Function calls:</strong> Expressions specified as strings can also use prefix notation instead of suffix notation to call operators and functions.</p>

<p><strong>Decimals:</strong> If working with exact numeric values or large decimals is required, the Table API also supports Java’s BigDecimal type. In the Scala Table API decimals can be defined by <code class="highlighter-rouge">BigDecimal("123456")</code> and in Java by appending a “p” for precise e.g. <code class="highlighter-rouge">123456p</code>.</p>

<p><strong>Time representation:</strong> In order to work with temporal values the Table API supports Java SQL’s Date, Time, and Timestamp types. In the Scala Table API literals can be defined by using <code class="highlighter-rouge">java.sql.Date.valueOf("2016-06-27")</code>, <code class="highlighter-rouge">java.sql.Time.valueOf("10:10:42")</code>, or <code class="highlighter-rouge">java.sql.Timestamp.valueOf("2016-06-27 10:10:42.123")</code>. The Java and Scala Table API also support calling <code class="highlighter-rouge">"2016-06-27".toDate()</code>, <code class="highlighter-rouge">"10:10:42".toTime()</code>, and <code class="highlighter-rouge">"2016-06-27 10:10:42.123".toTimestamp()</code> for converting Strings into temporal types. <em>Note:</em> Since Java’s temporal SQL types are time zone dependent, please make sure that the Flink Client and all TaskManagers use the same time zone.</p>

<p><strong>Temporal intervals:</strong> Temporal intervals can be represented as number of months (<code class="highlighter-rouge">Types.INTERVAL_MONTHS</code>) or number of milliseconds (<code class="highlighter-rouge">Types.INTERVAL_MILLIS</code>). Intervals of same type can be added or subtracted (e.g. <code class="highlighter-rouge">1.hour + 10.minutes</code>). Intervals of milliseconds can be added to time points (e.g. <code class="highlighter-rouge">"2016-08-10".toDate + 5.days</code>).</p>

<p><strong>Scala expressions:</strong> Scala expressions use implicit conversions. Therefore, make sure to add the wildcard import <code class="highlighter-rouge">org.apache.flink.table.api._</code> to your programs. In case a literal is not treated as an expression, use <code class="highlighter-rouge">.toExpr</code> such as <code class="highlighter-rouge">3.toExpr</code> to force a literal to be converted.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      想参与贡献翻译？
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
