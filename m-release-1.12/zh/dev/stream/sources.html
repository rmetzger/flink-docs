<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: Data Sources</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/zh/dev/stream/sources.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/local_installation.html">本地模式安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/datastream_api.html">基于 DataStream API 实现欺诈检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/table_api.html">基于 Table API 实现实时报表</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/flink-operations-playground.html">Flink 操作场景</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> 实践练习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/datastream_api.html">DataStream API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/etl.html">数据管道 & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/streaming_analytics.html">流式分析</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/event_driven.html">事件驱动应用</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/fault_tolerance.html">容错处理</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> 概念透析<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/index.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/stateful-stream-processing.html">有状态流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">及时流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/flink-architecture.html">Flink 架构</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/glossary.html">词汇表</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse"class="active">DataStream API</a><div class="collapse in" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_time.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamps_watermarks.html">生成 Watermark</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamp_extractors.html">内置 Watermark 生成器</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/broadcast_state.html">Broadcast State 模式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/schema_evolution.html">状态数据结构升级</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/user_defined_functions.html">用户自定义 Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">算子<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/windows.html">窗口</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/asyncio.html">异步 I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/sources.html" class="active">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/side_output.html">旁路输出</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/testing.html">测试</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/experimental.html">实验功能</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/java_lambdas.html">Java Lambda 表达式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/iterations.html">迭代</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/hadoop_compatibility.html">Hadoop 兼容</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/local_execution.html">本地执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/cluster_execution.html">集群执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/examples.html">Batch 示例</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse">Table API & SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">概念与通用 API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">流式概念<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表 (Dynamic Table)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">流上的 Join</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">时态表（Temporal Tables）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/match_recognize.html">模式检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html">查询语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html">CREATE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/drop.html">DROP 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/alter.html">ALTER 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/insert.html">INSERT 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/describe.html">DESCRIBE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/use.html">USE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/show.html">SHOW 语句</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html">系统（内置）函数</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/modules.html">模块</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sqlClient.html">SQL 客户端</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/config.html">配置</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tuning/streaming_aggregation_optimization.html">流式聚合</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse">Python API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/installation.html">环境安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table_api_tutorial.html">Table API 教程</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream_tutorial.html">DataStream API 教程</a></li>
<li><a href="#collapse-103" data-toggle="collapse">Table API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html">Python Table API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/built_in_functions.html">系统（内置）函数</a></li>
<li><a href="#collapse-109" data-toggle="collapse">自定义函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通自定义函数（UDF）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html">PyFlink Table 和 Pandas DataFrame 互转</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_table_api_connectors.html">连接器</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/data_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/operators.html">算子</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/dependency_management.html">依赖管理</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/environment_variables.html">环境变量</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/faq.html">常见问题</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">数据类型以及序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/types_serialization.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/custom_serializers.html">自定义序列化器</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_configuration.html">执行配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/packaging.html">程序打包</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/parallel.html">并行执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_plans.html">执行计划</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">Task 故障恢复</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/migration.html">API 迁移指南</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/cep.html">事件处理 (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/guarantees.html">容错保证</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/">概览</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_dialect.html">Hive 方言</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_functions.html">Hive 函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/downloads.html">下载</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/">概览</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/local.html">本地集群</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/config.html">配置参数</a></li>
<li><a href="#collapse-213" data-toggle="collapse">内存配置<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup.html">配置 Flink 进程的内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_tm.html">配置 TaskManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_jobmanager.html">配置 JobManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_tuning.html">调优指南</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_trouble.html">常见问题</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_migration.html">升级指南</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">文件系统<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/common.html">通用配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/oss.html">阿里云 OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/azure.html">Azure Blob 存储</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-ssl.html">SSL 设置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/external_resources.html">扩展资源</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/logging.html">日志</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/large_state_tuning.html">大状态与 Checkpoint 调优</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_event_time.html">调试窗口与事件时间</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_classloading.html">调试类加载</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/application_profiling.html">应用程序分析</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/checkpoint_monitoring.html">监控 Checkpoint</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/back_pressure.html">监控反压</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/upgrading.html">升级应用程序和 Flink 版本</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/production_ready.html">生产就绪情况核对清单</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink 开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/ide_setup.html">导入 Flink 到 IDE 中</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/building.html">从源码构建 Flink</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> 内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/job_scheduling.html">作业调度</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/task_lifecycle.html">Task 生命周期</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/filesystems.html">文件系统</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">选择文档版本<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/stream/sources.html">
      <button type="submit" class="btn btn-default">English</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">DataStream API</a></li>
  
    <li class="active">Data Sources</li>
</ol>

<h1>Data Sources</h1>




<ul id="markdown-toc">
  <li><a href="#data-source-concepts" id="markdown-toc-data-source-concepts">Data Source Concepts</a></li>
  <li><a href="#the-data-source-api" id="markdown-toc-the-data-source-api">The Data Source API</a>    <ul>
      <li><a href="#source" id="markdown-toc-source">Source</a></li>
      <li><a href="#splitenumerator" id="markdown-toc-splitenumerator">SplitEnumerator</a></li>
      <li><a href="#sourcereader" id="markdown-toc-sourcereader">SourceReader</a></li>
      <li><a href="#use-the-source" id="markdown-toc-use-the-source">Use the Source</a></li>
    </ul>
  </li>
  <li><a href="#the-split-reader-api" id="markdown-toc-the-split-reader-api">The Split Reader API</a>    <ul>
      <li><a href="#splitreader" id="markdown-toc-splitreader">SplitReader</a></li>
      <li><a href="#sourcereaderbase" id="markdown-toc-sourcereaderbase">SourceReaderBase</a></li>
      <li><a href="#splitfetchermanager" id="markdown-toc-splitfetchermanager">SplitFetcherManager</a></li>
    </ul>
  </li>
  <li><a href="#event-time-and-watermarks" id="markdown-toc-event-time-and-watermarks">Event Time and Watermarks</a></li>
</ul>

<div class="alert alert-warning">
  <p><strong>Note:</strong> This describes the new Data Source API, introduced in Flink 1.11 as part of <a href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-27%3A+Refactor+Source+Interface">FLIP-27</a>.
  This new API is currently in <strong>BETA</strong> status.</p>
  <p>Most of the existing source connectors are not yet (as of Flink 1.11) implemented using this new API,
  but using the previous API, based on <a href="https://github.com/apache/flink/blob/master/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SourceFunction.java">SourceFunction</a>.</p>
</div>

<p>This page describes Flink’s Data Source API and the concepts and architecture behind it.
<strong>Read this, if you are interested in how data sources in Flink work, or if you want to implement a new Data Source.</strong></p>

<p>If you are looking for pre-defined source connectors, please check the <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">Connector Docs</a>.</p>

<h2 id="data-source-concepts">Data Source Concepts</h2>

<p><strong>Core Components</strong></p>

<p>A Data Source has three core components: <em>Splits</em>, the <em>SplitEnumerator</em>, and the <em>SourceReader</em>.</p>

<ul>
  <li>
    <p>A <strong>Split</strong> is a portion of data consumed by the source, like a file or a log partition. Splits are granularity by which the source distributes the work and parallelizes the data reading.</p>
  </li>
  <li>
    <p>The <strong>SourceReader</strong> requests <em>Splits</em> and processes them, for example by reading the file or log partition represented by the <em>Split</em>. The <em>SourceReader</em> run in parallel on the Task Managers in the <code class="highlighter-rouge">SourceOperators</code> and produces the parallel stream of events/records.</p>
  </li>
  <li>
    <p>The <strong>SplitEnumerator</strong> generates the <em>Splits</em> and assigns them to the <em>SourceReaders</em>. It runs as a single instance on the Job Manager and is responsible for maintaining the backlog of pending <em>Splits</em> and assigning them to the readers in a balanced manner.</p>
  </li>
</ul>

<p>The <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/Source.java">Source</a> class is API entry point that ties the above three components together.</p>

<div style="text-align: center">
  <img width="70%" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/fig/source_components.svg" alt="Illustration of SplitEnumerator and SourceReader interacting." />
</div>

<p><strong>Unified Across Streaming and Batch</strong></p>

<p>The Data Source API supports both unbounded streaming sources and bounded batch sources, in a unified way.</p>

<p>The difference between both cases is minimal: In the bounded/batch case, the enumerator generates a fix set of splits, and each split is necessarily finite. In the unbounded streaming case, one of the two is not true (splits are not finite, or the enumerator keep generating new splits).</p>

<h4 id="examples">Examples</h4>

<p>Here are some simplified conceptual examples to illustrate how the data source components interact, in streaming and batch cases.</p>

<p><em>Note that this does not the accurately describe how the Kafka and File source implementations work; parts are simplified, for illustrative purposes.</em></p>

<p><strong>Bounded File Source</strong></p>

<p>The source has the URI/Path of a directory to read, and a <em>Format</em> that defines how to parse the files.</p>

<ul>
  <li>A <em>Split</em> is a file, or a region of a file (if the data format supports splitting the file).</li>
  <li>The <em>SplitEnumerator</em> lists all files under the given directory path. It assigns Splits to the next reader that requests a Split. Once all Splits are assigned, it responds to requests with <em>NoMoreSplits</em>.</li>
  <li>The <em>SourceReader</em> requests a Split and reads the assigned Split (file or file region) and parses it using the given Format. If it does not get another Split, but a <em>NoMoreSplits</em> message, it finishes.</li>
</ul>

<p><strong>Unbounded Streaming File Source</strong></p>

<p>This source works the same way as described above, except that the <em>SplitEnumerator</em> never responds with <em>NoMoreSplits</em> and periodically lists the contents under the given URI/Path to check for new files. Once it finds new files, it generates new Splits for them and can assign them to the available SourceReaders.</p>

<p><strong>Unbounded Streaming Kafka Source</strong></p>

<p>The source has a Kafka Topic (or list of Topics or Topic regex) and a <em>Deserializer</em> to parse the records.</p>

<ul>
  <li>A <em>Split</em> is a Kafka Topic Partition.</li>
  <li>The <em>SplitEnumerator</em> connects to the brokers to list all topic partitions involved in the subscribed topics. The enumerator can optionally repeat this operation to discover newly added topics/partitions.</li>
  <li>The <em>SourceReader</em> reads the assigned Splits (Topic Partitions) using the KafkaConsumer and deserializes the records using the provided Deserializer. The splits (Topic Partitions) do not have an end, so the reader never reaches the end of the data.</li>
</ul>

<p><strong>Bounded Kafka Source</strong></p>

<p>Same as above, except that each Split (Topic Partition) has a defined end offset. Once the <em>SourceReader</em> reaches the end offset for a Split, it finishes that Split. Once all assigned Splits are finished, the SourceReader finishes.</p>

<h2 id="the-data-source-api">The Data Source API</h2>
<p>This section describes the major interfaces of the new Source API introduced in FLIP-27, and provides tips to the developers on the Source development.</p>

<h3 id="source">Source</h3>
<p>The <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/Source.java">Source</a> API is a factory style interface to create the following components.</p>

<ul>
  <li><em>Split Enumerator</em></li>
  <li><em>Source Reader</em></li>
  <li><em>Split Serializer</em></li>
  <li><em>Enumerator Checkpoint Serializer</em></li>
</ul>

<p>In addition to that, the Source provides the <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/Boundedness.java">boundedness</a> attribute of the source, so that Flink can choose appropriate mode to run the Flink jobs.</p>

<p>The Source implementations should be serializable as the Source instances are serialized and uploaded to the Flink cluster at runtime.</p>

<h3 id="splitenumerator">SplitEnumerator</h3>
<p>The <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/SplitEnumerator.java">SplitEnumerator</a> is expected to be the “brain” of the Source. Typical implementations of the <code class="highlighter-rouge">SplitEnumerator</code> do the following:</p>

<ul>
  <li><code class="highlighter-rouge">SourceReader</code> registration handling</li>
  <li><code class="highlighter-rouge">SourceReader</code> failure handling
    <ul>
      <li>The <code class="highlighter-rouge">addSplitsBack()</code> method will be invoked when a <code class="highlighter-rouge">SourceReader</code> fails. The SplitEnumerator should take back the split assignments that have not been acknowledged by the failed <code class="highlighter-rouge">SourceReader</code>.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">SourceEvent</code> handling
    <ul>
      <li><code class="highlighter-rouge">SourceEvent</code>s are custom events sent between <code class="highlighter-rouge">SplitEnumerator</code> and <code class="highlighter-rouge">SourceReader</code>. The implementation can leverage this mechanism to perform sophisticated coordination.</li>
    </ul>
  </li>
  <li>Split discovery and assignment
    <ul>
      <li>The <code class="highlighter-rouge">SplitEnumerator</code> can assign splits to the <code class="highlighter-rouge">SourceReader</code>s in response to various events, including discovery of new splits, new <code class="highlighter-rouge">SourceReader</code> registration, <code class="highlighter-rouge">SourceReader</code> failure, etc.</li>
    </ul>
  </li>
</ul>

<p>A <code class="highlighter-rouge">SplitEnumerator</code> can accomplish the above work with the help of the <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/SplitEnumeratorContext.java">SplitEnumeratorContext</a> which is provided to the <code class="highlighter-rouge">Source</code> on creation or restore of the <code class="highlighter-rouge">SplitEnumerator</code>. 
The <code class="highlighter-rouge">SplitEnumeratorContext</code> allows a <code class="highlighter-rouge">SplitEnumerator</code> to retrieve necessary information of the readers and perform coordination actions.
The <code class="highlighter-rouge">Source</code> implementation is expected to pass the <code class="highlighter-rouge">SplitEnumeratorContext</code> to the <code class="highlighter-rouge">SplitEnumerator</code> instance.</p>

<p>While a <code class="highlighter-rouge">SplitEnumerator</code> implementation can work well in a reactive way by only taking coordination actions when its method is invoked, some <code class="highlighter-rouge">SplitEnumerator</code> implementations might want to take actions actively. For example, a <code class="highlighter-rouge">SplitEnumerator</code> may want to periodically run split discovery and assign the new splits to the <code class="highlighter-rouge">SourceReaders</code>. 
Such implementations may find that the <code class="highlighter-rouge">callAsync()</code> method <code class="highlighter-rouge">SplitEnumeratorContext</code> is handy. The code snippet below shows how the <code class="highlighter-rouge">SplitEnumerator</code> implementation can achieve that without maintaining its own threads.</p>
<div data-lang="java">

  <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MySplitEnumerator</span> <span class="kd">implements</span> <span class="nc">SplitEnumerator</span><span class="o">&lt;</span><span class="nc">MySplit</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="no">DISCOVER_INTERVAL</span> <span class="o">=</span> <span class="mi">60_000L</span><span class="o">;</span>

    <span class="cm">/**
     * A method to discover the splits.
     */</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MySplit</span><span class="o">&gt;</span> <span class="nf">discoverSplits</span><span class="o">()</span> <span class="o">{...}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="o">()</span> <span class="o">{</span>
        <span class="o">...</span>
        <span class="n">enumContext</span><span class="o">.</span><span class="na">callAsync</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">discoverSplits</span><span class="o">,</span> <span class="n">splits</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MockSourceSplit</span><span class="o">&gt;&gt;</span> <span class="n">assignments</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
            <span class="kt">int</span> <span class="n">parallelism</span> <span class="o">=</span> <span class="n">enumContext</span><span class="o">.</span><span class="na">currentParallelism</span><span class="o">();</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">MockSourceSplit</span> <span class="n">split</span> <span class="o">:</span> <span class="n">splits</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">owner</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="na">splitId</span><span class="o">().</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">%</span> <span class="n">parallelism</span><span class="o">;</span>
                <span class="n">assignments</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">owner</span><span class="o">,</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;()).</span><span class="na">add</span><span class="o">(</span><span class="n">split</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="n">enumContext</span><span class="o">.</span><span class="na">assignSplits</span><span class="o">(</span><span class="k">new</span> <span class="nc">SplitsAssignment</span><span class="o">&lt;&gt;(</span><span class="n">assignments</span><span class="o">));</span>
        <span class="o">},</span> <span class="mi">0L</span><span class="o">,</span> <span class="no">DISCOVER_INTERVAL</span><span class="o">);</span>
        <span class="o">...</span>
    <span class="o">}</span>
    <span class="o">...</span>
<span class="o">}</span></code></pre></figure>

</div>

<h3 id="sourcereader">SourceReader</h3>

<p>The <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/SourceReader.java">SourceReader</a> is a component running in the Task Managers to consume the records from the Splits.</p>

<p>The <code class="highlighter-rouge">SourceReader</code> exposes a pull-based consumption interface. A Flink task keeps calling <code class="highlighter-rouge">pollNext(ReaderOutput)</code> in a loop to poll records from the <code class="highlighter-rouge">SourceReader</code>. The return value of the <code class="highlighter-rouge">pollNext(ReaderOutput)</code> method indicates the status of the source reader.</p>

<ul>
  <li><code class="highlighter-rouge">MORE_AVAILABLE</code> - The SourceReader has more records available immediately.</li>
  <li><code class="highlighter-rouge">NOTHING_AVAILABLE</code> - The SourceReader does not have more records available at this point, but may have more records in the future.</li>
  <li><code class="highlighter-rouge">END_OF_INPUT</code> - The SourceReader has exhausted all the records and reached the end of data. This means the SourceReader can be closed.</li>
</ul>

<p>In the interest of performance, a <code class="highlighter-rouge">ReaderOutput</code> is provided to the <code class="highlighter-rouge">pollNext(ReaderOutput)</code> method, so a <code class="highlighter-rouge">SourceReader</code> can emit multiple records in a single call of pollNext() if it has to. For example, sometimes the external system works at the granularity of blocks. A block may contain multiple records but the source can only checkpoint at the block boundaries. In this case the <code class="highlighter-rouge">SourceReader</code> can emit all the records in one block at a time to the <code class="highlighter-rouge">ReaderOutput</code>.
<strong>However, the <code class="highlighter-rouge">SourceReader</code> implementation should avoid emitting multiple records in a single <code class="highlighter-rouge">pollNext(ReaderOutput)</code> invocation unless necessary.</strong> This is because the task thread that is polling from the <code class="highlighter-rouge">SourceReader</code> works in an event-loop and cannot block.</p>

<p>All the state of a <code class="highlighter-rouge">SourceReader</code> should be maintained inside the <code class="highlighter-rouge">SourceSplit</code>s which are returned at the <code class="highlighter-rouge">snapshotState()</code> invocation. Doing this allows the <code class="highlighter-rouge">SourceSplit</code>s to be reassigned to other <code class="highlighter-rouge">SourceReaders</code> when needed.</p>

<p>A <code class="highlighter-rouge">SourceReaderContext</code> is provided to the <code class="highlighter-rouge">Source</code> upon a <code class="highlighter-rouge">SourceReader</code> creation. It is expected that the <code class="highlighter-rouge">Source</code> will pass the context to the <code class="highlighter-rouge">SourceReader</code> instance. The <code class="highlighter-rouge">SourceReader</code> can send <code class="highlighter-rouge">SourceEvent</code> to its <code class="highlighter-rouge">SplitEnumerator</code> through the <code class="highlighter-rouge">SourceReaderContext</code>. A typical design pattern of the <code class="highlighter-rouge">Source</code> is letting the <code class="highlighter-rouge">SourceReader</code>s report their local information to the <code class="highlighter-rouge">SplitEnumerator</code> who has a global view to make decisions.</p>

<p>The <code class="highlighter-rouge">SourceReader</code> API is a low level API that allows users to deal with the splits manually and have their own threading model to fetch and handover the records. To facilitate the <code class="highlighter-rouge">SourceReader</code> implementation, Flink has provided a <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/SourceReaderBase.java">SourceReaderBase</a> class which significantly reduces the amount the work needed to write a <code class="highlighter-rouge">SourceReader</code>.
<strong>It is highly recommended for the connector developers to take advantage of the <code class="highlighter-rouge">SourceReaderBase</code> instead of writing the <code class="highlighter-rouge">SourceReader</code>s from scratch</strong>. For more details please check the <a href="#the-split-reader-api">Split Reader API</a> section.</p>

<h3 id="use-the-source">Use the Source</h3>
<p>In order to create a <code class="highlighter-rouge">DataStream</code> from a <code class="highlighter-rouge">Source</code>, one needs to pass the <code class="highlighter-rouge">Source</code> to a <code class="highlighter-rouge">StreamExecutionEnvironment</code>. For example,</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="nc">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>

<span class="nc">Source</span> <span class="n">mySource</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MySource</span><span class="o">(...);</span>

<span class="nc">DataStream</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">fromSource</span><span class="o">(</span>
        <span class="n">mySource</span><span class="o">,</span>
        <span class="nc">WatermarkStrategy</span><span class="o">.</span><span class="na">noWatermarks</span><span class="o">(),</span>
        <span class="s">"MySourceName"</span><span class="o">);</span>
<span class="o">...</span></code></pre></figure>

  </div>
  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="nv">env</span> <span class="k">=</span> <span class="nv">StreamExecutionEnvironment</span><span class="o">.</span><span class="py">getExecutionEnvironment</span><span class="o">()</span>

<span class="k">val</span> <span class="nv">mySource</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MySource</span><span class="o">(...)</span>

<span class="k">val</span> <span class="nv">stream</span> <span class="k">=</span> <span class="nv">env</span><span class="o">.</span><span class="py">fromSource</span><span class="o">(</span>
      <span class="n">mySource</span><span class="o">,</span>
      <span class="nv">WatermarkStrategy</span><span class="o">.</span><span class="py">noWatermarks</span><span class="o">(),</span>
      <span class="s">"MySourceName"</span><span class="o">)</span>
<span class="o">...</span></code></pre></figure>

  </div>
</div>

<hr />
<hr />

<h2 id="the-split-reader-api">The Split Reader API</h2>

<p>The core SourceReader API is fully asynchronous and requires implementations to manage asynchronous split reading manually.
However, in practice, most sources perform blocking operations, like blocking <em>poll()</em> calls on clients (for example the <code class="highlighter-rouge">KafkaConsumer</code>), or blocking I/O operations on distributed file systems (HDFS, S3, …). To make this compatible with the asynchronous Source API, these blocking (synchronous) operations need to happen in separate threads, which hand over the data to the asynchronous part of the reader.</p>

<p>The <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/splitreader/SplitReader.java">SplitReader</a> is the high-level API for simple synchronous reading/polling-based source implementations, like file reading, Kafka, etc.</p>

<p>The core is the <code class="highlighter-rouge">SourceReaderBase</code> class, which takes a <code class="highlighter-rouge">SplitReader</code> and creates fetcher threads running the SplitReader, supporting different consumption threading models.</p>

<h3 id="splitreader">SplitReader</h3>

<p>The <code class="highlighter-rouge">SplitReader</code> API only has three methods:</p>
<ul>
  <li>A blocking fetch method to return a <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/RecordsWithSplitIds.java">RecordsWithSplitIds</a></li>
  <li>A non-blocking method to handle split changes.</li>
  <li>A non-blocking wake up method to wake up the blocking fetch operation.</li>
</ul>

<p>The <code class="highlighter-rouge">SplitReader</code> only focuses on reading the records from the external system, therefore is much simpler compared with <code class="highlighter-rouge">SourceReader</code>.
Please check the Java doc of the class for more details.</p>

<h3 id="sourcereaderbase">SourceReaderBase</h3>

<p>It is quite common that a <code class="highlighter-rouge">SourceReader</code> implementation does the following:</p>

<ul>
  <li>Have a pool of threads fetching from splits of the external system in a blocking way.</li>
  <li>Handle the synchronization between the internal fetching threads and other methods invocations such as <code class="highlighter-rouge">pollNext(ReaderOutput)</code>.</li>
  <li>Maintain the per split watermark for watermark alignment.</li>
  <li>Maintain the state of each split for checkpoint.</li>
</ul>

<p>In order to reduce the work of writing a new <code class="highlighter-rouge">SourceReader</code>, Flink provides a <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/SourceReaderBase.java">SourceReaderBase</a> class to serve as a base implementation of the <code class="highlighter-rouge">SourceReader</code>. 
<code class="highlighter-rouge">SourceReaderBase</code> has all the above work done out of the box. To write a new <code class="highlighter-rouge">SourceReader</code>, one can just let the <code class="highlighter-rouge">SourceReader</code> implementation inherit from the <code class="highlighter-rouge">SourceReaderBase</code>, fill in a few methods and implement a high level <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/splitreader/SplitReader.java">SplitReader</a>.</p>

<h3 id="splitfetchermanager">SplitFetcherManager</h3>

<p>The <code class="highlighter-rouge">SourceReaderBase</code> supports a few threading models out of the box, depending on the behavior of the <a href="https://github.com/apache/flink/blob/master/flink-connectors/flink-connector-base/src/main/java/org/apache/flink/connector/base/source/reader/fetcher/SplitFetcherManager.java">SplitFetcherManager</a> it works with.
The <code class="highlighter-rouge">SplitFetcherManager</code> helps create and maintain a pool of <code class="highlighter-rouge">SplitFetcher</code>s each fetching with a <code class="highlighter-rouge">SplitReader</code>. It also determines how to assign splits to each split fetcher.</p>

<p>As an example, as illustrated below, a <code class="highlighter-rouge">SplitFetcherManager</code> may have a fixed number of threads, each fetching from some splits assigned to the <code class="highlighter-rouge">SourceReader</code>.</p>
<div style="text-align: center">
  <img width="70%" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/fig/source_reader.svg" alt="One fetcher per split threading model." />
</div>
<p>The following code snippet implements this threading model.</p>
<div data-lang="java">

  <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**
 * A SplitFetcherManager that has a fixed size of split fetchers and assign splits 
 * to the split fetchers based on the hash code of split IDs.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixedSizeSplitFetcherManager</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="nc">SplitT</span> <span class="kd">extends</span> <span class="nc">SourceSplit</span><span class="o">&gt;</span> 
        <span class="kd">extends</span> <span class="nc">SplitFetcherManager</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="nc">SplitT</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">numFetchers</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">FixedSizeSplitFetcherManager</span><span class="o">(</span>
            <span class="kt">int</span> <span class="n">numFetchers</span><span class="o">,</span>
            <span class="nc">FutureNotifier</span> <span class="n">futureNotifier</span><span class="o">,</span>
            <span class="nc">FutureCompletingBlockingQueue</span><span class="o">&lt;</span><span class="nc">RecordsWithSplitIds</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;&gt;</span> <span class="n">elementsQueue</span><span class="o">,</span>
            <span class="nc">Supplier</span><span class="o">&lt;</span><span class="nc">SplitReader</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="nc">SplitT</span><span class="o">&gt;&gt;</span> <span class="n">splitReaderSupplier</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">futureNotifier</span><span class="o">,</span> <span class="n">elementsQueue</span><span class="o">,</span> <span class="n">splitReaderSupplier</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">numFetchers</span> <span class="o">=</span> <span class="n">numFetchers</span><span class="o">;</span>
        <span class="c1">// Create numFetchers split fetchers.</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numFetchers</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">startFetcher</span><span class="o">(</span><span class="n">createSplitFetcher</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addSplits</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">SplitT</span><span class="o">&gt;</span> <span class="n">splitsToAdd</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Group splits by their owner fetchers.</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SplitT</span><span class="o">&gt;&gt;</span> <span class="n">splitsByFetcherIndex</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">splitsToAdd</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">split</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">ownerFetcherIndex</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">%</span> <span class="n">numFetchers</span><span class="o">;</span>
            <span class="n">splitsByFetcherIndex</span>
                    <span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">ownerFetcherIndex</span><span class="o">,</span> <span class="n">s</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;())</span>
                    <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">split</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="c1">// Assign the splits to their owner fetcher.</span>
        <span class="n">splitsByFetcherIndex</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">fetcherIndex</span><span class="o">,</span> <span class="n">splitsForFetcher</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">fetchers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">fetcherIndex</span><span class="o">).</span><span class="na">addSplits</span><span class="o">(</span><span class="n">splitsForFetcher</span><span class="o">);</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

</div>

<p>And a <code class="highlighter-rouge">SourceReader</code> using this threading model can be created like following:</p>
<div data-lang="java">

  <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FixedFetcherSizeSourceReader</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="no">T</span><span class="o">,</span> <span class="nc">SplitT</span> <span class="kd">extends</span> <span class="nc">SourceSplit</span><span class="o">,</span> <span class="nc">SplitStateT</span><span class="o">&gt;</span>
        <span class="kd">extends</span> <span class="nc">SourceReaderBase</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="no">T</span><span class="o">,</span> <span class="nc">SplitT</span><span class="o">,</span> <span class="nc">SplitStateT</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">FixedFetcherSizeSourceReader</span><span class="o">(</span>
            <span class="nc">FutureNotifier</span> <span class="n">futureNotifier</span><span class="o">,</span>
            <span class="nc">FutureCompletingBlockingQueue</span><span class="o">&lt;</span><span class="nc">RecordsWithSplitIds</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;&gt;</span> <span class="n">elementsQueue</span><span class="o">,</span>
            <span class="nc">Supplier</span><span class="o">&lt;</span><span class="nc">SplitReader</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="nc">SplitT</span><span class="o">&gt;&gt;</span> <span class="n">splitFetcherSupplier</span><span class="o">,</span>
            <span class="nc">RecordEmitter</span><span class="o">&lt;</span><span class="no">E</span><span class="o">,</span> <span class="no">T</span><span class="o">,</span> <span class="nc">SplitStateT</span><span class="o">&gt;</span> <span class="n">recordEmitter</span><span class="o">,</span>
            <span class="nc">Configuration</span> <span class="n">config</span><span class="o">,</span>
            <span class="nc">SourceReaderContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span>
                <span class="n">futureNotifier</span><span class="o">,</span>
                <span class="n">elementsQueue</span><span class="o">,</span>
                <span class="k">new</span> <span class="nc">FixedSizeSplitFetcherManager</span><span class="o">&lt;&gt;(</span>
                        <span class="n">config</span><span class="o">.</span><span class="na">getInteger</span><span class="o">(</span><span class="nc">SourceConfig</span><span class="o">.</span><span class="na">NUM_FETCHERS</span><span class="o">),</span>
                        <span class="n">futureNotifier</span><span class="o">,</span>
                        <span class="n">elementsQueue</span><span class="o">,</span>
                        <span class="n">splitFetcherSupplier</span><span class="o">),</span>
                <span class="n">recordEmitter</span><span class="o">,</span>
                <span class="n">config</span><span class="o">,</span>
                <span class="n">context</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSplitFinished</span><span class="o">(</span><span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">finishedSplitIds</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Do something in the callback for the finished splits.</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">SplitStateT</span> <span class="nf">initializedState</span><span class="o">(</span><span class="nc">SplitT</span> <span class="n">split</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">SplitT</span> <span class="nf">toSplitType</span><span class="o">(</span><span class="nc">String</span> <span class="n">splitId</span><span class="o">,</span> <span class="nc">SplitStateT</span> <span class="n">splitState</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

</div>

<p>Apparently, the <code class="highlighter-rouge">SourceReader</code> implementations can also implement their own threading model easily on top of the <code class="highlighter-rouge">SplitFetcherManager</code> and <code class="highlighter-rouge">SourceReaderBase</code>.</p>

<h2 id="event-time-and-watermarks">Event Time and Watermarks</h2>

<p><em>Event Time</em> assignment and <em>Watermark Generation</em> happen as part of the data sources. The event streams leaving the Source Readers have event timestamps and (during streaming execution) contain watermarks. See <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">Timely Stream Processing</a> for an introduction to Event Time and Watermarks.</p>

<p><span class="label label-danger">Important</span> Applications based on the legacy <a href="https://github.com/apache/flink/blob/master/flink-streaming-java/src/main/java/org/apache/flink/streaming/api/functions/source/SourceFunction.java">SourceFunction</a> typically generate timestamps and watermarks in a separate later step via <code class="highlighter-rouge">stream.assignTimestampsAndWatermarks(WatermarkStrategy)</code>. This function should not be used with the new sources, because timestamps will be already assigned, and it will override the previous split-aware watermarks.</p>

<h4 id="api">API</h4>

<p>The <code class="highlighter-rouge">WatermarkStrategy</code> is passed to the Source during creation in the DataStream API and creates both the <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/common/eventtime/TimestampAssigner.java">TimestampAssigner</a> and <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/common/eventtime/WatermarkGenerator.java">WatermarkGenerator</a>.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">environment</span><span class="o">.</span><span class="na">fromSource</span><span class="o">(</span>
    <span class="nc">Source</span><span class="o">&lt;</span><span class="no">OUT</span><span class="o">,</span> <span class="o">?,</span> <span class="o">?&gt;</span> <span class="n">source</span><span class="o">,</span>
    <span class="nc">WatermarkStrategy</span><span class="o">&lt;</span><span class="no">OUT</span><span class="o">&gt;</span> <span class="n">timestampsAndWatermarks</span><span class="o">,</span>
    <span class="nc">String</span> <span class="n">sourceName</span><span class="o">)</span></code></pre></figure>

<p>The <code class="highlighter-rouge">TimestampAssigner</code> and <code class="highlighter-rouge">WatermarkGenerator</code> run transparently as part of the <code class="highlighter-rouge">ReaderOutput</code>(or <code class="highlighter-rouge">SourceOutput</code>) so source implementors do not have to implement any timestamp extraction and watermark generation code.</p>

<h4 id="event-timestamps">Event Timestamps</h4>

<p>Event timestamps are assigned in two steps:</p>

<ol>
  <li>
    <p>The SourceReader may attach the <em>source record timestamp</em> to the event, by calling <code class="highlighter-rouge">SourceOutput.collect(event, timestamp)</code>.
This is relevant only for data sources that are record-based and have timestamps, such as Kafka, Kinesis, Pulsar, or Pravega.
Sources that are not based on records with timestamps (like files) do not have a <em>source record timestamp</em>.
This step is part of the source connector implementation and not parameterized by the application that uses the source.</p>
  </li>
  <li>
    <p>The <code class="highlighter-rouge">TimestampAssigner</code>, which is configured by the application, assigns the final timestamp.
The <code class="highlighter-rouge">TimestampAssigner</code> sees the original <em>source record timestamp</em> and the event. The assigner can use the <em>source record timestamp</em> or access a field of the event obtain the final event timestamp.</p>
  </li>
</ol>

<p>This two-step approach allows users to reference both timestamps from the source systems and timestamps in the event’s data as the event timestamp.</p>

<p><em>Note:</em> When using a data source without <em>source record timestamps</em> (like files) and selecting the <em>source record timestamp</em> as the final event timestamp, events will get a default timestamp equal to <code class="highlighter-rouge">LONG_MIN</code> <em>(=-9,223,372,036,854,775,808)</em>.</p>

<h4 id="watermark-generation">Watermark Generation</h4>

<p>Watermark Generators are only active during streaming execution. Batch execution deactivates Watermark Generators; all related operations described below become effectively no-ops.</p>

<p>The data source API supports running watermark generators individually <em>per split</em>. That allows Flink to observe the event time progress per split individually, which is important to handle <em>event time skew</em> properly and prevent <em>idle partitions</em> from holding back the event time progress of the entire application.</p>

<div style="text-align: center">
  <img width="80%" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/fig/per_split_watermarks.svg" alt="Watermark Generation in a Source with two Splits." />
</div>

<p>When implementing a source connector using the <em>Split Reader API</em>, this is automatically handled. All implementations based on the Split Reader API have split-aware watermarks out-of-the-box.</p>

<p>For an implementation of the lower level <code class="highlighter-rouge">SourceReader</code> API to use split-aware watermark generation, the implementation must output events from different splits to different outputs: the <em>Split-local SourceOutputs</em>. Split-local outputs can be created and released on the main <a href="https://github.com/apache/flink/blob/master/flink-core/src/main/java/org/apache/flink/api/connector/source/ReaderOutput.java">ReaderOutput</a> via the <code class="highlighter-rouge">createOutputForSplit(splitId)</code> and <code class="highlighter-rouge">releaseOutputForSplit(splitId)</code> methods. Please refer to the JavaDocs of the class and methods for details.</p>



<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      想参与贡献翻译？
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
