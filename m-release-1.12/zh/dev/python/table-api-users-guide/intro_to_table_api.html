<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.12 Documentation: Python Table API 简介</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/zh/dev/python/table-api-users-guide/intro_to_table_api.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          <div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/img/navbar-brand-logo.jpg"></a> v1.12</p>
</div>
<ul id="sidenav">
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li><hr class="section-break"></hr>
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-rocket title appetizer" aria-hidden="true"></i> Try Flink<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/local_installation.html">本地模式安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/datastream_api.html">基于 DataStream API 实现欺诈检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/table_api.html">基于 Table API 实现实时报表</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/try-flink/flink-operations-playground.html">Flink 操作场景</a></li>
</ul></div></li>
<li><a href="#collapse-8" data-toggle="collapse"><i class="fa fa-hand-paper-o title appetizer" aria-hidden="true"></i> 实践练习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-8"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/datastream_api.html">DataStream API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/etl.html">数据管道 & ETL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/streaming_analytics.html">流式分析</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/event_driven.html">事件驱动应用</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/learn-flink/fault_tolerance.html">容错处理</a></li>
</ul></div></li>
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> 概念透析<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/index.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/stateful-stream-processing.html">有状态流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/timely-stream-processing.html">及时流处理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/flink-architecture.html">Flink 架构</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/concepts/glossary.html">词汇表</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-21" data-toggle="collapse"class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</a><div class="collapse in" id="collapse-21"><ul>
<li><a href="#collapse-22" data-toggle="collapse">DataStream API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-22"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_api.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/datastream_execution_mode.html">Execution Mode (Batch/Streaming)</a></li>
<li><a href="#collapse-24" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_time.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamps_watermarks.html">生成 Watermark</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/event_timestamp_extractors.html">内置 Watermark 生成器</a></li>
</ul></div></li>
<li><a href="#collapse-28" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state.html">Working with State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/broadcast_state.html">Broadcast State 模式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/checkpointing.html">Checkpointing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/queryable_state.html">Queryable State</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/schema_evolution.html">状态数据结构升级</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/user_defined_functions.html">用户自定义 Functions</a></li>
<li><a href="#collapse-38" data-toggle="collapse">算子<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-38"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/windows.html">窗口</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/joining.html">Joining</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/process_function.html">Process Function</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/operators/asyncio.html">异步 I/O</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/sources.html">Data Sources</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/side_output.html">旁路输出</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/application_parameters.html">Handling Application Parameters</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/testing.html">测试</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/stream/experimental.html">实验功能</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/scala_api_extensions.html">Scala API Extensions</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/java_lambdas.html">Java Lambda 表达式</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/project-configuration.html">Project Configuration</a></li>
</ul></div></li>
<li><a href="#collapse-53" data-toggle="collapse">DataSet API<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-53"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/dataset_transformations.html">Transformations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/iterations.html">迭代</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/hadoop_compatibility.html">Hadoop 兼容</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/local_execution.html">本地执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/cluster_execution.html">集群执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/examples.html">Batch 示例</a></li>
</ul></div></li>
<li><a href="#collapse-62" data-toggle="collapse">Table API & SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-62"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/common.html">概念与通用 API</a></li>
<li><a href="#collapse-64" data-toggle="collapse">流式概念<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-64"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/dynamic_tables.html">动态表 (Dynamic Table)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/time_attributes.html">时间属性</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/joins.html">流上的 Join</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/temporal_tables.html">时态表（Temporal Tables）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/match_recognize.html">模式检测</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html">Table API</a></li>
<li><a href="#collapse-74" data-toggle="collapse">SQL<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-74"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/queries.html">查询语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/create.html">CREATE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/drop.html">DROP 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/alter.html">ALTER 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/insert.html">INSERT 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/hints.html">SQL Hints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/describe.html">DESCRIBE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/use.html">USE 语句</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/show.html">SHOW 语句</a></li>
</ul></div></li>
<li><a href="#collapse-86" data-toggle="collapse">函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-86"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/systemFunctions.html">系统（内置）函数</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/functions/udfs.html">自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/modules.html">模块</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sqlClient.html">SQL 客户端</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/config.html">配置</a></li>
<li><a href="#collapse-94" data-toggle="collapse">Performance Tuning<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tuning/streaming_aggregation_optimization.html">流式聚合</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sourceSinks.html">User-defined Sources & Sinks</a></li>
</ul></div></li>
<li><a href="#collapse-99" data-toggle="collapse"class="active">Python API</a><div class="collapse in" id="collapse-99"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/installation.html">环境安装</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table_api_tutorial.html">Table API 教程</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream_tutorial.html">DataStream API 教程</a></li>
<li><a href="#collapse-103" data-toggle="collapse"class="active">Table API用户指南</a><div class="collapse in" id="collapse-103"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/intro_to_table_api.html" class="active">Python Table API 简介</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html">TableEnvironment</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/operations.html">Operations</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/built_in_functions.html">系统（内置）函数</a></li>
<li><a href="#collapse-109" data-toggle="collapse">自定义函数<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-109"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通自定义函数（UDF）</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化自定义函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html">PyFlink Table 和 Pandas DataFrame 互转</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/sql.html">SQL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/catalogs.html">Catalogs</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/python_table_api_connectors.html">连接器</a></li>
</ul></div></li>
<li><a href="#collapse-120" data-toggle="collapse">DataStream API用户指南<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/data_types.html">数据类型</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/operators.html">算子</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/datastream-api-users-guide/dependency_management.html">依赖管理</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/environment_variables.html">环境变量</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/faq.html">常见问题</a></li>
</ul></div></li>
<li><a href="#collapse-129" data-toggle="collapse">数据类型以及序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-129"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/types_serialization.html">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/custom_serializers.html">自定义序列化器</a></li>
</ul></div></li>
<li><a href="#collapse-132" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_configuration.html">执行配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/packaging.html">程序打包</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/parallel.html">并行执行</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/execution_plans.html">执行计划</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/task_failure_recovery.html">Task 故障恢复</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/migration.html">API 迁移指南</a></li>
</ul></div></li>
<li><a href="#collapse-141" data-toggle="collapse"><i class="fa fa-book title maindish" aria-hidden="true"></i> Libraries<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-141"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/cep.html">事件处理 (CEP)</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/state_processor_api.html">State Processor API</a></li>
<li><a href="#collapse-144" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-144"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_api.html">Graph API</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/library_methods.html">Library Methods</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-153" data-toggle="collapse"><i class="fa fa-random title maindish" aria-hidden="true"></i> Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-153"><ul>
<li><a href="#collapse-154" data-toggle="collapse">DataStream Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-154"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/guarantees.html">容错保证</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/cassandra.html">Cassandra</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/file_sink.html">File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/streamfile_sink.html">Streaming File Sink</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/nifi.html">NiFi</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/pubsub.html">Google Cloud PubSub</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/twitter.html">Twitter</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/connectors/jdbc.html">JDBC</a></li>
</ul></div></li>
<li><a href="#collapse-168" data-toggle="collapse">Table & SQL Connectors<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-168"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/">概览</a></li>
<li><a href="#collapse-169" data-toggle="collapse">Formats<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-169"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/csv.html">CSV</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/json.html">JSON</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro-confluent.html">Confluent Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/avro.html">Avro</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/debezium.html">Debezium</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/canal.html">Canal</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/maxwell.html">Maxwell</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/parquet.html">Parquet</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/orc.html">Orc</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/formats/raw.html">Raw</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kafka.html">Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/upsert-kafka.html">Upsert Kafka</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/kinesis.html">Kinesis</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/jdbc.html">JDBC</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/elasticsearch.html">Elasticsearch</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/filesystem.html">FileSystem</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hbase.html">HBase</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/datagen.html">DataGen</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/print.html">Print</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/blackhole.html">BlackHole</a></li>
<li><a href="#collapse-191" data-toggle="collapse">Hive<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-191"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_catalog.html">Hive Catalog</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_dialect.html">Hive 方言</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_read_write.html">Hive Read & Write</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/hive/hive_functions.html">Hive 函数</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/connectors/downloads.html">下载</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/batch/connectors.html">DataSet Connectors</a></li>
</ul></div></li>
<li><a href="#collapse-201" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-201"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/">概览</a></li>
<li><a href="#collapse-202" data-toggle="collapse">Resource Providers<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-202"><ul>
<li><a href="#collapse-203" data-toggle="collapse">Standalone<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-203"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/local.html">本地集群</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/docker.html">Docker</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/standalone/kubernetes.html">Kubernetes</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/native_kubernetes.html">Native Kubernetes</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/yarn.html">YARN</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/resource-providers/mesos.html">Mesos</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/config.html">配置参数</a></li>
<li><a href="#collapse-213" data-toggle="collapse">内存配置<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-213"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup.html">配置 Flink 进程的内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_tm.html">配置 TaskManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_setup_jobmanager.html">配置 JobManager 内存</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_tuning.html">调优指南</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_trouble.html">常见问题</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/memory/mem_migration.html">升级指南</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/cli.html">Command-Line Interface</a></li>
<li><a href="#collapse-222" data-toggle="collapse">文件系统<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-222"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/common.html">通用配置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/s3.html">Amazon S3</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/oss.html">阿里云 OSS</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/azure.html">Azure Blob 存储</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/filesystems/plugins.html">Plugins</a></li>
</ul></div></li>
<li><a href="#collapse-229" data-toggle="collapse">High Availability (HA)<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-229"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/">概览</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/zookeeper_ha.html">ZooKeeper HA Services</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/ha/kubernetes_ha.html">Kubernetes HA Services</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/metric_reporters.html">Metric Reporters</a></li>
<li><a href="#collapse-234" data-toggle="collapse">Security<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-234"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-ssl.html">SSL 设置</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/security/security-kerberos.html">Kerberos</a></li>
</ul></div></li>
<li><a href="#collapse-238" data-toggle="collapse">REPLs<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-238"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/python_shell.html">Python REPL</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/repls/scala_shell.html">Scala REPL</a></li>
</ul></div></li>
<li><a href="#collapse-242" data-toggle="collapse">Advanced<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-242"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/external_resources.html">扩展资源</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/historyserver.html">History Server</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/deployment/advanced/logging.html">日志</a></li>
</ul></div></li>
</ul></div></li>
<li><a href="#collapse-248" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Operations<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-248"><ul>
<li><a href="#collapse-249" data-toggle="collapse">状态与容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-249"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/checkpoints.html">Checkpoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/savepoints.html">Savepoints</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/state_backends.html">State Backends</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/state/large_state_tuning.html">大状态与 Checkpoint 调优</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/metrics.html">指标</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/rest_api.html">REST API</a></li>
<li><a href="#collapse-257" data-toggle="collapse">Debugging<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-257"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_event_time.html">调试窗口与事件时间</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/debugging_classloading.html">调试类加载</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/debugging/application_profiling.html">应用程序分析</a></li>
</ul></div></li>
<li><a href="#collapse-262" data-toggle="collapse">Monitoring<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-262"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/checkpoint_monitoring.html">监控 Checkpoint</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/monitoring/back_pressure.html">监控反压</a></li>
</ul></div></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/upgrading.html">升级应用程序和 Flink 版本</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/ops/production_ready.html">生产就绪情况核对清单</a></li>
</ul></div></li><hr class="section-break"></hr>
<li><a href="#collapse-269" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i> Flink 开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-269"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/ide_setup.html">导入 Flink 到 IDE 中</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/flinkDev/building.html">从源码构建 Flink</a></li>
</ul></div></li>
<li><a href="#collapse-273" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> 内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-273"><ul>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/job_scheduling.html">作业调度</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/task_lifecycle.html">Task 生命周期</a></li>
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/internals/filesystems.html">文件系统</a></li>
</ul></div></li>
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python"><i class="fa fa-external-link title" aria-hidden="true"></i> Pythondocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.12/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">选择文档版本<span class="caret"></span></button>
    <ul class="dropdown-menu">
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.11">v1.11</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.10">v1.10</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.9">v1.9</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.8">v1.8</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
    </ul>
  </div>
</div>

<div class="sidenav-languages"><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/dev/python/table-api-users-guide/intro_to_table_api.html">
      <button type="submit" class="btn btn-default">English</button>
    </a>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">

          

<ol class="breadcrumb">
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> 应用开发</li>
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/">Python API</a></li>
  
    <li>Table API用户指南</li>
  
    <li class="active">Python Table API 简介</li>
</ol>

<h1>Python Table API 简介</h1>




<p>本文档是对 PyFlink Table API 的简要介绍，用于帮助新手用户快速理解 PyFlink Table API 的基本用法。
关于高级用法，请参阅用户指南中的其他文档。</p>

<ul id="markdown-toc">
  <li><a href="#python-table-api-程序的基本结构" id="markdown-toc-python-table-api-程序的基本结构">Python Table API 程序的基本结构</a></li>
  <li><a href="#创建-tableenvironment" id="markdown-toc-创建-tableenvironment">创建 TableEnvironment</a></li>
  <li><a href="#创建表" id="markdown-toc-创建表">创建表</a>    <ul>
      <li><a href="#通过列表类型的对象创建" id="markdown-toc-通过列表类型的对象创建">通过列表类型的对象创建</a></li>
      <li><a href="#通过-ddl-创建" id="markdown-toc-通过-ddl-创建">通过 DDL 创建</a></li>
      <li><a href="#通过-catalog-创建" id="markdown-toc-通过-catalog-创建">通过 Catalog 创建</a></li>
    </ul>
  </li>
  <li><a href="#查询" id="markdown-toc-查询">查询</a>    <ul>
      <li><a href="#table-api-查询" id="markdown-toc-table-api-查询">Table API 查询</a></li>
      <li><a href="#sql-查询" id="markdown-toc-sql-查询">SQL 查询</a></li>
      <li><a href="#table-api-和-sql-的混合使用" id="markdown-toc-table-api-和-sql-的混合使用">Table API 和 SQL 的混合使用</a></li>
    </ul>
  </li>
  <li><a href="#将结果写出" id="markdown-toc-将结果写出">将结果写出</a>    <ul>
      <li><a href="#将结果数据收集到客户端" id="markdown-toc-将结果数据收集到客户端">将结果数据收集到客户端</a></li>
      <li><a href="#将结果写入到一张-sink-表中" id="markdown-toc-将结果写入到一张-sink-表中">将结果写入到一张 Sink 表中</a></li>
      <li><a href="#将结果写入多张-sink-表中" id="markdown-toc-将结果写入多张-sink-表中">将结果写入多张 Sink 表中</a></li>
    </ul>
  </li>
  <li><a href="#explain-表" id="markdown-toc-explain-表">Explain 表</a></li>
</ul>

<h2 id="python-table-api-程序的基本结构">Python Table API 程序的基本结构</h2>

<p>所有的 Table API 和 SQL 程序，不管批模式，还是流模式，都遵循相同的结构。下面代码示例展示了 Table API 和 SQL 程序的基本结构。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="c1"># 1. 创建 TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span> 

<span class="c1"># 2. 创建 source 表
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE datagen (
        id INT,
        data STRING
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind' = 'sequence',
        'fields.id.start' = '1',
        'fields.id.end' = '10'
    )
"""</span><span class="p">)</span>

<span class="c1"># 3. 创建 sink 表
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print (
        id INT,
        data STRING
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># 4. 查询 source 表，同时执行计算
# 通过 Table API 创建一张表：
</span><span class="n">source_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"datagen"</span><span class="p">)</span>
<span class="c1"># 或者通过 SQL 查询语句创建一张表：
</span><span class="n">source_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">sql_query</span><span class="p">(</span><span class="s">"SELECT * FROM datagen"</span><span class="p">)</span>

<span class="n">result_table</span> <span class="o">=</span> <span class="n">source_table</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">source_table</span><span class="p">.</span><span class="nb">id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">source_table</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># 5. 将计算结果写入给 sink 表
# 将 Table API 结果表数据写入 sink 表：
</span><span class="n">result_table</span><span class="p">.</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"print"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span>
<span class="c1"># 或者通过 SQL 查询语句来写入 sink 表：
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO print SELECT * FROM datagen"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="创建-tableenvironment">创建 TableEnvironment</h2>

<p><code class="highlighter-rouge">TableEnvironment</code> 是 Table API 和 SQL 集成的核心概念。下面代码示例展示了如何创建一个 <code class="highlighter-rouge">TableEnvironment</code>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="c1"># 创建 blink 流 TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># 创建 blink 批 TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># 创建 flink 流 TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_old_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="c1"># 创建 flink 批 TableEnvironment
</span><span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_old_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span></code></pre></figure>

<p>关于创建 <code class="highlighter-rouge">TableEnvironment</code> 的更多细节，请查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/table_environment.html#create-a-tableenvironment">TableEnvironment 文档</a>。</p>

<p><code class="highlighter-rouge">TableEnvironment</code> 可以用来:</p>

<ul>
  <li>创建 <code class="highlighter-rouge">Table</code></li>
  <li>将 <code class="highlighter-rouge">Table</code> 注册成临时表</li>
  <li>执行 SQL 查询，更多细节可查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">SQL</a></li>
  <li>注册用户自定义的 (标量，表值，或者聚合) 函数, 更多细节可查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/python_udfs.html">普通的用户自定义函数</a> 和 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/udfs/vectorized_python_udfs.html">向量化的用户自定义函数</a></li>
  <li>配置作业，更多细节可查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/python_config.html">Python 配置</a></li>
  <li>管理 Python 依赖，更多细节可查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/dependency_management.html">依赖管理</a></li>
  <li>提交作业执行</li>
</ul>

<p>目前有2个可用的执行器 : flink 执行器 和 blink 执行器。</p>

<p>你应该在当前程序中显式地设置使用哪个执行器，建议尽可能使用 blink 执行器。</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="创建表">创建表</h2>

<p><code class="highlighter-rouge">Table</code> 是 Python Table API 的核心组件。<code class="highlighter-rouge">Table</code> 是 Table API 作业中间结果的逻辑表示。</p>

<p>一个 <code class="highlighter-rouge">Table</code> 实例总是与一个特定的 <code class="highlighter-rouge">TableEnvironment</code> 相绑定。不支持在同一个查询中合并来自不同 TableEnvironments 的表，例如 join 或者 union 它们。</p>

<h3 id="通过列表类型的对象创建">通过列表类型的对象创建</h3>

<p>你可以使用一个列表对象创建一张表：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 创建 blink 批 TableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   _1     _2
0   1     Hi
1   2  Hello</code></pre></figure>

<p>你也可以创建具有指定列名的表：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p>默认情况下，表结构是从数据中自动提取的。</p>

<p>如果自动生成的表模式不符合你的要求，你也可以手动指定：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_without_schema</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="c1"># 默认情况下，“id” 列的类型是 64 位整型
</span><span class="n">default_type</span> <span class="o">=</span> <span class="n">table_without_schema</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()[</span><span class="s">"id"</span><span class="p">].</span><span class="n">dtype</span>
<span class="k">print</span><span class="p">(</span><span class="s">'By default the type of the "id" column is %s.'</span> <span class="o">%</span> <span class="n">default_type</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">DataTypes</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span>
                                <span class="n">DataTypes</span><span class="p">.</span><span class="n">ROW</span><span class="p">([</span><span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">TINYINT</span><span class="p">()),</span>
                                               <span class="n">DataTypes</span><span class="p">.</span><span class="n">FIELD</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">DataTypes</span><span class="p">.</span><span class="n">STRING</span><span class="p">())]))</span>
<span class="c1"># 现在 “id” 列的类型是 8 位整型
</span><span class="nb">type</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()[</span><span class="s">"id"</span><span class="p">].</span><span class="n">dtype</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Now the type of the "id" column is %s.'</span> <span class="o">%</span> <span class="nb">type</span><span class="p">)</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">默认情况下，“id” 列的类型是 64 位整型。
现在 “id” 列的类型是 8 位整型。</code></pre></figure>

<h3 id="通过-ddl-创建">通过 DDL 创建</h3>

<p>你可以通过 DDL 创建一张表：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 创建 blink 流 TableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE random_source (
        id BIGINT, 
        data TINYINT 
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='3',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='6'
    )
"""</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"random_source"</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id  data
0   2     5
1   1     4
2   3     6</code></pre></figure>

<h3 id="通过-catalog-创建">通过 Catalog 创建</h3>

<p><code class="highlighter-rouge">TableEnvironment</code> 维护了一个使用标识符创建的表的 catalogs 映射。</p>

<p>Catalog 中的表既可以是临时的，并与单个 Flink 会话生命周期相关联，也可以是永久的，跨多个 Flink 会话可见。</p>

<p>通过 SQL DDL 创建的表和视图， 例如 “create table …” 和 “create view …“，都存储在 catalog 中。</p>

<p>你可以通过 SQL 直接访问 catalog 中的表。</p>

<p>如果你要用 Table API 来使用 catalog 中的表，可以使用 “from_path” 方法来创建 Table API 对象：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 准备 catalog
# 将 Table API 表注册到 catalog 中
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">'source_table'</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># 从 catalog 中获取 Table API 表
</span><span class="n">new_table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">'source_table'</span><span class="p">)</span>
<span class="n">new_table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="查询">查询</h2>

<h3 id="table-api-查询">Table API 查询</h3>

<p><code class="highlighter-rouge">Table</code> 对象有许多方法，可以用于进行关系操作。
这些方法返回新的 <code class="highlighter-rouge">Table</code> 对象，表示对输入 <code class="highlighter-rouge">Table</code> 应用关系操作之后的结果。
这些关系操作可以由多个方法调用组成，例如 <code class="highlighter-rouge">table.group_by(...).select(...)</code>。</p>

<p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/tableApi.html?code_tab=python">Table API</a> 文档描述了流和批处理上所有支持的 Table API 操作。</p>

<p>以下示例展示了一个简单的 Table API 聚合查询：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 通过 batch table environment 来执行查询
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">BatchTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_batch_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">BatchTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="s">'Jack'</span><span class="p">,</span> <span class="s">'FRANCE'</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s">'Rose'</span><span class="p">,</span> <span class="s">'ENGLAND'</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="s">'Jack'</span><span class="p">,</span> <span class="s">'FRANCE'</span><span class="p">,</span> <span class="mi">20</span><span class="p">)],</span>
                                 <span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'country'</span><span class="p">,</span> <span class="s">'revenue'</span><span class="p">])</span>

<span class="c1"># 计算所有来自法国客户的收入
</span><span class="n">revenue</span> <span class="o">=</span> <span class="n">orders</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">country</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">revenue</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">country</span> <span class="o">==</span> <span class="s">'FRANCE'</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">orders</span><span class="p">.</span><span class="n">revenue</span><span class="p">.</span><span class="nb">sum</span><span class="p">.</span><span class="n">alias</span><span class="p">(</span><span class="s">'rev_sum'</span><span class="p">))</span>
    
<span class="n">revenue</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   name  rev_sum
0  Jack       30</code></pre></figure>

<h3 id="sql-查询">SQL 查询</h3>

<p>Flink 的 SQL 基于 <a href="https://calcite.apache.org">Apache Calcite</a>，它实现了标准的 SQL。SQL 查询语句使用字符串来表达。</p>

<p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/">SQL</a> 文档描述了 Flink 对流和批处理所支持的 SQL。</p>

<p>下面示例展示了一个简单的 SQL 聚合查询：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 通过 StreamTableEnvironment 来执行查询
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>


<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE random_source (
        id BIGINT, 
        data TINYINT
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='8',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='11'
    )
"""</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print_sink (
        id BIGINT, 
        data_sum TINYINT 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    INSERT INTO print_sink
        SELECT id, sum(data) as data_sum FROM 
            (SELECT id / 2 as id, data FROM random_source)
        WHERE id &gt; 1
        GROUP BY id
"""</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">2&gt; +I(4,11)
6&gt; +I(2,8)
8&gt; +I(3,10)
6&gt; -U(2,8)
8&gt; -U(3,10)
6&gt; +U(2,15)
8&gt; +U(3,19)</code></pre></figure>

<p>实际上，上述输出展示了 print 结果表所接收到的 change log。
change log 的格式为:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">{subtask id}&gt; {消息类型}{值的字符串格式}</code></pre></figure>

<p>例如，”2&gt; +I(4,11)” 表示这条消息来自第二个 subtask，其中 “+I” 表示这是一条插入的消息，”(4, 11)” 是这条消息的内容。
另外，”-U” 表示这是一条撤回消息 (即更新前)，这意味着应该在 sink 中删除或撤回该消息。 
“+U” 表示这是一条更新的记录 (即更新后)，这意味着应该在 sink 中更新或插入该消息。</p>

<p>所以，从上面的 change log，我们可以得到如下结果：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">(4, 11)
(2, 15) 
(3, 19)</code></pre></figure>

<h3 id="table-api-和-sql-的混合使用">Table API 和 SQL 的混合使用</h3>

<p>Table API 中的 <code class="highlighter-rouge">Table</code> 对象和 SQL 中的 Table 可以自由地相互转换。</p>

<p>下面例子展示了如何在 SQL 中使用 <code class="highlighter-rouge">Table</code> 对象：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 创建一张 sink 表来接收结果数据
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE table_sink (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># 将 Table API 表转换成 SQL 中的视图
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">'table_api_table'</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># 将 Table API 表的数据写入结果表
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO table_sink SELECT * FROM table_api_table"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">6&gt; +I(1,Hi)
6&gt; +I(2,Hello)</code></pre></figure>

<p>下面例子展示了如何在 Table API 中使用 SQL 表：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 创建一张 SQL source 表
</span><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE sql_source (
        id BIGINT, 
        data TINYINT 
    ) WITH (
        'connector' = 'datagen',
        'fields.id.kind'='sequence',
        'fields.id.start'='1',
        'fields.id.end'='4',
        'fields.data.kind'='sequence',
        'fields.data.start'='4',
        'fields.data.end'='7'
    )
"""</span><span class="p">)</span>

<span class="c1"># 将 SQL 表转换成 Table API 表
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_path</span><span class="p">(</span><span class="s">"sql_source"</span><span class="p">)</span>

<span class="c1"># 或者通过 SQL 查询语句创建表
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">sql_query</span><span class="p">(</span><span class="s">"SELECT * FROM sql_source"</span><span class="p">)</span>

<span class="c1"># 将表中的数据写出
</span><span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id  data
0   2     5
1   1     4
2   4     7
3   3     6</code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="将结果写出">将结果写出</h2>

<h3 id="将结果数据收集到客户端">将结果数据收集到客户端</h3>

<p>你可以调用 “to_pandas” 方法来 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/python/table-api-users-guide/conversion_of_pandas.html#convert-pyflink-table-to-pandas-dataframe">将一个 <code class="highlighter-rouge">Table</code> 对象转化成 pandas DataFrame</a>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">to_pandas</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">   id   data
0   1     Hi
1   2  Hello</code></pre></figure>

<p><span class="label label-info">Note</span> “to_pandas” 会触发表的物化，同时将表的内容收集到客户端内存中，所以通过 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/api/python/pyflink.table.html#pyflink.table.Table.limit">Table.limit</a> 来限制收集数据的条数是一种很好的做法。
<span class="label label-info">Note</span> flink planner 不支持 “to_pandas”，并且，并不是所有的数据类型都可以转换为 pandas DataFrames。</p>

<h3 id="将结果写入到一张-sink-表中">将结果写入到一张 Sink 表中</h3>

<p>你可以调用 “execute_insert” 方法来将 <code class="highlighter-rouge">Table</code> 对象中的数据写入到一张 sink 表中：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span><span class="p">.</span><span class="n">execute_insert</span><span class="p">(</span><span class="s">"sink_table"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">6&gt; +I(1,Hi)
6&gt; +I(2,Hello)</code></pre></figure>

<p>也可以通过 SQL 来完成:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">"table_source"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"INSERT INTO sink_table SELECT * FROM table_source"</span><span class="p">).</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<h3 id="将结果写入多张-sink-表中">将结果写入多张 Sink 表中</h3>

<p>你也可以使用 <code class="highlighter-rouge">StatementSet</code> 在一个作业中将 <code class="highlighter-rouge">Table</code> 中的数据写入到多张 sink 表中：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 准备 source 表和 sink 表
</span><span class="n">table</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">create_temporary_view</span><span class="p">(</span><span class="s">"simple_source"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE first_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE second_sink_table (
        id BIGINT, 
        data VARCHAR
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>

<span class="c1"># 创建 statement set
</span><span class="n">statement_set</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">create_statement_set</span><span class="p">()</span>

<span class="c1"># 将 "table" 的数据写入 "first_sink_table"
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"first_sink_table"</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

<span class="c1"># 通过一条 sql 插入语句将数据从 "simple_source" 写入到 "second_sink_table"
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert_sql</span><span class="p">(</span><span class="s">"INSERT INTO second_sink_table SELECT * FROM simple_source"</span><span class="p">)</span>

<span class="c1"># 执行 statement set
</span><span class="n">statement_set</span><span class="p">.</span><span class="n">execute</span><span class="p">().</span><span class="n">wait</span><span class="p">()</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">7&gt; +I(1,Hi)
7&gt; +I(1,Hi)
7&gt; +I(2,Hello)
7&gt; +I(2,Hello)</code></pre></figure>

<h2 id="explain-表">Explain 表</h2>

<p>Table API 提供了一种机制来查看 <code class="highlighter-rouge">Table</code> 的逻辑查询计划和优化后的查询计划。 
这是通过 <code class="highlighter-rouge">Table.explain()</code> 或者 <code class="highlighter-rouge">StatementSet.explain()</code> 方法来完成的。<code class="highlighter-rouge">Table.explain()</code> 可以返回一个 <code class="highlighter-rouge">Table</code> 的执行计划。<code class="highlighter-rouge">StatementSet.explain()</code> 则可以返回含有多个 sink 的作业的执行计划。这些方法会返回一个字符串，字符串描述了以下三个方面的信息：</p>

<ol>
  <li>关系查询的抽象语法树，即未经优化的逻辑查询计划，</li>
  <li>优化后的逻辑查询计划，</li>
  <li>物理执行计划。</li>
</ol>

<p><code class="highlighter-rouge">TableEnvironment.explain_sql()</code> 和 <code class="highlighter-rouge">TableEnvironment.execute_sql()</code> 支持执行 <code class="highlighter-rouge">EXPLAIN</code> 语句获得执行计划。更多细节请查阅 <a href="//ci.apache.org/projects/flink/flink-docs-release-1.12/zh/dev/table/sql/explain.html">EXPLAIN</a>。</p>

<p>以下代码展示了如何使用 <code class="highlighter-rouge">Table.explain()</code> 方法：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 使用 StreamTableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table1</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table1</span> \
    <span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">table1</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">like</span><span class="p">(</span><span class="s">'H%'</span><span class="p">))</span> \
    <span class="p">.</span><span class="n">union_all</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">explain</span><span class="p">())</span></code></pre></figure>

<p>结果为：</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">== 抽象语法树 ==
LogicalUnion(all=[true])
:- LogicalFilter(condition=[LIKE($1, _UTF-16LE'H%')])
:  +- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]]])
+- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]]])

== 优化后的逻辑计划 ==
Union(all=[true], union=[id, data])
:- Calc(select=[id, data], where=[LIKE(data, _UTF-16LE'H%')])
:  +- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])
+- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

== 物理执行计划 ==
Stage 133 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 134 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_201907291, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 135 : Operator
                        content : Calc(select=[id, data], where=[(data LIKE _UTF-16LE'H%')])
                        ship_strategy : FORWARD

Stage 136 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 137 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_1709623525, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD</code></pre></figure>

<p>以下代码展示了如何使用 <code class="highlighter-rouge">StatementSet.explain()</code> 方法：</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 使用 StreamTableEnvironment
</span><span class="kn">from</span> <span class="nn">pyflink.table</span> <span class="kn">import</span> <span class="n">EnvironmentSettings</span><span class="p">,</span> <span class="n">StreamTableEnvironment</span>

<span class="n">env_settings</span> <span class="o">=</span> <span class="n">EnvironmentSettings</span><span class="p">.</span><span class="n">new_instance</span><span class="p">().</span><span class="n">in_streaming_mode</span><span class="p">().</span><span class="n">use_blink_planner</span><span class="p">().</span><span class="n">build</span><span class="p">()</span>
<span class="n">table_env</span> <span class="o">=</span> <span class="n">StreamTableEnvironment</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">environment_settings</span><span class="o">=</span><span class="n">env_settings</span><span class="p">)</span>

<span class="n">table1</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">from_elements</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s">'Hi'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">'Hello'</span><span class="p">)],</span> <span class="p">[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">])</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE print_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'print'
    )
"""</span><span class="p">)</span>
<span class="n">table_env</span><span class="p">.</span><span class="n">execute_sql</span><span class="p">(</span><span class="s">"""
    CREATE TABLE black_hole_sink_table (
        id BIGINT, 
        data VARCHAR 
    ) WITH (
        'connector' = 'blackhole'
    )
"""</span><span class="p">)</span>

<span class="n">statement_set</span> <span class="o">=</span> <span class="n">table_env</span><span class="p">.</span><span class="n">create_statement_set</span><span class="p">()</span>

<span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"print_sink_table"</span><span class="p">,</span> <span class="n">table1</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">table1</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">like</span><span class="p">(</span><span class="s">'H%'</span><span class="p">)))</span>
<span class="n">statement_set</span><span class="p">.</span><span class="n">add_insert</span><span class="p">(</span><span class="s">"black_hole_sink_table"</span><span class="p">,</span> <span class="n">table2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">statement_set</span><span class="p">.</span><span class="n">explain</span><span class="p">())</span></code></pre></figure>

<p>结果为</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">== 抽象语法树 ==
LogicalSink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
+- LogicalFilter(condition=[LIKE($1, _UTF-16LE'H%')])
   +- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]]])

LogicalSink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
+- LogicalTableScan(table=[[default_catalog, default_database, Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]]])

== 优化后的逻辑计划 ==
Sink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
+- Calc(select=[id, data], where=[LIKE(data, _UTF-16LE'H%')])
   +- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

Sink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
+- LegacyTableSourceScan(table=[[default_catalog, default_database, Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]]], fields=[id, data])

== 物理执行计划 ==
Stage 139 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 140 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_541737614, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 141 : Operator
                        content : Calc(select=[id, data], where=[(data LIKE _UTF-16LE'H%')])
                        ship_strategy : FORWARD

Stage 143 : Data Source
        content : Source: PythonInputFormatTableSource(id, data)

        Stage 144 : Operator
                content : SourceConversion(table=[default_catalog.default_database.Unregistered_TableSource_1437429083, source: [PythonInputFormatTableSource(id, data)]], fields=[id, data])
                ship_strategy : FORWARD

                Stage 142 : Data Sink
                        content : Sink: Sink(table=[default_catalog.default_database.print_sink_table], fields=[id, data])
                        ship_strategy : FORWARD

                        Stage 145 : Data Sink
                                content : Sink: Sink(table=[default_catalog.default_database.black_hole_sink_table], fields=[id, data])
                                ship_strategy : FORWARD</code></pre></figure>




<div class="footer">
  <a href="https://cwiki.apache.org/confluence/display/FLINK/Flink+Translation+Specifications" target="_blank">
    
      想参与贡献翻译？
    
  </a>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- default code tab -->
    <script>var defaultCodeTab = "";</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.12/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
